<!DOCTYPE html>
<html lang="en">
<head>
<title>Coverage</title>
<meta charset="utf-8"/>
<style>
@media screen{
    html {background-color: #FFFFF0;}
body {
    font-size: 16px;
    font-family : Verdana, "Bitstream Vera Sans", "DejaVu Sans", Tahoma, Geneva, Arial, Sans-serif;
    margin: 1em;
}
th, td {padding: 5px 10px;}
th {text-align: left;}
h1, h2, h3, h4, h5, h6 {color: #424242;}
h1 {font-size: 22px;}
h2 {font-size: 18px; margin-top: 2em; margin-bottom:0.3em;}
tbody tr:nth-child(even) {background-color: #F0F0F0;}
tbody tr:nth-child(odd) {background-color: #FAFAFA;}
th {background-color: #E6E6E6;color: #424242;}
table {border: silver 1px solid; font-size: 14px;font-family: APLFont, monospace;}
code , code a {font-size: 14px; font-family: APLFont, monospace;}
code.header {
    font-size: 16px; 
    font-family: APLFont, monospace; 
    margin: 1.5em 0.5em 0 0.5em; 
    padding:0;
    display: block;
}
div.code-block {
    border: 1px silver dashed;
    background-color: #F2F2F2;
    display: block;
    margin: 0.5em 0.5em 0.5em 0.5em;
    padding: 0.5em;
}
div.code-block.missing {
    background-color: #fa605254;
}
div.code-block code {display: block; white-space: pre-wrap; margin:0; padding:0; word-wrap: break-word;}
.emphasize { font-weight: 800;}
ul li, ol li {margin: 0.7em 0.2em;}
.float-right {float:right;}
.no-underline {    text-decoration :none;}
.top-links {font-size:20px; padding-left: 0.6em;}
.align-right {text-align: right;}
#footer hr {margin-top:1.5em;}
#footer p {margin-top:5px; padding-top:0; font-size: 9px;}
@font-face {
        font-family: "APLFont";
    src:
        local("APL385 Unicode"),
        url("https://misc.aplteam.com/apl385.ttf") format("truetype");
}
.info {border: 1px silver dashed; background-color: #F2F2F2;margin: 0.5em; padding: 0.5em;}
}
@media print{@page {size: portrait}
@page {
    margin: 1cm 1cm 1cm 1.75cm;
    @bottom-right {
        content: counter(page) " / " counter(pages);
  }
}
body {
    font: 12pt "Times New Roman", Times, serif;
    line-height: 1.2;
     /* CSS3 filter, at the moment Webkit only. Prefix it for future implementations */
    -webkit-filter: grayscale(100%);
    filter: grayscale(100%); /* future-proof */
}
h1 {font-size: 18pt;}
h2 {font-size: 16pt; margin-top: 10pt; margin-bottom: 3pt;}
th, td {padding: 2pt 3pt;}
th {text-align: left;background-color: #DBDBDB;}
tbody tr:nth-child(odd) {background-color: #EDEDED;}
table {
    color-adjust: exact !important;
    -webkit-print-color-adjust: exact !important;
    print-color-adjust: exact !important;
    font-size: 8pt;
    font-family: APLFont, monospace;
}
div.keep-together {break-inside: avoid; break-before:auto;}
table {border: silver 1pt solid;}
code , code a {font-size: 8pt; font-family: APLFont, monospace;}
code.header {
    font-size: 8pt;
    font-family: APLFont, monospace;
    margin: 7pt 3pt 0 10pt;
    padding:0;
    display: block;
}
div.code-block {
    border: 1pt silver dashed;
    background-color: #F2F2F2;
    display: block;
    margin: 4pt 4pt 4pt 4pt;
    padding: 4pt;
}
div.code-block code {display: block; white-space: pre-wrap; margin:0; padding:0; word-wrap: break-word;}
.emphasize { font-weight: 800;}
a {text-decoration: none;color: black;}
ul li, ol li {margin: 8pt 3pt;}
.no-print {display:none;}
.align-right {text-align: right;}
#footer hr {margin-top:1.5em;}
#footer p {margin-top:5pt; padding-top:0; font-size: 6pt;}
@font-face {
        font-family: "APLFont";
    src:
        local("APL385 Unicode"),
        url("https://misc.aplteam.com/apl385.ttf") format("truetype");
}
.info {border: 1px silver dashed; background-color: #F2F2F2;margin: 8px; padding: 8px;}
}
</style>
<link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/v/dt/jq-3.6.0/dt-1.11.2/b-2.0.0/b-print-2.0.0/fh-3.1.9/r-2.2.9/datatables.min.css"/>
<script type="text/javascript" src="https://cdn.datatables.net/v/dt/jq-3.6.0/dt-1.11.2/b-2.0.0/b-print-2.0.0/fh-3.1.9/r-2.2.9/datatables.min.js"></script>
</head>
<body>
<h1 id="top">Coverage Report</h1>
<p>Watched: 139 fns/opr within <code>#.APLGit2.APLGit2</code></p>
<p>The test suite was executed once:</p>
<table>
<thead>
<tr><th>Executed at</th><th>APLVersion</th><th>Memory (MB)</th></tr>
</thead>
<tbody>
<tr><td>2024-12-24 18:51:23</td><td>Windows-64 ⋄ 19.0.50233.0 ⋄ W ⋄ Development ⋄ Unicode</td><td>113</td></tr>
</tbody>
</table>
<p>Overall 51% of the testable code is covered.</p>
<p>(Comment lines, empty lines, all <code>:End</code>* lines etc. are ignored)</p>
<p>68 of the fns/opr are 100% covered.</p>
<div id="partly-covered" class="keep-together">
<table id="percent">
<thead>
<tr><th style="text-align:left;">Function/Operator</th><th style="text-align:left;">Lines not executed</th><th style="text-align:left;">Coverage</th><th style="text-align:right;">≢</th></tr>
</thead>
<tbody>
<tr class="uncovered"><td><a href="#listing_1" title="Link to listing">#.APLGit2.APLGit2.InitializeGitUserCommand</a></td><td>4←≢2-5</td><td>0</td><td>4</td></tr>
<tr class="uncovered"><td><a href="#listing_2" title="Link to listing">#.APLGit2.APLGit2.InitializeProject</a></td><td>5←≢1-3,5-6</td><td>0</td><td>5</td></tr>
<tr class="uncovered"><td><a href="#listing_3" title="Link to listing">#.APLGit2.APLGit2._gHYeQiyWvYuaIhlNzUvBDTICZkIpbYUiUZBdZQtB_nXuFVNnUz_UPxxrVyDXFCsMXuCxYytEbskCCXn</a></td><td>1</td><td>0</td><td>1</td></tr>
<tr class="uncovered"><td><a href="#listing_4" title="Link to listing">#.APLGit2.APLGit2.UC.Add</a></td><td>5←≢1-5</td><td>0</td><td>5</td></tr>
<tr class="uncovered"><td><a href="#listing_5" title="Link to listing">#.APLGit2.APLGit2.UC.AddGitIgnore</a></td><td>1, 2</td><td>0</td><td>2</td></tr>
<tr class="uncovered"><td><a href="#listing_6" title="Link to listing">#.APLGit2.APLGit2.UC.AddProjectOptions</a></td><td>4←≢1-4</td><td>0</td><td>4</td></tr>
<tr class="uncovered"><td><a href="#listing_7" title="Link to listing">#.APLGit2.APLGit2.UC.AddSlash</a></td><td>1</td><td>0</td><td>1</td></tr>
<tr class="uncovered"><td><a href="#listing_8" title="Link to listing">#.APLGit2.APLGit2.UC.AddTitles</a></td><td>2, 3</td><td>0</td><td>2</td></tr>
<tr class="uncovered"><td><a href="#listing_9" title="Link to listing">#.APLGit2.APLGit2.UC.AtLeastVersion</a></td><td>6, 7, 8</td><td>0</td><td>3</td></tr>
<tr class="uncovered"><td><a href="#listing_10" title="Link to listing">#.APLGit2.APLGit2.UC.ChangeLog</a></td><td>5←≢1-3,5-6</td><td>0</td><td>5</td></tr>
<tr class="uncovered"><td><a href="#listing_11" title="Link to listing">#.APLGit2.APLGit2.UC.Commit</a></td><td>40←≢1-6,8,11-15,17-20,22,24-26,28-38,40-42,44-45,47-49,51</td><td>0</td><td>40</td></tr>
<tr class="uncovered"><td><a href="#listing_12" title="Link to listing">#.APLGit2.APLGit2.UC.CompareCommits</a></td><td>32←≢1-3,5-11,13-16,18-20,22-26,28-29,31-37,39</td><td>0</td><td>32</td></tr>
<tr class="uncovered"><td><a href="#listing_13" title="Link to listing">#.APLGit2.APLGit2.UC.Diff</a></td><td>1</td><td>0</td><td>1</td></tr>
<tr class="uncovered"><td><a href="#listing_14" title="Link to listing">#.APLGit2.APLGit2.UC.ErrNo</a></td><td>1</td><td>0</td><td>1</td></tr>
<tr class="uncovered"><td><a href="#listing_15" title="Link to listing">#.APLGit2.APLGit2.UC.GetDefaultProject</a></td><td>1</td><td>0</td><td>1</td></tr>
<tr class="uncovered"><td><a href="#listing_16" title="Link to listing">#.APLGit2.APLGit2.UC.GetRefToAPLGit2</a></td><td>6←≢1-5,7</td><td>0</td><td>6</td></tr>
<tr class="uncovered"><td><a href="#listing_17" title="Link to listing">#.APLGit2.APLGit2.UC.GetSpaceAndFolder</a></td><td>23←≢1-16,18,20-22,24,26-27</td><td>0</td><td>23</td></tr>
<tr class="uncovered"><td><a href="#listing_18" title="Link to listing">#.APLGit2.APLGit2.UC.GetSpaceAndFolder_</a></td><td>6←≢1-4,6-7</td><td>0</td><td>6</td></tr>
<tr class="uncovered"><td><a href="#listing_19" title="Link to listing">#.APLGit2.APLGit2.UC.GetTagOfLatestRelease</a></td><td>7←≢1-4,6,8-9</td><td>0</td><td>7</td></tr>
<tr class="uncovered"><td><a href="#listing_20" title="Link to listing">#.APLGit2.APLGit2.UC.Help</a></td><td>74←≢1-60,62,64-65,68-77,79</td><td>0</td><td>74</td></tr>
<tr class="uncovered"><td><a href="#listing_21" title="Link to listing">#.APLGit2.APLGit2.UC.Init</a></td><td>4←≢1-4</td><td>0</td><td>4</td></tr>
<tr class="uncovered"><td><a href="#listing_22" title="Link to listing">#.APLGit2.APLGit2.UC.IsDirty</a></td><td>1, 2</td><td>0</td><td>2</td></tr>
<tr class="uncovered"><td><a href="#listing_23" title="Link to listing">#.APLGit2.APLGit2.UC.IsGitProject</a></td><td>1</td><td>0</td><td>1</td></tr>
<tr class="uncovered"><td><a href="#listing_24" title="Link to listing">#.APLGit2.APLGit2.UC.List</a></td><td>191←≢1-9,11-17,19-25,27-33,35-41,43-49,51-57,59-65,67-73,75-81,83-89,91-97,99-105,107-113,115-121,123-129,131-137,139-145,147-153,155-161,163-169,171-177,179-185,187-193,195-201,203-209,211-217</td><td>0</td><td>191</td></tr>
<tr class="uncovered"><td><a href="#listing_25" title="Link to listing">#.APLGit2.APLGit2.UC.ListBranches</a></td><td>6←≢1-4,6,8</td><td>0</td><td>6</td></tr>
<tr class="uncovered"><td><a href="#listing_26" title="Link to listing">#.APLGit2.APLGit2.UC.Log</a></td><td>8←≢1-8</td><td>0</td><td>8</td></tr>
<tr class="uncovered"><td><a href="#listing_27" title="Link to listing">#.APLGit2.APLGit2.UC.MinimumVersionOfDyalog</a></td><td>1</td><td>0</td><td>1</td></tr>
<tr class="uncovered"><td><a href="#listing_28" title="Link to listing">#.APLGit2.APLGit2.UC.NoOfUntrackedFiles</a></td><td>1</td><td>0</td><td>1</td></tr>
<tr class="uncovered"><td><a href="#listing_29" title="Link to listing">#.APLGit2.APLGit2.UC.OpenGitShell</a></td><td>1, 2</td><td>0</td><td>2</td></tr>
<tr class="uncovered"><td><a href="#listing_30" title="Link to listing">#.APLGit2.APLGit2.UC.ProcessLogParms</a></td><td>6←≢1-6</td><td>0</td><td>6</td></tr>
<tr class="uncovered"><td><a href="#listing_31" title="Link to listing">#.APLGit2.APLGit2.UC.RefLog</a></td><td>9←≢1-2,4,6-7,9-12</td><td>0</td><td>9</td></tr>
<tr class="uncovered"><td><a href="#listing_32" title="Link to listing">#.APLGit2.APLGit2.UC.SetDefaultProject</a></td><td>1</td><td>0</td><td>1</td></tr>
<tr class="uncovered"><td><a href="#listing_33" title="Link to listing">#.APLGit2.APLGit2.UC.Squash</a></td><td>5←≢1-5</td><td>0</td><td>5</td></tr>
<tr class="uncovered"><td><a href="#listing_34" title="Link to listing">#.APLGit2.APLGit2.UC.StashApply</a></td><td>2, 3</td><td>0</td><td>2</td></tr>
<tr class="uncovered"><td><a href="#listing_35" title="Link to listing">#.APLGit2.APLGit2.UC.StashClear</a></td><td>1</td><td>0</td><td>1</td></tr>
<tr class="uncovered"><td><a href="#listing_36" title="Link to listing">#.APLGit2.APLGit2.UC.StashDrop</a></td><td>1, 2</td><td>0</td><td>2</td></tr>
<tr class="uncovered"><td><a href="#listing_37" title="Link to listing">#.APLGit2.APLGit2.UC.StashList</a></td><td>1</td><td>0</td><td>1</td></tr>
<tr class="uncovered"><td><a href="#listing_38" title="Link to listing">#.APLGit2.APLGit2.UC.StashPop</a></td><td>1, 2</td><td>0</td><td>2</td></tr>
<tr class="uncovered"><td><a href="#listing_39" title="Link to listing">#.APLGit2.APLGit2.UC.StashPush</a></td><td>11←≢2-4,6,8-9,11,13-14,16,18</td><td>0</td><td>11</td></tr>
<tr class="uncovered"><td><a href="#listing_40" title="Link to listing">#.APLGit2.APLGit2.UC.StashShow</a></td><td>1, 2, 3</td><td>0</td><td>3</td></tr>
<tr class="uncovered"><td><a href="#listing_41" title="Link to listing">#.APLGit2.APLGit2.UC.Status</a></td><td>1, 2</td><td>0</td><td>2</td></tr>
<tr class="uncovered"><td><a href="#listing_42" title="Link to listing">#.APLGit2.APLGit2.UC.Version</a></td><td>1</td><td>0</td><td>1</td></tr>
<tr><td><a href="#listing_43" title="Link to listing">#.APLGit2.APLGit2.Init</a></td><td>14←≢14-19,24,31-37</td><td>39</td><td>23</td></tr>
<tr><td><a href="#listing_44" title="Link to listing">#.APLGit2.APLGit2.CompareCommits_</a></td><td>23←≢8-12,14-15,23,29,32,38-42,44-45,52,55,62-65</td><td>52</td><td>48</td></tr>
<tr><td><a href="#listing_45" title="Link to listing">#.APLGit2.APLGit2.DiffBranches</a></td><td>11←≢5,13-15,18-23,25</td><td>52</td><td>23</td></tr>
<tr><td><a href="#listing_46" title="Link to listing">#.APLGit2.APLGit2.OpenGitShell</a></td><td>10←≢10-11,19-20,25,31-35</td><td>57</td><td>23</td></tr>
<tr><td><a href="#listing_47" title="Link to listing">#.APLGit2.APLGit2.U.RunProcess</a></td><td>25←≢13,38,46,56-65,67-73,75,77-79,81</td><td>60</td><td>62</td></tr>
<tr><td><a href="#listing_48" title="Link to listing">#.APLGit2.APLGit2.SetDefaultProject</a></td><td>9←≢14,17,21-24,28-29,37</td><td>63</td><td>24</td></tr>
<tr><td><a href="#listing_49" title="Link to listing">#.APLGit2.APLGit2.U.MassageMsg</a></td><td>7</td><td>67</td><td>3</td></tr>
<tr><td><a href="#listing_50" title="Link to listing">#.APLGit2.APLGit2.EstablishProject</a></td><td>11←≢16-17,22-23,28,30,32-35,37</td><td>69</td><td>35</td></tr>
<tr><td><a href="#listing_51" title="Link to listing">#.APLGit2.APLGit2.LatestRelease</a></td><td>4←≢11-12,15,18</td><td>69</td><td>13</td></tr>
<tr><td><a href="#listing_52" title="Link to listing">#.APLGit2.APLGit2.IsGitInstalled</a></td><td>8, 9, 10</td><td>70</td><td>10</td></tr>
<tr><td><a href="#listing_53" title="Link to listing">#.APLGit2.APLGit2.GetDefaultProject</a></td><td>5</td><td>75</td><td>4</td></tr>
<tr><td><a href="#listing_54" title="Link to listing">#.APLGit2.APLGit2.ListIssues</a></td><td>5←≢14-15,28-29,31</td><td>75</td><td>20</td></tr>
<tr><td><a href="#listing_55" title="Link to listing">#.APLGit2.APLGit2.Log</a></td><td>10←≢32,35,52,57-58,60,62-63,67,70</td><td>77</td><td>44</td></tr>
<tr><td><a href="#listing_56" title="Link to listing">#.APLGit2.APLGit2.Commit</a></td><td>5←≢19-22,35</td><td>78</td><td>23</td></tr>
<tr><td><a href="#listing_57" title="Link to listing">#.APLGit2.APLGit2.CompareCommits</a></td><td>9←≢20-21,28-29,56-57,60,63,66</td><td>79</td><td>42</td></tr>
<tr><td><a href="#listing_58" title="Link to listing">#.APLGit2.APLGit2.GetTagOfLatestRelease</a></td><td>14, 15, 17</td><td>79</td><td>14</td></tr>
<tr><td><a href="#listing_59" title="Link to listing">#.APLGit2.APLGit2.U.RunGitCommand</a></td><td>7, 10, 14</td><td>79</td><td>14</td></tr>
<tr><td><a href="#listing_60" title="Link to listing">#.APLGit2.APLGit2.GetPathFromProject</a></td><td>7</td><td>80</td><td>5</td></tr>
<tr><td><a href="#listing_61" title="Link to listing">#.APLGit2.APLGit2.GetProjectFromPath</a></td><td>8</td><td>80</td><td>5</td></tr>
<tr><td><a href="#listing_62" title="Link to listing">#.APLGit2.APLGit2.Squash</a></td><td>11←≢52-54,60-64,66-67,74</td><td>80</td><td>56</td></tr>
<tr><td><a href="#listing_63" title="Link to listing">#.APLGit2.APLGit2.Version</a></td><td>5</td><td>80</td><td>5</td></tr>
<tr><td><a href="#listing_64" title="Link to listing">#.APLGit2.APLGit2.StashPush</a></td><td>18, 19</td><td>86</td><td>14</td></tr>
<tr><td><a href="#listing_65" title="Link to listing">#.APLGit2.APLGit2.AddGitAttributes</a></td><td>4, 15</td><td>87</td><td>15</td></tr>
<tr><td><a href="#listing_66" title="Link to listing">#.APLGit2.APLGit2.DiffBetween</a></td><td>9</td><td>88</td><td>8</td></tr>
<tr><td><a href="#listing_67" title="Link to listing">#.APLGit2.APLGit2.NoOfUntrackedFiles</a></td><td>8</td><td>88</td><td>8</td></tr>
<tr><td><a href="#listing_68" title="Link to listing">#.APLGit2.APLGit2.StashShow</a></td><td>14</td><td>90</td><td>10</td></tr>
<tr><td><a href="#listing_69" title="Link to listing">#.APLGit2.APLGit2.U.GetNumberOfCommits</a></td><td>13</td><td>90</td><td>10</td></tr>
<tr><td><a href="#listing_70" title="Link to listing">#.APLGit2.APLGit2.Diff</a></td><td>19</td><td>91</td><td>11</td></tr>
<tr><td><a href="#listing_71" title="Link to listing">#.APLGit2.APLGit2.ChangeLog</a></td><td>12, 32</td><td>92</td><td>24</td></tr>
<tr class="fullyCovered"><td><a href="#listing_72" title="Link to listing">#.APLGit2.APLGit2.Add</a></td><td></td><td>100</td><td>6</td></tr>
<tr class="fullyCovered"><td><a href="#listing_73" title="Link to listing">#.APLGit2.APLGit2.AddGitIgnore</a></td><td></td><td>100</td><td>48</td></tr>
<tr class="fullyCovered"><td><a href="#listing_74" title="Link to listing">#.APLGit2.APLGit2.Assert</a></td><td></td><td>100</td><td>0</td></tr>
<tr class="fullyCovered"><td><a href="#listing_75" title="Link to listing">#.APLGit2.APLGit2.BeautifyDateTime</a></td><td></td><td>100</td><td>3</td></tr>
<tr class="fullyCovered"><td><a href="#listing_76" title="Link to listing">#.APLGit2.APLGit2.Branch</a></td><td></td><td>100</td><td>3</td></tr>
<tr class="fullyCovered"><td><a href="#listing_77" title="Link to listing">#.APLGit2.APLGit2.CreateStashPushParms</a></td><td></td><td>100</td><td>5</td></tr>
<tr class="fullyCovered"><td><a href="#listing_78" title="Link to listing">#.APLGit2.APLGit2.CurrentBranch</a></td><td></td><td>100</td><td>4</td></tr>
<tr class="fullyCovered"><td><a href="#listing_79" title="Link to listing">#.APLGit2.APLGit2.GetLastCommit</a></td><td></td><td>100</td><td>4</td></tr>
<tr class="fullyCovered"><td><a href="#listing_80" title="Link to listing">#.APLGit2.APLGit2.GetMainOrMaster</a></td><td></td><td>100</td><td>1</td></tr>
<tr class="fullyCovered"><td><a href="#listing_81" title="Link to listing">#.APLGit2.APLGit2.GetMostRecentAncestor</a></td><td></td><td>100</td><td>11</td></tr>
<tr class="fullyCovered"><td><a href="#listing_82" title="Link to listing">#.APLGit2.APLGit2.GitProjects</a></td><td></td><td>100</td><td>2</td></tr>
<tr class="fullyCovered"><td><a href="#listing_83" title="Link to listing">#.APLGit2.APLGit2.IsDirty</a></td><td></td><td>100</td><td>6</td></tr>
<tr class="fullyCovered"><td><a href="#listing_84" title="Link to listing">#.APLGit2.APLGit2.IsGitProject</a></td><td></td><td>100</td><td>3</td></tr>
<tr class="fullyCovered"><td><a href="#listing_85" title="Link to listing">#.APLGit2.APLGit2.ListBranches</a></td><td></td><td>100</td><td>7</td></tr>
<tr class="fullyCovered"><td><a href="#listing_86" title="Link to listing">#.APLGit2.APLGit2.LogForBranch</a></td><td></td><td>100</td><td>5</td></tr>
<tr class="fullyCovered"><td><a href="#listing_87" title="Link to listing">#.APLGit2.APLGit2.Methods</a></td><td></td><td>100</td><td>7</td></tr>
<tr class="fullyCovered"><td><a href="#listing_88" title="Link to listing">#.APLGit2.APLGit2.Public</a></td><td></td><td>100</td><td>33</td></tr>
<tr class="fullyCovered"><td><a href="#listing_89" title="Link to listing">#.APLGit2.APLGit2.RefLog</a></td><td></td><td>100</td><td>10</td></tr>
<tr class="fullyCovered"><td><a href="#listing_90" title="Link to listing">#.APLGit2.APLGit2.StashApply</a></td><td></td><td>100</td><td>6</td></tr>
<tr class="fullyCovered"><td><a href="#listing_91" title="Link to listing">#.APLGit2.APLGit2.StashClear</a></td><td></td><td>100</td><td>3</td></tr>
<tr class="fullyCovered"><td><a href="#listing_92" title="Link to listing">#.APLGit2.APLGit2.StashDrop</a></td><td></td><td>100</td><td>6</td></tr>
<tr class="fullyCovered"><td><a href="#listing_93" title="Link to listing">#.APLGit2.APLGit2.StashList</a></td><td></td><td>100</td><td>5</td></tr>
<tr class="fullyCovered"><td><a href="#listing_94" title="Link to listing">#.APLGit2.APLGit2.StashPop</a></td><td></td><td>100</td><td>6</td></tr>
<tr class="fullyCovered"><td><a href="#listing_95" title="Link to listing">#.APLGit2.APLGit2.Status</a></td><td></td><td>100</td><td>14</td></tr>
<tr class="fullyCovered"><td><a href="#listing_96" title="Link to listing">#.APLGit2.APLGit2.API.Add</a></td><td></td><td>100</td><td>0</td></tr>
<tr class="fullyCovered"><td><a href="#listing_97" title="Link to listing">#.APLGit2.APLGit2.API.AddGitIgnore</a></td><td></td><td>100</td><td>0</td></tr>
<tr class="fullyCovered"><td><a href="#listing_98" title="Link to listing">#.APLGit2.APLGit2.API.ChangeLog</a></td><td></td><td>100</td><td>0</td></tr>
<tr class="fullyCovered"><td><a href="#listing_99" title="Link to listing">#.APLGit2.APLGit2.API.Commit</a></td><td></td><td>100</td><td>0</td></tr>
<tr class="fullyCovered"><td><a href="#listing_100" title="Link to listing">#.APLGit2.APLGit2.API.CompareCommits</a></td><td></td><td>100</td><td>0</td></tr>
<tr class="fullyCovered"><td><a href="#listing_101" title="Link to listing">#.APLGit2.APLGit2.API.CurrentBranch</a></td><td></td><td>100</td><td>0</td></tr>
<tr class="fullyCovered"><td><a href="#listing_102" title="Link to listing">#.APLGit2.APLGit2.API.Diff</a></td><td></td><td>100</td><td>0</td></tr>
<tr class="fullyCovered"><td><a href="#listing_103" title="Link to listing">#.APLGit2.APLGit2.API.EstablishProject</a></td><td></td><td>100</td><td>0</td></tr>
<tr class="fullyCovered"><td><a href="#listing_104" title="Link to listing">#.APLGit2.APLGit2.API.GetDefaultProject</a></td><td></td><td>100</td><td>0</td></tr>
<tr class="fullyCovered"><td><a href="#listing_105" title="Link to listing">#.APLGit2.APLGit2.API.GetPathFromProject</a></td><td></td><td>100</td><td>0</td></tr>
<tr class="fullyCovered"><td><a href="#listing_106" title="Link to listing">#.APLGit2.APLGit2.API.GetProjectFromPath</a></td><td></td><td>100</td><td>0</td></tr>
<tr class="fullyCovered"><td><a href="#listing_107" title="Link to listing">#.APLGit2.APLGit2.API.GetTagOfLatestRelease</a></td><td></td><td>100</td><td>0</td></tr>
<tr class="fullyCovered"><td><a href="#listing_108" title="Link to listing">#.APLGit2.APLGit2.API.Init</a></td><td></td><td>100</td><td>0</td></tr>
<tr class="fullyCovered"><td><a href="#listing_109" title="Link to listing">#.APLGit2.APLGit2.API.IsDirty</a></td><td></td><td>100</td><td>0</td></tr>
<tr class="fullyCovered"><td><a href="#listing_110" title="Link to listing">#.APLGit2.APLGit2.API.IsGitInstalled</a></td><td></td><td>100</td><td>1</td></tr>
<tr class="fullyCovered"><td><a href="#listing_111" title="Link to listing">#.APLGit2.APLGit2.API.IsGitProject</a></td><td></td><td>100</td><td>0</td></tr>
<tr class="fullyCovered"><td><a href="#listing_112" title="Link to listing">#.APLGit2.APLGit2.API.ListBranches</a></td><td></td><td>100</td><td>0</td></tr>
<tr class="fullyCovered"><td><a href="#listing_113" title="Link to listing">#.APLGit2.APLGit2.API.Log</a></td><td></td><td>100</td><td>0</td></tr>
<tr class="fullyCovered"><td><a href="#listing_114" title="Link to listing">#.APLGit2.APLGit2.API.Methods</a></td><td></td><td>100</td><td>1</td></tr>
<tr class="fullyCovered"><td><a href="#listing_115" title="Link to listing">#.APLGit2.APLGit2.API.NoOfUntrackedFiles</a></td><td></td><td>100</td><td>0</td></tr>
<tr class="fullyCovered"><td><a href="#listing_116" title="Link to listing">#.APLGit2.APLGit2.API.OpenGitShell</a></td><td></td><td>100</td><td>0</td></tr>
<tr class="fullyCovered"><td><a href="#listing_117" title="Link to listing">#.APLGit2.APLGit2.API.RefLog</a></td><td></td><td>100</td><td>0</td></tr>
<tr class="fullyCovered"><td><a href="#listing_118" title="Link to listing">#.APLGit2.APLGit2.API.SetDefaultProject</a></td><td></td><td>100</td><td>0</td></tr>
<tr class="fullyCovered"><td><a href="#listing_119" title="Link to listing">#.APLGit2.APLGit2.API.Squash</a></td><td></td><td>100</td><td>0</td></tr>
<tr class="fullyCovered"><td><a href="#listing_120" title="Link to listing">#.APLGit2.APLGit2.API.StashApply</a></td><td></td><td>100</td><td>0</td></tr>
<tr class="fullyCovered"><td><a href="#listing_121" title="Link to listing">#.APLGit2.APLGit2.API.StashClear</a></td><td></td><td>100</td><td>0</td></tr>
<tr class="fullyCovered"><td><a href="#listing_122" title="Link to listing">#.APLGit2.APLGit2.API.StashDrop</a></td><td></td><td>100</td><td>0</td></tr>
<tr class="fullyCovered"><td><a href="#listing_123" title="Link to listing">#.APLGit2.APLGit2.API.StashPop</a></td><td></td><td>100</td><td>0</td></tr>
<tr class="fullyCovered"><td><a href="#listing_124" title="Link to listing">#.APLGit2.APLGit2.API.StashPush</a></td><td></td><td>100</td><td>0</td></tr>
<tr class="fullyCovered"><td><a href="#listing_125" title="Link to listing">#.APLGit2.APLGit2.API.StashShow</a></td><td></td><td>100</td><td>0</td></tr>
<tr class="fullyCovered"><td><a href="#listing_126" title="Link to listing">#.APLGit2.APLGit2.API.Status</a></td><td></td><td>100</td><td>0</td></tr>
<tr class="fullyCovered"><td><a href="#listing_127" title="Link to listing">#.APLGit2.APLGit2.API.Version</a></td><td></td><td>100</td><td>1</td></tr>
<tr class="fullyCovered"><td><a href="#listing_128" title="Link to listing">#.APLGit2.APLGit2.U.AddSlash</a></td><td></td><td>100</td><td>0</td></tr>
<tr class="fullyCovered"><td><a href="#listing_129" title="Link to listing">#.APLGit2.APLGit2.U.Assert</a></td><td></td><td>100</td><td>0</td></tr>
<tr class="fullyCovered"><td><a href="#listing_130" title="Link to listing">#.APLGit2.APLGit2.U.Box</a></td><td></td><td>100</td><td>7</td></tr>
<tr class="fullyCovered"><td><a href="#listing_131" title="Link to listing">#.APLGit2.APLGit2.U.ErrNo</a></td><td></td><td>100</td><td>1</td></tr>
<tr class="fullyCovered"><td><a href="#listing_132" title="Link to listing">#.APLGit2.APLGit2.U.FormatLog</a></td><td></td><td>100</td><td>6</td></tr>
<tr class="fullyCovered"><td><a href="#listing_133" title="Link to listing">#.APLGit2.APLGit2.U.GetDateFormat</a></td><td></td><td>100</td><td>1</td></tr>
<tr class="fullyCovered"><td><a href="#listing_134" title="Link to listing">#.APLGit2.APLGit2.U.GetGitAttributes</a></td><td></td><td>100</td><td>22</td></tr>
<tr class="fullyCovered"><td><a href="#listing_135" title="Link to listing">#.APLGit2.APLGit2.U.GetLogFormat</a></td><td></td><td>100</td><td>9</td></tr>
<tr class="fullyCovered"><td><a href="#listing_136" title="Link to listing">#.APLGit2.APLGit2.U.GetValidFileExtensions</a></td><td></td><td>100</td><td>3</td></tr>
<tr class="fullyCovered"><td><a href="#listing_137" title="Link to listing">#.APLGit2.APLGit2.U.IsNetCore</a></td><td></td><td>100</td><td>1</td></tr>
<tr class="fullyCovered"><td><a href="#listing_138" title="Link to listing">#.APLGit2.APLGit2.U.SelectProject</a></td><td></td><td>100</td><td>6</td></tr>
<tr class="fullyCovered"><td><a href="#listing_139" title="Link to listing">#.APLGit2.APLGit2.UC.Assert</a></td><td></td><td>100</td><td>0</td></tr>
</tbody>
</table>
</div>
<script>
$(document).ready(function() {
    var oTable;
    oTable = $("#percent").DataTable( {
        paging:   false,
        ordering: true,
        info:     true,
        fixedHeader: true,
        order: [2,"asc"],
        dom: "Bft",
        drawCallback: function( settings ) {
             var api = this.api();
             $('.header[id^="listing_"]').next().addBack().css("display","none");
             api.rows( {page:"current"} ).data().each(function(data){
              id = data[0];
              id = id.match(/"(\#.*?)"/);
              if (id){$(id[1]).next().addBack().css("display","block");}
             })
        },      
        buttons: [
        {
            text: "Partly covered (29)",
            titleAttr: "50%",
            className: "active",
            action: function ( e, dt, node, config ) {
                var text = this.text();
                var search = "^(?!(0%|100%)).*";
                oTable.column(2)
                    .search(search,true,false,false)
                    .draw();
                $(".dt-buttons button").removeClass("active");
                this.active( true );
            }
        },
        {
            text: "Uncovered (42)",
            titleAttr: "0%",
            className: "active",
            action: function ( e, dt, node, config ) {
                var text = this.text();
                var search = "^0%";
                oTable.column(2)
                    .search(search,true,false,false)
                    .draw();
                $(".dt-buttons button").removeClass("active");
                this.active( true );
            }
        },
        {
            text: "Fully covered (68)",
            titleAttr: "100%",
            className: "active",
            action: function ( e, dt, node, config ) {
                var text = this.text();
                var search = "100%";
                oTable.column(2)
                    .search(search,true,false,false)
                    .draw();
                $(".dt-buttons button").removeClass("active");
                this.active( true );
            }
        },
        {
            text: "All (139)",
            titleAttr: "all",
            className: "active",
            action: function ( e, dt, node, config ) {
                var text = this.text();
                var search = ".";
                oTable.column(2)
                    .search(search,true,false,false)
                    .draw();
                $(".dt-buttons button").removeClass("active");
                this.active( true );
            }
        },
    ],
 
        columnDefs: [
            {className: "align-right", targets: [2,3]
            },
            {
                render: function ( data, type, row, meta ) {
                            return data+"%" ;        
                        },
                targets: 2
            }
        ]             
    } );
    oTable.button(0).trigger();

} );    
</script>
<h2>Listings</h2>
<code class="header" id="listing_1">#.APLGit2.APLGit2.InitializeGitUserCommand &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> {r}←InitializeGitUserCommand dummy</code>
<code> [1] ⍝ Propagate refs and set global ∆TestFlag</code>
<code class="emphasize">→[2]  r←⍬</code>
<code class="emphasize">→[3]  U.A←A←APLTreeUtils2</code>
<code class="emphasize">→[4]  U.F←F←FilesAndDirs</code>
<code class="emphasize">→[5]  ∆TestFlag←0</code>
<code> [6] ⍝Done</code>
</div>
<code class="header" id="listing_2">#.APLGit2.APLGit2.InitializeProject &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> {r}←InitializeProject dummy</code>
<code class="emphasize">→[1]  r←⍬</code>
<code class="emphasize">→[2]  InitializeGitUserCommand ⍬</code>
<code class="emphasize">→[3]  :If 0=⎕SE.APLGit2.⎕NC'DEVELOPMENT'</code>
<code> [4]  ⍝:AndIf ~parms.batch</code>
<code class="emphasize">→[5]  :AndIf 1 CommTools.YesOrNo'Set DEVELOPMENT←1 in ⎕SE.APLGit2? (Allows executing user command code in # rather than ⎕SE)'</code>
<code class="emphasize">→[6]      ⎕SE.APLGit2.DEVELOPMENT←1</code>
<code> [7]  :EndIf</code>
<code> [8] ⍝Done</code>
</div>
<code class="header" id="listing_3">#.APLGit2.APLGit2._gHYeQiyWvYuaIhlNzUvBDTICZkIpbYUiUZBdZQtB_nXuFVNnUz_UPxxrVyDXFCsMXuCxYytEbskCCXn &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> r←_gHYeQiyWvYuaIhlNzUvBDTICZkIpbYUiUZBdZQtB_nXuFVNnUz_UPxxrVyDXFCsMXuCxYytEbskCCXn</code>
<code class="emphasize">→[1]  r←42</code>
</div>
<code class="header" id="listing_4">#.APLGit2.APLGit2.UC.Add &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> r←Add(space folder args)</code>
<code class="emphasize">→[1]  'Not a URL on GitHub'Assert 0&lt;≢args._1</code>
<code class="emphasize">→[2]  filter←args._1</code>
<code class="emphasize">→[3]  'Invalid filter'Assert 0&lt;≢filter</code>
<code class="emphasize">→[4]  {}filter ##.Add folder</code>
<code class="emphasize">→[5]  r←0 0⍴''</code>
<code> [6] ⍝Done</code>
</div>
<code class="header" id="listing_5">#.APLGit2.APLGit2.UC.AddGitIgnore &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> r←AddGitIgnore y</code>
<code class="emphasize">→[1]  (space folder args)←y</code>
<code class="emphasize">→[2]  r←##.AddGitIgnore folder</code>
<code> [3] ⍝Done</code>
</div>
<code class="header" id="listing_6">#.APLGit2.APLGit2.UC.AddProjectOptions &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> r←AddProjectOptions flag</code>
<code class="emphasize">→[1]  r←help.ProjectOptions1</code>
<code class="emphasize">→[2]  :If flag</code>
<code class="emphasize">→[3]      r,←⊂''</code>
<code class="emphasize">→[4]      r,←help.ProjectOptions2</code>
<code> [5]  :EndIf</code>
</div>
<code class="header" id="listing_7">#.APLGit2.APLGit2.UC.AddSlash &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> path←AddSlash path</code>
<code class="emphasize">→[1]  path,←(~(¯1↑path)∊'/\')/'/'</code>
<code> [2] ⍝Done</code>
</div>
<code class="header" id="listing_8">#.APLGit2.APLGit2.UC.AddTitles &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> r←r AddTitles titles</code>
<code> [1]     ⍝ `r` is a matrix with data. `titles` is put on top of that matrix, followed by a row with `-` matching the lengths of each title</code>
<code class="emphasize">→[2]  r←⍉↑(⊂¨titles),¨' ',¨↓⍉r</code>
<code class="emphasize">→[3]  r[2;]←(≢¨r[1;])⍴¨'-'</code>
<code> [4] ⍝Done</code>
</div>
<code class="header" id="listing_9">#.APLGit2.APLGit2.UC.AtLeastVersion &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  r←AtLeastVersion min</code>
<code> [1]  ⍝ Returns 1 if the currently running version is at least `min`.\\</code>
<code> [2]  ⍝ If the current version is 17.1 then:\\</code>
<code> [3]  ⍝ `1 1 1 0 ←→ AtLeastVersion¨16 17 17.1 18`\\</code>
<code> [4]  ⍝ You may specify a version different from the currently running one via `⍺`:\\</code>
<code> [5]  ⍝ `1 1 0 0 ←→ 17 AtLeastVersion¨16 17 17.1 18`</code>
<code class="emphasize">→[6]   currentVersion←{⊃⊃(//)⎕VFI ⍵/⍨2&gt;+\⍵='.'}2⊃'.'⎕WG'aplversion'</code>
<code class="emphasize">→[7]   'Right argument must be length 1'⎕SIGNAL ErrNo/⍨1≠≢min</code>
<code class="emphasize">→[8]   r←⊃min≤currentVersion</code>
<code> [9]  ⍝Done</code>
</div>
<code class="header" id="listing_10">#.APLGit2.APLGit2.UC.ChangeLog &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> r←ChangeLog(space folder args)</code>
<code class="emphasize">→[1]  name←args._1</code>
<code class="emphasize">→[2]  :If ~(⊃name)∊'#⎕'</code>
<code class="emphasize">→[3]      name←(⍕space),'.',name</code>
<code> [4]  :EndIf</code>
<code class="emphasize">→[5]  ('Not an APL object: ',name)Assert 0&lt;⎕NC name</code>
<code class="emphasize">→[6]  r←folder ##.ChangeLog name</code>
<code> [7] ⍝Done</code>
</div>
<code class="header" id="listing_11">#.APLGit2.APLGit2.UC.Commit &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  r←Commit(space folder args)</code>
<code class="emphasize">→[1]   branch←##.CurrentBranch folder</code>
<code class="emphasize">→[2]   :If 0&lt;##.NoOfUntrackedFiles folder</code>
<code class="emphasize">→[3]       :If 1=args.add</code>
<code class="emphasize">→[4]       :OrIf 1 ⎕SE.CommTools.YesOrNo'Branch "',branch,'" has unstaged changes etc - shall Git''s "Add -A" command be executed?'</code>
<code class="emphasize">→[5]           (rc msg data)←folder ##.U.RunGitCommand'add -A'</code>
<code class="emphasize">→[6]           msg Assert 0=rc</code>
<code> [7]       :Else</code>
<code class="emphasize">→[8]           r←'Cancelled by user' ⋄ →0</code>
<code> [9]       :EndIf</code>
<code> [10]  :EndIf</code>
<code class="emphasize">→[11]  :If 0 args.Switch'amend'</code>
<code class="emphasize">→[12]      status←##.Status folder</code>
<code class="emphasize">→[13]      :If ∨/'nothing to commit, working tree clean'⍷∊status</code>
<code class="emphasize">→[14]      :AndIf 0=≢''args.Switch'm'</code>
<code class="emphasize">→[15]          r←'There is nothing to commit and you have not specified a message either?!' ⋄ →0</code>
<code> [16]      :EndIf</code>
<code class="emphasize">→[17]      currentBranch←##.CurrentBranch folder</code>
<code class="emphasize">→[18]      :If 'main'≡currentBranch</code>
<code class="emphasize">→[19]      :AndIf ~∨/'(use "git push" to publish your local commits)'⍷∊status</code>
<code class="emphasize">→[20]          r←'You MUST NOT use the -amend flag when the latest commit has already been pushed' ⋄ →0</code>
<code> [21]      :EndIf</code>
<code class="emphasize">→[22]      r←⍪({0≡⍵:'' ⋄ ⍵}args.m)##.Commit folder 1</code>
<code> [23]  :Else</code>
<code class="emphasize">→[24]      :If (,0)≢,args.m</code>
<code class="emphasize">→[25]      :AndIf 0&lt;≢args.m</code>
<code class="emphasize">→[26]          msg←args.m</code>
<code> [27]      :Else</code>
<code class="emphasize">→[28]          flag←0</code>
<code class="emphasize">→[29]          :Repeat</code>
<code class="emphasize">→[30]              ref←⎕NS''</code>
<code class="emphasize">→[31]              ref.msg←,⊂''</code>
<code class="emphasize">→[32]              ref.⎕ED'msg'</code>
<code class="emphasize">→[33]              msg←ref.msg{⍺/⍨~(⌽∧\0=⌽⍵)∨(∧\0=⍵)}≢¨ref.msg</code>
<code class="emphasize">→[34]              :If (⊂branch)∊'main' 'master'</code>
<code class="emphasize">→[35]              :AndIf 0=≢(∊msg)~'.'</code>
<code class="emphasize">→[36]                  :If 0=1 ##.CommTools.YesOrNo'You MUST specify a meaningful message for "',branch,'"; try again (no=cancel) ?'</code>
<code class="emphasize">→[37]                      r←'Commit cancelled by user'</code>
<code class="emphasize">→[38]                      :Return</code>
<code> [39]                  :EndIf</code>
<code class="emphasize">→[40]              :ElseIf 0&lt;≢(∊msg)~'.'</code>
<code class="emphasize">→[41]              :OrIf ##.CommTools.YesOrNo'Sure you don''t want to provide a message? ("No" cancells the whole operation)'</code>
<code class="emphasize">→[42]                  flag←1</code>
<code> [43]              :Else</code>
<code class="emphasize">→[44]                  r←'Operation cancelled by user'</code>
<code class="emphasize">→[45]                  :Return</code>
<code> [46]              :EndIf</code>
<code class="emphasize">→[47]              msg←{0=≢⍵:'...' ⋄ ⍵}msg</code>
<code class="emphasize">→[48]              msg←1↓⊃,/(⎕UCS 10),¨⊆msg</code>
<code class="emphasize">→[49]          :Until flag</code>
<code> [50]      :EndIf</code>
<code class="emphasize">→[51]      r←⍪msg ##.Commit folder</code>
<code> [52]  :EndIf</code>
</div>
<code class="header" id="listing_12">#.APLGit2.APLGit2.UC.CompareCommits &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  {(filename1 filename2)}←CompareCommits(space folder args)</code>
<code class="emphasize">→[1]   (hash1 hash2)←{0≡⍵:'' ⋄ ⍵}¨args.(_1 _2)</code>
<code class="emphasize">→[2]   :If (,'.')≡,hash1</code>
<code class="emphasize">→[3]       'Argument is invalid'Assert 0=≢hash2</code>
<code> [4]   :EndIf</code>
<code class="emphasize">→[5]   'Argument is invalid'Assert(,'.')≢hash2</code>
<code class="emphasize">→[6]   buff←folder ##.CompareCommits hash1 hash2</code>
<code class="emphasize">→[7]   (filename1 filename2 hash1 hash2)←4↑buff,'' ''    ⍝ Because old versions of CompareCommits did not return the hashes</code>
<code class="emphasize">→[8]   (hash1 hash2)←{⍵↑⍨¨8⌊≢¨⍵}hash1 hash2              ⍝ Short version suffices</code>
<code class="emphasize">→[9]   :If 0&lt;+/⎕NEXISTS filename1 filename2</code>
<code class="emphasize">→[10]      :If args.files</code>
<code class="emphasize">→[11]          ⎕←filename1 filename2</code>
<code> [12]      :Else</code>
<code class="emphasize">→[13]          :If flag←9=⎕SE.⎕NC'CompareFiles'</code>
<code class="emphasize">→[14]              default←''args.Switch'use'</code>
<code class="emphasize">→[15]              :Trap 911</code>
<code class="emphasize">→[16]                  (exe name)←⎕SE.CompareFiles.EstablishCompareEXE default</code>
<code> [17]              :Else</code>
<code class="emphasize">→[18]                  qdmx←⎕DMX</code>
<code class="emphasize">→[19]                  ⎕←'Comparison with "CompareFiles" crashed'{0=≢⍵:⍺ ⋄ ⍺,' with "',⍵,'"'}qdmx.EM</code>
<code class="emphasize">→[20]                  :Return</code>
<code> [21]              :EndTrap</code>
<code class="emphasize">→[22]          :AndIf 0&lt;≢exe</code>
<code class="emphasize">→[23]              parms←⎕SE.CompareFiles.ComparisonTools.⍎'CreateParmsFor',name</code>
<code class="emphasize">→[24]              parms.(file1 file2)←filename1 filename2</code>
<code class="emphasize">→[25]              :If (,'.')≡hash1</code>
<code class="emphasize">→[26]                  parms.caption1←'Working area'</code>
<code> [27]              :Else</code>
<code class="emphasize">→[28]                  (rc msg hash1_)←folder ##.U.RunGitCommand'show ',hash1,' -q'</code>
<code class="emphasize">→[29]                  parms.caption1←(hash1,{⍵↓⍨⍵⍳' '}{⍵↓⍨⍵⍳' '}1⊃hash1_),' from ',{⍵↓⍨⍵⍳' '}3⊃hash1_</code>
<code> [30]              :EndIf</code>
<code class="emphasize">→[31]              (rc msg hash2_)←folder ##.U.RunGitCommand'show ',hash2,' -q'</code>
<code class="emphasize">→[32]              msg Assert rc=0</code>
<code class="emphasize">→[33]              parms.caption2←(hash2,{⍵↓⍨⍵⍳' '}{⍵↓⍨⍵⍳' '}1⊃hash2_),' from ',{⍵↓⍨⍵⍳' '}3⊃hash2_</code>
<code class="emphasize">→[34]              {}⎕SE.CompareFiles.Compare parms</code>
<code class="emphasize">→[35]              ⎕DL 1.2×{0=⍵.⎕NC'edit1':0 ⋄ 0=⍵.(edit1+edit2)}parms ⍝ Avoild deletion/early deletion</code>
<code class="emphasize">→[36]              ⎕NDELETE filename1 filename2</code>
<code class="emphasize">→[37]              (filename1 filename2)←⊂''</code>
<code> [38]          :Else</code>
<code class="emphasize">→[39]              ⎕←filename1 filename2</code>
<code> [40]          :EndIf</code>
<code> [41]      :EndIf</code>
<code> [42]  :EndIf</code>
</div>
<code class="header" id="listing_13">#.APLGit2.APLGit2.UC.Diff &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> r←Diff(space folder args)</code>
<code class="emphasize">→[1]  r←⍪args.verbose ##.Diff folder</code>
<code> [2] ⍝Done</code>
</div>
<code class="header" id="listing_14">#.APLGit2.APLGit2.UC.ErrNo &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> r←ErrNo</code>
<code class="emphasize">→[1]  r←811</code>
</div>
<code class="header" id="listing_15">#.APLGit2.APLGit2.UC.GetDefaultProject &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> r←GetDefaultProject dummy</code>
<code class="emphasize">→[1]  r←##.GetDefaultProject dummy</code>
<code> [2] ⍝Done</code>
</div>
<code class="header" id="listing_16">#.APLGit2.APLGit2.UC.GetRefToAPLGit2 &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> ref←GetRefToAPLGit2 dummy</code>
<code class="emphasize">→[1]  :If 9=#.⎕NC'APLGit2.APLGit2'</code>
<code class="emphasize">→[2]  :AndIf 0&lt;⎕SE.APLGit2.⎕NC'DEVELOPMENT'</code>
<code class="emphasize">→[3]  :AndIf ⎕SE.APLGit2.DEVELOPMENT</code>
<code class="emphasize">→[4]  :AndIf 0={0=⍵.⎕NC'∆TestFlag':0 ⋄ ⍵.∆TestFlag}#.APLGit2.APLGit2</code>
<code class="emphasize">→[5]      ref←#.APLGit2.APLGit2.API</code>
<code> [6]  :Else</code>
<code class="emphasize">→[7]      ref←⎕SE.APLGit2</code>
<code> [8]  :EndIf</code>
</div>
<code class="header" id="listing_17">#.APLGit2.APLGit2.UC.GetSpaceAndFolder &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  (r space folder)←GetSpaceAndFolder(Cmd args)</code>
<code class="emphasize">→[1]   r←0 0⍴''</code>
<code class="emphasize">→[2]   space←folder←''</code>
<code class="emphasize">→[3]   :If 'stashpush'≡⎕C Cmd</code>
<code class="emphasize">→[4]   :AndIf (,'?')≡,args._1</code>
<code class="emphasize">→[5]       (space folder)←##.EstablishProject''</code>
<code class="emphasize">→[6]       args._2←args._1</code>
<code class="emphasize">→[7]       args._1←folder</code>
<code class="emphasize">→[8]   :ElseIf ~(⊂Cmd)∊'GetDefaultProject' 'SetDefaultProject' 'Version'</code>
<code class="emphasize">→[9]       :If ({⍵⊃⍨⍸⍵.Name≡¨⊂Cmd}List ⍬)._Project</code>
<code class="emphasize">→[10]      :AndIf 0≢args._1</code>
<code class="emphasize">→[11]          (space folder)←GetSpaceAndFolder_ args._1</code>
<code class="emphasize">→[12]          ('Project &lt;',args._1,'&gt; not found on disk')Assert 0&lt;≢folder</code>
<code class="emphasize">→[13]      :ElseIf 2=args.⎕NC'project'</code>
<code class="emphasize">→[14]      :AndIf (,0)≢,args.project</code>
<code class="emphasize">→[15]      :AndIf 0&lt;≢args.project</code>
<code class="emphasize">→[16]          (space folder)←GetSpaceAndFolder_ args.project</code>
<code> [17]      :Else</code>
<code class="emphasize">→[18]          (space folder)←##.EstablishProject''</code>
<code> [19]      :EndIf</code>
<code class="emphasize">→[20]      :If 0=≢space,folder</code>
<code class="emphasize">→[21]          :If 1 ##.CommTools.YesOrNo'Act on the current directory (',(⊃1 ⎕NPARTS''),') ?'</code>
<code class="emphasize">→[22]              folder←⊃1 ⎕NPARTS''</code>
<code> [23]          :Else</code>
<code class="emphasize">→[24]              r←'No argument provided',(9=⎕SE.⎕NC'Cider')/' and no open Cider project(s) found.'</code>
<code> [25]          :EndIf</code>
<code class="emphasize">→[26]      :ElseIf ~(⊂Cmd)∊,⊂'OpenGitShell'</code>
<code class="emphasize">→[27]          ('&lt;',folder,'&gt; not found on disk')Assert ⎕NEXISTS folder</code>
<code> [28]      :EndIf</code>
<code> [29]  :EndIf</code>
</div>
<code class="header" id="listing_18">#.APLGit2.APLGit2.UC.GetSpaceAndFolder_ &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> (space folder)←GetSpaceAndFolder_ data</code>
<code class="emphasize">→[1]  :If ∨/'/\:'∊data</code>
<code class="emphasize">→[2]  :OrIf ~(⊃data)∊'#⎕'</code>
<code class="emphasize">→[3]      folder←data</code>
<code class="emphasize">→[4]      space←##.GetProjectFromPath folder</code>
<code> [5]  :Else</code>
<code class="emphasize">→[6]      space←data</code>
<code class="emphasize">→[7]      folder←##.GetPathFromProject space</code>
<code> [8]  :EndIf</code>
</div>
<code class="header" id="listing_19">#.APLGit2.APLGit2.UC.GetTagOfLatestRelease &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  r←GetTagOfLatestRelease(project path args)</code>
<code class="emphasize">→[1]   r←''</code>
<code class="emphasize">→[2]   :If 0≡args.username</code>
<code class="emphasize">→[3]       wsPathRef←⍎{l←⎕SE.Cider.ListOpenProjects 0 ⋄ ⊃l[l[;2]⍳⊂⍵;]}path</code>
<code class="emphasize">→[4]       username←{(¯1+≢⍵)⊃⍵}'/'(≠⊆⊢)wsPathRef.CiderConfig.CIDER.project_url</code>
<code> [5]   :Else</code>
<code class="emphasize">→[6]       username←args.username</code>
<code> [7]   :EndIf</code>
<code class="emphasize">→[8]   project←wsPathRef.CiderConfig.CIDER.projectSpace</code>
<code class="emphasize">→[9]   r←args.verbose ##.GetTagOfLatestRelease username project</code>
<code> [10] ⍝Done</code>
</div>
<code class="header" id="listing_20">#.APLGit2.APLGit2.UC.Help &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  r←level Help Cmd</code>
<code class="emphasize">→[1]   r←''</code>
<code class="emphasize">→[2]   :Select level</code>
<code class="emphasize">→[3]   :Case 0</code>
<code class="emphasize">→[4]       :Select ⎕C Cmd</code>
<code class="emphasize">→[5]       :Case ⎕C'Add'</code>
<code class="emphasize">→[6]           r,←⊂']APLGit2.add &lt;filter&gt; -project='</code>
<code class="emphasize">→[7]       :Case ⎕C'AddGitIgnore'</code>
<code class="emphasize">→[8]           r,←⊂']APLGit2.AddGitIgnore [space|folder]'</code>
<code class="emphasize">→[9]       :Case ⎕C'ChangeLog &lt;apl-name&gt; -project='</code>
<code class="emphasize">→[10]          r,←⊂']APLGit2.ChangeLog &lt;filter&gt; -project='</code>
<code class="emphasize">→[11]      :Case ⎕C'Commit'</code>
<code class="emphasize">→[12]          r,←⊂']APLGit2.Commit [space|folder] -m= -add -amend'</code>
<code class="emphasize">→[13]      :Case ⎕C'CompareCommits'</code>
<code class="emphasize">→[14]          r,←⊂']APLGit2.CompareCommits [hash1] [hash2] -project= -use=[name|?] -view'</code>
<code class="emphasize">→[15]      :Case ⎕C'CurrentBranch'</code>
<code class="emphasize">→[16]          r,←⊂']APLGit2.CurrenBranch [space|folder]'</code>
<code class="emphasize">→[17]      :Case ⎕C'Diff'</code>
<code class="emphasize">→[18]          r,←⊂']APLGit2.Diff [space|folder] -verbose'</code>
<code class="emphasize">→[19]      :Case ⎕C'GetDefaultProject'</code>
<code class="emphasize">→[20]          r,←⊂']GetDefaultProject'</code>
<code class="emphasize">→[21]      :Case ⎕C'GetTagOfLatestRelease'</code>
<code class="emphasize">→[22]          r,←⊂']APLGit2.GetTagOfLatestRelease [space|folder]'</code>
<code class="emphasize">→[23]      :Case ⎕C'Init'</code>
<code class="emphasize">→[24]          r,←⊂']APLGit2.Init [folder] -quiet'</code>
<code class="emphasize">→[25]      :Case ⎕C'IsDirty'</code>
<code class="emphasize">→[26]          r,←⊂']APLGit2.IsDirty [space|folder]'</code>
<code class="emphasize">→[27]      :Case ⎕C'IsGitProject'</code>
<code class="emphasize">→[28]          r,←⊂']APLGit2.IsGitProject [space|folder]'</code>
<code class="emphasize">→[29]      :Case ⎕C'ListBranches'</code>
<code class="emphasize">→[30]          r,←⊂']APLGit2.ListBranches [space|folder] -a -r'</code>
<code class="emphasize">→[31]      :Case ⎕C'Log'</code>
<code class="emphasize">→[32]          r,←⊂']APLGit2.Log [space|folder] -since= -verbose -max= -name='</code>
<code class="emphasize">→[33]      :Case ⎕C'NoOfUntrackedFiles'</code>
<code class="emphasize">→[34]          r,←⊂']APLGit2.NoOfUntrackedFiles [space|folder]'</code>
<code class="emphasize">→[35]      :Case ⎕C'OpenGitShell'</code>
<code class="emphasize">→[36]          r,←⊂']APLGit2.OpenGitShell [space|folder]'</code>
<code class="emphasize">→[37]      :Case ⎕C'RefLog'</code>
<code class="emphasize">→[38]          r,←⊂']APLGit2.RefLog [space|folder] -max= -all -branch= -project='</code>
<code class="emphasize">→[39]      :Case ⎕C'SetDefaultProject'</code>
<code class="emphasize">→[40]          r,←⊂']APLGit2.SetDefaultProject [space|folder]'</code>
<code class="emphasize">→[41]      :Case ⎕C'Status'</code>
<code class="emphasize">→[42]          r,←⊂']APLGit2.Status -short -path='</code>
<code class="emphasize">→[43]      :Case ⎕C'StashApply'</code>
<code class="emphasize">→[44]          r,←⊂']APLGit2.StashApply [space|folder] -n=&lt;number of stash&gt;'</code>
<code class="emphasize">→[45]      :Case ⎕C'StashClear'</code>
<code class="emphasize">→[46]          r,←⊂']APLGit2.StashClear [space|folder]'</code>
<code class="emphasize">→[47]      :Case ⎕C'StashDrop'</code>
<code class="emphasize">→[48]          r,←⊂']APLGit2.StashDrop [space|folder] -n='</code>
<code class="emphasize">→[49]      :Case ⎕C'StashList'</code>
<code class="emphasize">→[50]          r,←⊂']APLGit2.StashList [space|folder]'</code>
<code class="emphasize">→[51]      :Case ⎕C'StashPop'</code>
<code class="emphasize">→[52]          r,←⊂']APLGit2.StashPop [space|folder] -n='</code>
<code class="emphasize">→[53]      :Case ⎕C'StashPush'</code>
<code class="emphasize">→[54]          r,←⊂']APLGit2.StashPush [space|folder]'</code>
<code class="emphasize">→[55]      :Case ⎕C'StashShow'</code>
<code class="emphasize">→[56]          r,←⊂']APLGit2.StashShow [space|folder] [n]'</code>
<code class="emphasize">→[57]      :Case ⎕C'Squash'</code>
<code class="emphasize">→[58]          r,←⊂']APLGit2.Squash [space|folder] [noOf] -m=&lt;message&gt;'</code>
<code class="emphasize">→[59]      :Case ⎕C'Version'</code>
<code class="emphasize">→[60]          r,←⊂']APLGit2.Version'</code>
<code> [61]      :Else</code>
<code class="emphasize">→[62]          r,←⊂'There is no help available'</code>
<code> [63]      :EndSelect</code>
<code class="emphasize">→[64]      :If 'Version'≢Cmd</code>
<code class="emphasize">→[65]          r,←''(']APLGit2.',Cmd,' -?? ⍝ Enter this for more information ')</code>
<code> [66]      :EndIf</code>
<code> [67] </code>
<code class="emphasize">→[68]  :Case 1</code>
<code class="emphasize">→[69]      ('No second-level help found for ',Cmd)Assert 0&lt;help.⎕NC Cmd</code>
<code class="emphasize">→[70]      r←help⍎Cmd</code>
<code class="emphasize">→[71]  :Case 2</code>
<code class="emphasize">→[72]      ('No third-level help found for ',Cmd)Assert 0&lt;help.⎕NC Cmd</code>
<code class="emphasize">→[73]      :Select ⎕C Cmd</code>
<code class="emphasize">→[74]      :CaseList ⎕C¨'Add' ''</code>
<code class="emphasize">→[75]          r,←AddProjectOptions 1</code>
<code class="emphasize">→[76]      :CaseList ⎕C¨'Commit' 'CurrentBranch' 'Diff' 'IsDirty' 'IsGitProject' 'ListBranches' 'Log' 'OpenGitShell' 'Status'</code>
<code class="emphasize">→[77]          r,←AddProjectOptions 0</code>
<code> [78]      :Else</code>
<code class="emphasize">→[79]          r,←⊂'There is no additional help available'</code>
<code> [80]      :EndSelect</code>
<code> [81] </code>
<code> [82]  :EndSelect</code>
</div>
<code class="header" id="listing_21">#.APLGit2.APLGit2.UC.Init &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> r←Init(space folder args)</code>
<code class="emphasize">→[1]  ('This folder is already managed by Git: ',folder)Assert~##.IsGitProject folder</code>
<code class="emphasize">→[2]  :If args.quiet</code>
<code class="emphasize">→[3]  :OrIf ##.CommTools.YesOrNo'Sure that you want to make ',folder,' a Git-managed folder?'</code>
<code class="emphasize">→[4]      r←args.quiet ##.Init folder</code>
<code> [5]  :EndIf</code>
</div>
<code class="header" id="listing_22">#.APLGit2.APLGit2.UC.IsDirty &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> r←IsDirty(space folder args)</code>
<code class="emphasize">→[1]  r←##.IsDirty folder</code>
<code class="emphasize">→[2]  r←(r+1)⊃'Clean' 'Dirty'</code>
<code> [3] ⍝Done</code>
</div>
<code class="header" id="listing_23">#.APLGit2.APLGit2.UC.IsGitProject &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> r←IsGitProject(space folder args)</code>
<code class="emphasize">→[1]  r←(1+##.IsGitProject folder)⊃'no' 'yes'</code>
<code> [2] ⍝Done</code>
</div>
<code class="header" id="listing_24">#.APLGit2.APLGit2.UC.List &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>   r←List dummy</code>
<code class="emphasize">→[1]    r←⍬</code>
<code class="emphasize">→[2]    :If AtLeastVersion⊃(//)⎕VFI MinimumVersionOfDyalog</code>
<code class="emphasize">→[3]        c←⎕NS''</code>
<code class="emphasize">→[4]        c.Name←'Add'</code>
<code class="emphasize">→[5]        c.Desc←'Executes the git "Add" commands'</code>
<code class="emphasize">→[6]        c.Group←'APLGit2'</code>
<code class="emphasize">→[7]        c.Parse←'1 -project='</code>
<code class="emphasize">→[8]        c._Project←0</code>
<code class="emphasize">→[9]        r,←c</code>
<code> [10]  </code>
<code class="emphasize">→[11]       c←⎕NS''</code>
<code class="emphasize">→[12]       c.Name←'AddGitIgnore'</code>
<code class="emphasize">→[13]       c.Desc←'Create a file .gitignore, or merge default values with existing one'</code>
<code class="emphasize">→[14]       c.Group←'APLGit2'</code>
<code class="emphasize">→[15]       c.Parse←'1s'</code>
<code class="emphasize">→[16]       c._Project←0</code>
<code class="emphasize">→[17]       r,←c</code>
<code> [18]  </code>
<code class="emphasize">→[19]       c←⎕NS''</code>
<code class="emphasize">→[20]       c.Name←'ListBranches'</code>
<code class="emphasize">→[21]       c.Desc←'Lists all branches for a Git-managed project'</code>
<code class="emphasize">→[22]       c.Group←'APLGit2'</code>
<code class="emphasize">→[23]       c.Parse←'1s -a -r'</code>
<code class="emphasize">→[24]       c._Project←1</code>
<code class="emphasize">→[25]       r,←c</code>
<code> [26]  </code>
<code class="emphasize">→[27]       c←⎕NS''</code>
<code class="emphasize">→[28]       c.Name←'ChangeLog'</code>
<code class="emphasize">→[29]       c.Desc←'Takes an APL name and list all commits the object was part of'</code>
<code class="emphasize">→[30]       c.Group←'APLGit2'</code>
<code class="emphasize">→[31]       c.Parse←'1 -project='</code>
<code class="emphasize">→[32]       c._Project←0</code>
<code class="emphasize">→[33]       r,←c</code>
<code> [34]  </code>
<code class="emphasize">→[35]       c←⎕NS''</code>
<code class="emphasize">→[36]       c.Name←'Commit'</code>
<code class="emphasize">→[37]       c.Desc←'Performs a commit on the current branch'</code>
<code class="emphasize">→[38]       c.Group←'APLGit2'</code>
<code class="emphasize">→[39]       c.Parse←'1s -m= -add -amend'</code>
<code class="emphasize">→[40]       c._Project←1</code>
<code class="emphasize">→[41]       r,←c</code>
<code> [42]  </code>
<code class="emphasize">→[43]       c←⎕NS''</code>
<code class="emphasize">→[44]       c.Name←'CompareCommits'</code>
<code class="emphasize">→[45]       c.Desc←'Compares two different commits'</code>
<code class="emphasize">→[46]       c.Group←'APLGit2'</code>
<code class="emphasize">→[47]       c.Parse←'2s -project= -use= -files'</code>
<code class="emphasize">→[48]       c._Project←0</code>
<code class="emphasize">→[49]       r,←c</code>
<code> [50]  </code>
<code class="emphasize">→[51]       c←⎕NS''</code>
<code class="emphasize">→[52]       c.Name←'Diff'</code>
<code class="emphasize">→[53]       c.Desc←'Produces a list with changed/deleted/added files by comparing the working directory with HEAD'</code>
<code class="emphasize">→[54]       c.Group←'APLGit2'</code>
<code class="emphasize">→[55]       c.Parse←'1s -verbose'</code>
<code class="emphasize">→[56]       c._Project←1</code>
<code class="emphasize">→[57]       r,←c</code>
<code> [58]  </code>
<code class="emphasize">→[59]       c←⎕NS''</code>
<code class="emphasize">→[60]       c.Name←'GetDefaultProject'</code>
<code class="emphasize">→[61]       c.Desc←'Returns namespace and folder of the current default project, if any'</code>
<code class="emphasize">→[62]       c.Group←'APLGit2'</code>
<code class="emphasize">→[63]       c.Parse←'0'</code>
<code class="emphasize">→[64]       c._Project←0</code>
<code class="emphasize">→[65]       r,←c</code>
<code> [66]  </code>
<code class="emphasize">→[67]       c←⎕NS''</code>
<code class="emphasize">→[68]       c.Name←'GetTagOfLatestRelease'</code>
<code class="emphasize">→[69]       c.Desc←'Returns the tag of the latest release'</code>
<code class="emphasize">→[70]       c.Group←'APLGit2'</code>
<code class="emphasize">→[71]       c.Parse←'1s -verbose -username='</code>
<code class="emphasize">→[72]       c._Project←1</code>
<code class="emphasize">→[73]       r,←c</code>
<code> [74]  </code>
<code class="emphasize">→[75]       c←⎕NS''</code>
<code class="emphasize">→[76]       c.Name←'Init'</code>
<code class="emphasize">→[77]       c.Desc←'Initialises a folder for managing it by Git'</code>
<code class="emphasize">→[78]       c.Group←'APLGit2'</code>
<code class="emphasize">→[79]       c.Parse←'1s -quiet'</code>
<code class="emphasize">→[80]       c._Project←1</code>
<code class="emphasize">→[81]       r,←c</code>
<code> [82]  </code>
<code class="emphasize">→[83]       c←⎕NS''</code>
<code class="emphasize">→[84]       c.Name←'IsDirty'</code>
<code class="emphasize">→[85]       c.Desc←'Reports whether there are uncommited changes'</code>
<code class="emphasize">→[86]       c.Group←'APLGit2'</code>
<code class="emphasize">→[87]       c.Parse←'1s'</code>
<code class="emphasize">→[88]       c._Project←1</code>
<code class="emphasize">→[89]       r,←c</code>
<code> [90]  </code>
<code class="emphasize">→[91]       c←⎕NS''</code>
<code class="emphasize">→[92]       c.Name←'IsGitProject'</code>
<code class="emphasize">→[93]       c.Desc←'Returns "yes" or "no" depending on whether there is a ./.git folder'</code>
<code class="emphasize">→[94]       c.Group←'APLGit2'</code>
<code class="emphasize">→[95]       c.Parse←'1s'</code>
<code class="emphasize">→[96]       c._Project←1</code>
<code class="emphasize">→[97]       r,←c</code>
<code> [98]  </code>
<code class="emphasize">→[99]       c←⎕NS''</code>
<code class="emphasize">→[100]      c.Name←'Log'</code>
<code class="emphasize">→[101]      c.Desc←'Shows the commit logs'</code>
<code class="emphasize">→[102]      c.Group←'APLGit2'</code>
<code class="emphasize">→[103]      c.Parse←'2s -verbose -name= -commit='</code>
<code class="emphasize">→[104]      c._Project←1</code>
<code class="emphasize">→[105]      r,←c</code>
<code> [106] </code>
<code class="emphasize">→[107]      c←⎕NS''</code>
<code class="emphasize">→[108]      c.Name←'NoOfUntrackedFiles'</code>
<code class="emphasize">→[109]      c.Desc←'Returns the number of untracked files'</code>
<code class="emphasize">→[110]      c.Group←'APLGit2'</code>
<code class="emphasize">→[111]      c.Parse←'1s'</code>
<code class="emphasize">→[112]      c._Project←1</code>
<code class="emphasize">→[113]      r,←c</code>
<code> [114] </code>
<code class="emphasize">→[115]      c←⎕NS''</code>
<code class="emphasize">→[116]      c.Name←'OpenGitShell'</code>
<code class="emphasize">→[117]      c.Desc←'Opens a Git shell for a Git managed project'</code>
<code class="emphasize">→[118]      c.Group←'APLGit2'</code>
<code class="emphasize">→[119]      c.Parse←'1s'</code>
<code class="emphasize">→[120]      c._Project←1</code>
<code class="emphasize">→[121]      r,←c</code>
<code> [122] </code>
<code class="emphasize">→[123]      c←⎕NS''</code>
<code class="emphasize">→[124]      c.Name←'RefLog'</code>
<code class="emphasize">→[125]      c.Desc←'List reference log entries (RefLogs)'</code>
<code class="emphasize">→[126]      c.Group←'APLGit2'</code>
<code class="emphasize">→[127]      c.Parse←'1s -max= -all -branch= -project='</code>
<code class="emphasize">→[128]      c._Project←1</code>
<code class="emphasize">→[129]      r,←c</code>
<code> [130] </code>
<code class="emphasize">→[131]      c←⎕NS''</code>
<code class="emphasize">→[132]      c.Name←'SetDefaultProject'</code>
<code class="emphasize">→[133]      c.Desc←'Specifies the project to be used in case no project is specified'</code>
<code class="emphasize">→[134]      c.Group←'APLGit2'</code>
<code class="emphasize">→[135]      c.Parse←'1s'</code>
<code class="emphasize">→[136]      c._Project←1</code>
<code class="emphasize">→[137]      r,←c</code>
<code> [138] </code>
<code class="emphasize">→[139]      c←⎕NS''</code>
<code class="emphasize">→[140]      c.Name←'Squash'</code>
<code class="emphasize">→[141]      c.Desc←'Squashes some commits in the current branch into a single one'</code>
<code class="emphasize">→[142]      c.Group←'APLGit2'</code>
<code class="emphasize">→[143]      c.Parse←'2s -m='</code>
<code class="emphasize">→[144]      c._Project←1</code>
<code class="emphasize">→[145]      r,←c</code>
<code> [146] </code>
<code class="emphasize">→[147]      c←⎕NS''</code>
<code class="emphasize">→[148]      c.Name←'StashList'</code>
<code class="emphasize">→[149]      c.Desc←'List all stashes, if any'</code>
<code class="emphasize">→[150]      c.Group←'APLGit2'</code>
<code class="emphasize">→[151]      c.Parse←'1s'</code>
<code class="emphasize">→[152]      c._Project←1</code>
<code class="emphasize">→[153]      r,←c</code>
<code> [154] </code>
<code class="emphasize">→[155]      c←⎕NS''</code>
<code class="emphasize">→[156]      c.Name←'StashShow'</code>
<code class="emphasize">→[157]      c.Desc←'Shows all files of a stash (default is the last one)'</code>
<code class="emphasize">→[158]      c.Group←'APLGit2'</code>
<code class="emphasize">→[159]      c.Parse←'1s -n= -p'</code>
<code class="emphasize">→[160]      c._Project←1</code>
<code class="emphasize">→[161]      r,←c</code>
<code> [162] </code>
<code class="emphasize">→[163]      c←⎕NS''</code>
<code class="emphasize">→[164]      c.Name←'StashPush'</code>
<code class="emphasize">→[165]      c.Desc←'Save your local modifications to a new stash entry and roll them back to HEAD (in the working tree and in the index)'</code>
<code class="emphasize">→[166]      c.Group←'APLGit2'</code>
<code class="emphasize">→[167]      c.Parse←'999s -m= -u'</code>
<code class="emphasize">→[168]      c._Project←1</code>
<code class="emphasize">→[169]      r,←c</code>
<code> [170] </code>
<code class="emphasize">→[171]      c←⎕NS''</code>
<code class="emphasize">→[172]      c.Name←'StashPop'</code>
<code class="emphasize">→[173]      c.Desc←'Apply a stash to the working area &amp; remove from stash stack, by default the last one'</code>
<code class="emphasize">→[174]      c.Group←'APLGit2'</code>
<code class="emphasize">→[175]      c.Parse←'1s -n='</code>
<code class="emphasize">→[176]      c._Project←1</code>
<code class="emphasize">→[177]      r,←c</code>
<code> [178] </code>
<code class="emphasize">→[179]      c←⎕NS''</code>
<code class="emphasize">→[180]      c.Name←'StashApply'</code>
<code class="emphasize">→[181]      c.Desc←'(Re)-apply stash (by default the last one) to the working area &amp; DO NOT remove from stash stack'</code>
<code class="emphasize">→[182]      c.Group←'APLGit2'</code>
<code class="emphasize">→[183]      c.Parse←'1s -n='</code>
<code class="emphasize">→[184]      c._Project←1</code>
<code class="emphasize">→[185]      r,←c</code>
<code> [186] </code>
<code class="emphasize">→[187]      c←⎕NS''</code>
<code class="emphasize">→[188]      c.Name←'StashClear'</code>
<code class="emphasize">→[189]      c.Desc←'Delete all stashes'</code>
<code class="emphasize">→[190]      c.Group←'APLGit2'</code>
<code class="emphasize">→[191]      c.Parse←'1s'</code>
<code class="emphasize">→[192]      c._Project←1</code>
<code class="emphasize">→[193]      r,←c</code>
<code> [194] </code>
<code class="emphasize">→[195]      c←⎕NS''</code>
<code class="emphasize">→[196]      c.Name←'StashDrop'</code>
<code class="emphasize">→[197]      c.Desc←'Drop latest or given stash'</code>
<code class="emphasize">→[198]      c.Group←'APLGit2'</code>
<code class="emphasize">→[199]      c.Parse←'1s -n='</code>
<code class="emphasize">→[200]      c._Project←1</code>
<code class="emphasize">→[201]      r,←c</code>
<code> [202] </code>
<code class="emphasize">→[203]      c←⎕NS''</code>
<code class="emphasize">→[204]      c.Name←'Status'</code>
<code class="emphasize">→[205]      c.Desc←'Reports all untracked files and/or all uncommitted changes'</code>
<code class="emphasize">→[206]      c.Group←'APLGit2'</code>
<code class="emphasize">→[207]      c.Parse←'1s -short'</code>
<code class="emphasize">→[208]      c._Project←1</code>
<code class="emphasize">→[209]      r,←c</code>
<code> [210] </code>
<code class="emphasize">→[211]      c←⎕NS''</code>
<code class="emphasize">→[212]      c.Name←'Version'</code>
<code class="emphasize">→[213]      c.Desc←'Returns name, version number and version date as a three-element vector'</code>
<code class="emphasize">→[214]      c.Group←'APLGit2'</code>
<code class="emphasize">→[215]      c.Parse←''</code>
<code class="emphasize">→[216]      c._Project←0</code>
<code class="emphasize">→[217]      r,←c</code>
<code> [218]  :EndIf</code>
</div>
<code class="header" id="listing_25">#.APLGit2.APLGit2.UC.ListBranches &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  r←ListBranches(space folder args)</code>
<code class="emphasize">→[1]   :If (,0)≢,args.a</code>
<code class="emphasize">→[2]       parms←'-a'</code>
<code class="emphasize">→[3]   :ElseIf (,0)≢,args.r</code>
<code class="emphasize">→[4]       parms←'-r'</code>
<code> [5]   :Else</code>
<code class="emphasize">→[6]       parms←''</code>
<code> [7]   :EndIf</code>
<code class="emphasize">→[8]   r←⍪parms ##.ListBranches folder</code>
<code> [9]  ⍝Done</code>
</div>
<code class="header" id="listing_26">#.APLGit2.APLGit2.UC.Log &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  r←Log(space folder args)</code>
<code class="emphasize">→[1]   parms←⎕NS''</code>
<code class="emphasize">→[2]   parms.verbose←args.verbose</code>
<code class="emphasize">→[3]   parms.max←¯1</code>
<code class="emphasize">→[4]   parms.since←''</code>
<code class="emphasize">→[5]   parms.name←''args.Switch'name'</code>
<code class="emphasize">→[6]   parms.commit←''args.Switch'commit'</code>
<code class="emphasize">→[7]   parms(ProcessLogParms)←(1+0≡args._2)⊃args.(_2 _1)</code>
<code class="emphasize">→[8]   r←parms ##.Log folder</code>
<code> [9]  ⍝Done</code>
</div>
<code class="header" id="listing_27">#.APLGit2.APLGit2.UC.MinimumVersionOfDyalog &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> r←MinimumVersionOfDyalog</code>
<code class="emphasize">→[1]  r←'18.0'</code>
</div>
<code class="header" id="listing_28">#.APLGit2.APLGit2.UC.NoOfUntrackedFiles &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> r←NoOfUntrackedFiles(space folder Args)</code>
<code class="emphasize">→[1]  r←##.NoOfUntrackedFiles folder</code>
<code> [2] ⍝Done</code>
</div>
<code class="header" id="listing_29">#.APLGit2.APLGit2.UC.OpenGitShell &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> r←OpenGitShell(space folder args)</code>
<code class="emphasize">→[1]  r←''</code>
<code class="emphasize">→[2]  {}##.OpenGitShell folder</code>
<code> [3] ⍝Done</code>
</div>
<code class="header" id="listing_30">#.APLGit2.APLGit2.UC.ProcessLogParms &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> parms←parms ProcessLogParms data</code>
<code class="emphasize">→[1]  :If 0≢data</code>
<code class="emphasize">→[2]      :If {(10=≢⍵)∧∧/(({⊃⍵↑⍨1⌈≢⍵}1↑(⍵~'-')∊⎕D)('-'=⊃1↑∪⍵~⎕D))}data ⍝ Is it something like "1934-01-31"?</code>
<code class="emphasize">→[3]          parms.since←data</code>
<code class="emphasize">→[4]      :ElseIf ⊃⊃⎕VFI data   ⍝ Max?!</code>
<code class="emphasize">→[5]      :AndIf 0&lt;max←⊃(//)⎕VFI data</code>
<code class="emphasize">→[6]          parms.max←max</code>
<code> [7]      :EndIf</code>
<code> [8]  :EndIf</code>
</div>
<code class="header" id="listing_31">#.APLGit2.APLGit2.UC.RefLog &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  r←RefLog(space folder args)</code>
<code class="emphasize">→[1]   :If (,0)≡args.branch</code>
<code class="emphasize">→[2]       branch←''</code>
<code> [3]   :Else</code>
<code class="emphasize">→[4]       branch←args.branch</code>
<code> [5]   :EndIf</code>
<code class="emphasize">→[6]   :If (,0)≡,args.max</code>
<code class="emphasize">→[7]       r←folder ##.RefLog~args.all</code>
<code> [8]   :Else</code>
<code class="emphasize">→[9]       r←folder ##.RefLog 0</code>
<code class="emphasize">→[10]      (flag value)←⎕VFI args.max</code>
<code class="emphasize">→[11]      '"max" must be a positive integer'Assert flag</code>
<code class="emphasize">→[12]      r←value↑r</code>
<code> [13]  :EndIf</code>
</div>
<code class="header" id="listing_32">#.APLGit2.APLGit2.UC.SetDefaultProject &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> r←SetDefaultProject(space folder Args)</code>
<code class="emphasize">→[1]  r←##.SetDefaultProject{⍵/⍨0≠⍵}Args._1</code>
<code> [2] ⍝Done</code>
</div>
<code class="header" id="listing_33">#.APLGit2.APLGit2.UC.Squash &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> r←Squash(space folder Args)</code>
<code class="emphasize">→[1]  msg←''Args.Switch'm'</code>
<code class="emphasize">→[2]  noOf←⊃(//)⎕VFI(⍕(1+∧/Args._1∊⎕D)⊃Args.(_2 _1)),' +0'</code>
<code class="emphasize">→[3]  'Number of commits to be squashed must be a positive integer'Assert(⎕DR noOf)∊83 163 323</code>
<code class="emphasize">→[4]  'Number of commits to be squashed must be a positive integer'Assert noOf≥0</code>
<code class="emphasize">→[5]  r←⍪folder ##.Squash msg noOf</code>
<code> [6] ⍝Done</code>
</div>
<code class="header" id="listing_34">#.APLGit2.APLGit2.UC.StashApply &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> r←StashApply(space folder Args)</code>
<code> [1] ⍝ Applies the given or last stash and remove it from the stash stack</code>
<code class="emphasize">→[2]  stashNo←0 Args.Switch'n'</code>
<code class="emphasize">→[3]  r←↑stashNo ##.StashApply folder</code>
<code> [4] ⍝Done</code>
</div>
<code class="header" id="listing_35">#.APLGit2.APLGit2.UC.StashClear &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> r←StashClear(space folder Args)</code>
<code class="emphasize">→[1]  r←↑##.StashClear folder</code>
<code> [2] ⍝Done</code>
</div>
<code class="header" id="listing_36">#.APLGit2.APLGit2.UC.StashDrop &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> r←StashDrop(space folder Args)</code>
<code class="emphasize">→[1]  n←0 Args.Switch'n'</code>
<code class="emphasize">→[2]  r←↑n ##.StashDrop folder</code>
<code> [3] ⍝Done</code>
</div>
<code class="header" id="listing_37">#.APLGit2.APLGit2.UC.StashList &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> r←StashList(space folder Args)</code>
<code class="emphasize">→[1]  r←↑##.StashList folder</code>
<code> [2] ⍝Done</code>
</div>
<code class="header" id="listing_38">#.APLGit2.APLGit2.UC.StashPop &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> r←StashPop(space folder Args)</code>
<code class="emphasize">→[1]  stashNo←0 Args.Switch'n'</code>
<code class="emphasize">→[2]  r←↑stashNo ##.StashPop folder</code>
<code> [3] ⍝Done</code>
</div>
<code class="header" id="listing_39">#.APLGit2.APLGit2.UC.StashPush &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  r←StashPush(space folder Args)</code>
<code> [1]  ⍝ Stashes all files in the working area</code>
<code class="emphasize">→[2]   parms←##.CreateStashPushParms</code>
<code class="emphasize">→[3]   parms.folder←folder</code>
<code class="emphasize">→[4]   :If 1&lt;≡Args._2</code>
<code> [5]       ⍝ Then the user has asked for a list with "?" and selected from a list of all files</code>
<code class="emphasize">→[6]       parms.files←Args._2</code>
<code> [7]   :EndIf</code>
<code class="emphasize">→[8]   parms.msg←''Args.Switch'm'</code>
<code class="emphasize">→[9]   :If ' '=1↑0⍴Args._1</code>
<code> [10]      ⍝ Then the user has specified files as argument</code>
<code class="emphasize">→[11]      parms.files←Args.Arguments</code>
<code> [12]  :EndIf</code>
<code class="emphasize">→[13]  :If 0&lt;≢parms.files</code>
<code class="emphasize">→[14]      parms.addUntracked←0  ⍝ Then parms.files rules the day</code>
<code> [15]  :Else</code>
<code class="emphasize">→[16]      parms.addUntracked←0 Args.Switch'u'</code>
<code> [17]  :EndIf</code>
<code class="emphasize">→[18]  r←↑##.StashPush parms</code>
<code> [19] ⍝Done</code>
</div>
<code class="header" id="listing_40">#.APLGit2.APLGit2.UC.StashShow &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> r←StashShow(space folder Args)</code>
<code class="emphasize">→[1]  n←0 Args.Switch'n'</code>
<code class="emphasize">→[2]  p←0 Args.Switch'p'</code>
<code class="emphasize">→[3]  r←↑p ##.StashShow folder n</code>
</div>
<code class="header" id="listing_41">#.APLGit2.APLGit2.UC.Status &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> r←Status(space folder args)</code>
<code class="emphasize">→[1]  short←args.Switch'short'</code>
<code class="emphasize">→[2]  r←↑short ##.Status folder</code>
<code> [3] ⍝Done</code>
</div>
<code class="header" id="listing_42">#.APLGit2.APLGit2.UC.Version &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> r←Version</code>
<code class="emphasize">→[1]  r←##.Version</code>
</div>
<code class="header" id="listing_43">#.APLGit2.APLGit2.Init &mdash; 39%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  path←{quiet}Init y</code>
<code> [1]  ⍝ Initialize a folder as being managed by Git.\\</code>
<code> [2]  ⍝ If the user wants to, she can also add a .gitignore and/or a .gitattributes file that makes sense for APLers.\\</code>
<code> [3]  ⍝ `y` must be one of:</code>
<code> [4]  ⍝  * Empty: then `Git` tries to find an open Cider project and uses that</code>
<code> [5]  ⍝  * Fully qualified name of a namespace of an opened Cider project</code>
<code> [6]  ⍝  * Path to a Git-managed project\\</code>
<code> [7]  ⍝ Explicit result:\\</code>
<code> [8]  ⍝ `path` is the path to a folder that was (re-) initialized as a Git project and otherwise an empty text vector.\\</code>
<code> [9]  ⍝ The optional left argument defaults to 0. If 1 then Init does not ask any question but carries out its job,</code>
<code> [10] ⍝ including the creation of .gitignore and .gitattributes</code>
<code> [11]  quiet←{0&lt;⎕NC ⍵:⍎⍵ ⋄ 0}'quiet'</code>
<code> [12]  (space path)←EstablishProject y</code>
<code> [13]  :If IsGitProject path</code>
<code class="emphasize">→[14]      :If quiet</code>
<code class="emphasize">→[15]      :OrIf CommTools.YesOrNo space,' is already managed by Git; would you like to re-initialize it?'</code>
<code class="emphasize">→[16]          (rc msg buff)←path U.RunGitCommand'init'</code>
<code class="emphasize">→[17]          ('Init command files with RC=',(⍕rc),'; ',msg)U.Assert 0=rc</code>
<code class="emphasize">→[18]          quiet AddGitIgnore path</code>
<code class="emphasize">→[19]          quiet AddGitAttributes path</code>
<code> [20]      :EndIf</code>
<code> [21]  :Else</code>
<code> [22]      :If 0&lt;≢path</code>
<code> [23]          :If quiet</code>
<code class="emphasize">→[24]          :OrIf CommTools.YesOrNo'Would you like to initialize ',path,' for Git?'</code>
<code> [25]              (rc msg buff)←path U.RunGitCommand'init'</code>
<code> [26]              ('Init command files with RC=',(⍕rc),'; ',msg)U.Assert 0=rc</code>
<code> [27]              quiet AddGitAttributes path</code>
<code> [28]              {}quiet AddGitIgnore path</code>
<code> [29]          :EndIf</code>
<code> [30]      :Else</code>
<code class="emphasize">→[31]          :If quiet</code>
<code class="emphasize">→[32]          :OrIf CommTools.YesOrNo'Would you like to initialize the current directory ',F.PWD,' for Git?'</code>
<code class="emphasize">→[33]              path←F.PWD</code>
<code class="emphasize">→[34]              (rc msg buff)←path U.RunGitCommand'init'</code>
<code class="emphasize">→[35]              ('Init command files with RC=',(⍕rc),'; ',msg)U.Assert 0=rc</code>
<code class="emphasize">→[36]              quiet AddGitAttributes path</code>
<code class="emphasize">→[37]              {}quiet AddGitIgnore path</code>
<code> [38]          :EndIf</code>
<code> [39]      :EndIf</code>
<code> [40]  :EndIf</code>
<code> [41] ⍝Done</code>
</div>
<code class="header" id="listing_44">#.APLGit2.APLGit2.CompareCommits_ &mdash; 52%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  {noofBytes}←CompareCommits_(list branch1 branch2 folder currentBranch hash1 hash2 filename1 filename2)</code>
<code> [1]   noofBytes←0</code>
<code> [2]   :For thisFile :In list[;2]</code>
<code> [3]       extension←⎕C 3⊃⎕NPARTS thisFile</code>
<code> [4]       :If (⊂extension)∊'.aplf' '.aplo' '.apln' '.aplc' '.apli' '.dyalog' '.apla'</code>
<code> [5]           wsName←⎕SE.Link.GetItemName folder,'/',thisFile</code>
<code> [6]           header←↓U.Box(('⌹',[1]'⌹',,[0.5]wsName),[1]'⌹'),'⌹'</code>
<code> [7]           :If branch1≡currentBranch</code>
<code class="emphasize">→[8]           :AndIf 0&lt;nc←⎕NC wsName</code>
<code class="emphasize">→[9]               :If 9=nc</code>
<code class="emphasize">→[10]                  buff1←⎕SRC⍎wsName</code>
<code class="emphasize">→[11]              :ElseIf nc∊3 4</code>
<code class="emphasize">→[12]                  buff1←⎕NR wsName</code>
<code> [13]              :Else</code>
<code class="emphasize">→[14]                  :If ~(⎕DR buff1←⍎wsName)∊80 326</code>
<code class="emphasize">→[15]                      buff1←⎕SE.Dyalog.Array.Serialise wsName</code>
<code> [16]                  :EndIf</code>
<code> [17]              :EndIf</code>
<code> [18]          :Else</code>
<code> [19]              :If (,'.')≡,hash1</code>
<code> [20]                  :If ⎕NEXISTS folder,'/',thisFile</code>
<code> [21]                      buff1←⊃⎕NGET(folder,'/',thisFile)1</code>
<code> [22]                  :Else</code>
<code class="emphasize">→[23]                      buff1←''</code>
<code> [24]                  :EndIf</code>
<code> [25]              :Else</code>
<code> [26]                  (rc more buff1)←folder U.RunGitCommand('show  --raw ',hash1,':',thisFile)</code>
<code> [27]                  :If 0≠rc</code>
<code> [28]                      :If ∨/∨/¨'does not exist' 'exists on disk, but not' 'unknown revision or path not in the working tree'⍷¨⊂∊more</code>
<code class="emphasize">→[29]                      :OrIf rc=128   ⍝ From experience we know that this often means that the file does not exist, though it might have other reasons...</code>
<code> [30]                          buff1←''</code>
<code> [31]                      :Else</code>
<code class="emphasize">→[32]                          ∘∘∘ ⍝ It appears that the file does not exist but we fail to analyze the error message correctly in this respect</code>
<code> [33]                      :EndIf</code>
<code> [34]                  :EndIf</code>
<code> [35]              :EndIf</code>
<code> [36]          :EndIf</code>
<code> [37]          :If branch2≡currentBranch</code>
<code class="emphasize">→[38]          :AndIf 0&lt;nc←⎕NC wsName</code>
<code class="emphasize">→[39]              :If 9=nc</code>
<code class="emphasize">→[40]                  buff2←⎕SRC⍎wsName</code>
<code class="emphasize">→[41]              :ElseIf nc∊3 4</code>
<code class="emphasize">→[42]                  buff2←⎕NR wsName</code>
<code> [43]              :Else</code>
<code class="emphasize">→[44]                  :If ~(⎕DR buff2←⍎wsName)∊80 326</code>
<code class="emphasize">→[45]                      buff2←⎕SE.Dyalog.Array.Serialise wsName</code>
<code> [46]                  :EndIf</code>
<code> [47]              :EndIf</code>
<code> [48]          :Else</code>
<code> [49]              (rc more buff2)←folder U.RunGitCommand('show  --raw ',hash2,':',thisFile)</code>
<code> [50]              :If 0≠rc</code>
<code> [51]                  :If ∨/∨/¨'does not exist' 'exists on disk, but not' 'unknown revision or path not in the working tree'⍷¨⊂∊more</code>
<code class="emphasize">→[52]                  :OrIf rc=128   ⍝ From experience we know that this often means that the file does not exist, though it might have other reasons...</code>
<code> [53]                      buff2←''</code>
<code> [54]                  :Else</code>
<code class="emphasize">→[55]                      ∘∘∘ ⍝ It appears that the file does not exist but we fail to analyze the error message correctly in this respect</code>
<code> [56]                  :EndIf</code>
<code> [57]              :EndIf</code>
<code> [58]          :EndIf</code>
<code> [59]          buff1←header{⍺{⍺,⍵}⍣(0&lt;≢⍵)⊣⍵}buff1</code>
<code> [60]          buff2←header{⍺{⍺,⍵}⍣(0&lt;≢⍵)⊣⍵}buff2</code>
<code> [61]      :Else</code>
<code class="emphasize">→[62]          name←thisFile</code>
<code class="emphasize">→[63]          header←↓U.Box(('⌹',[1]'⌹',,[0.5]name),[1]'⌹'),'⌹'</code>
<code class="emphasize">→[64]          buff1←⊂'*** File ',((0&lt;≢extension)/'type '),'ignored: ',name{0=≢⍵:⍺ ⋄ ⍵}extension</code>
<code class="emphasize">→[65]          buff2←⊂'*** File ',((0&lt;≢extension)/'type '),'ignored: ',name{0=≢⍵:⍺ ⋄ ⍵}extension</code>
<code> [66]      :EndIf</code>
<code> [67]      :If buff1≢buff2</code>
<code> [68]          (⊂buff1)⎕NPUT filename1 2</code>
<code> [69]          (⊂buff2)⎕NPUT filename2 2</code>
<code> [70]          noofBytes+←⌈/{+/≢¨⍵}¨buff1 buff2</code>
<code> [71]      :EndIf</code>
<code> [72]  :EndFor</code>
<code> [73] ⍝Done</code>
</div>
<code class="header" id="listing_45">#.APLGit2.APLGit2.DiffBranches &mdash; 52%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  r←{x}DiffBranches y</code>
<code> [1]  ⍝ Peforma `Diff` on (by default) the current branch and main</code>
<code> [2]   ⎕TRAP←(811 'E' '⎕DMX.EM ⎕signal 811')(0 'N')</code>
<code> [3]   (space path)←EstablishProject y</code>
<code> [4]   :If 0=⎕NC'x'</code>
<code class="emphasize">→[5]   :OrIf 0=≢x</code>
<code> [6]       branches←(ListBranches path)~¨⊂' *'</code>
<code> [7]       'There is just one branch?!'U.Assert 1&lt;≢branches</code>
<code> [8]       currentBranch←CurrentBranch path</code>
<code> [9]       :If 1=≢branches~⊂currentBranch</code>
<code> [10]          branch1←currentBranch</code>
<code> [11]          branch2←⊃branches~⊂currentBranch</code>
<code> [12]      :Else</code>
<code class="emphasize">→[13]          'It''s not clear which branches you want to diff'U.Assert~(⊂currentBranch)∊'main' 'master'</code>
<code class="emphasize">→[14]          branch1←currentBranch</code>
<code class="emphasize">→[15]          branch2←⊃branches~⊂currentBranch</code>
<code> [16]      :EndIf</code>
<code> [17]  :Else</code>
<code class="emphasize">→[18]      x←⊆x</code>
<code class="emphasize">→[19]      'Optional left argument must have a length of 0, 1 or 2'U.Assert(≢x)∊1 2</code>
<code class="emphasize">→[20]      :If 1=≢⊆x</code>
<code class="emphasize">→[21]          branch1←1⊃,x</code>
<code class="emphasize">→[22]          branches←(ListBranches path)~¨⊂' *'</code>
<code class="emphasize">→[23]          branch2←⊃branches~⊂branch1</code>
<code> [24]      :Else</code>
<code class="emphasize">→[25]          (branch1 branch2)←x</code>
<code> [26]      :EndIf</code>
<code> [27]  :EndIf</code>
<code> [28]  (rc msg buff)←path U.RunGitCommand'diff ',branch1,'..',branch2</code>
<code> [29]  msg U.Assert 0=rc</code>
<code> [30]  r←buff</code>
<code> [31] ⍝Done</code>
</div>
<code class="header" id="listing_46">#.APLGit2.APLGit2.OpenGitShell &mdash; 57%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  {r}←OpenGitShell y</code>
<code> [1]  ⍝ Opens a Terminal in `y`.\\</code>
<code> [2]  ⍝ `y` must be one of:\\</code>
<code> [3]  ⍝   * Fully qualified path to a Git-managed project</code>
<code> [4]  ⍝   * Fully qualified name of a namespace that is an opened Cider project\\</code>
<code> [5]  ⍝   * A dot (`.`) for "current directory"</code>
<code> [6]  ⍝ Returns always 0\\</code>
<code> [7]  ⍝ This has been tested on Windows, Mac OS and Ubuntu.</code>
<code> [8]   r←0</code>
<code> [9]   :If (,'.')≡,y</code>
<code class="emphasize">→[10]      path←'.'</code>
<code class="emphasize">→[11]      space←''</code>
<code> [12]  :Else</code>
<code> [13]      (space path)←EstablishProject y</code>
<code> [14]  :EndIf</code>
<code> [15]  :Select ⎕C A.GetOperatingSystem ⍬</code>
<code> [16]  :Case 'win'</code>
<code> [17]      paths←';'A.Split 2 ⎕NQ #'GetEnvironment' 'PATH'</code>
<code> [18]      :If 1=+/bool←∨/¨'\git\bin'∘⍷¨⎕C paths</code>
<code class="emphasize">→[19]          home←(bool⍳1)⊃paths</code>
<code class="emphasize">→[20]          pathToGitExe←home,'\sh.exe'</code>
<code> [21]      :Else</code>
<code> [22]          home←(⊢2 ⎕NQ #'GetEnvironment' 'ProgramFiles'),'/Git/bin'</code>
<code> [23]          pathToGitExe←home,'/sh.exe'</code>
<code> [24]          :If ~⎕NEXISTS home</code>
<code class="emphasize">→[25]              'GitBash not found!'⎕SIGNAL 6</code>
<code> [26]          :EndIf</code>
<code> [27]      :EndIf</code>
<code> [28]      cmd←('"',pathToGitExe,'" --cd="',path,'"')</code>
<code> [29]      ⎕SH cmd''</code>
<code> [30]  :Case 'lin'</code>
<code class="emphasize">→[31]      cmd←'gnome-terminal -- $SHELL -c "cd ',path,';git status; exec $SHELL"'</code>
<code class="emphasize">→[32]      ⎕SH cmd</code>
<code class="emphasize">→[33]  :Case 'mac'</code>
<code class="emphasize">→[34]      cmd←'osascript -e ''tell app "terminal" to do script "cd ',path,';git status "'''</code>
<code class="emphasize">→[35]      ⎕SH cmd</code>
<code> [36]  :EndSelect</code>
<code> [37] ⍝Done</code>
</div>
<code class="header" id="listing_47">#.APLGit2.APLGit2.U.RunProcess &mdash; 60%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  {r}←RunProcess(EXE command)</code>
<code> [1]  ⍝ Runs EXE and returns a namespace with all sorts of variables, among them StdOut and StdErr.</code>
<code> [2]  ⍝ Cannot run in elevated mode because for that we would need to set i.Verb to 'runas' which</code>
<code> [3]  ⍝ we can't because "UseShellEexecute" must be set to 1 for this which we can't because we must</code>
<code> [4]  ⍝ redirect StdOut and StdErr, something we can only do with "UseShellExecute←0"</code>
<code> [5]  ⍝ ⍵[0] ←→ Executable</code>
<code> [6]  ⍝ ⍵[1] ←→ Argument</code>
<code> [7]   r←⎕NS''</code>
<code> [8]   ⎕IO←0</code>
<code> [9]   dotnet←2250⌶0</code>
<code> [10]  :If 1=1⊃dotnet                  ⍝ Bridge successfully loaded?</code>
<code> [11]      :Select 0⊃dotnet</code>
<code> [12]      :Case 1            ⍝ .NET</code>
<code class="emphasize">→[13]          ⎕USING←'System' 'System.IO' 'System.Diagnostics,System.Diagnostics.Process'</code>
<code> [14]      :Case 2            ⍝ .NET Framework</code>
<code> [15]          ⎕USING←'System' 'System.IO' 'System.Diagnostics,System.dll'</code>
<code> [16]      :EndSelect</code>
<code> [17]      p←⎕NEW Process</code>
<code> [18]      i←p.StartInfo</code>
<code> [19]      i.FileName←EXE</code>
<code> [20]      i.Arguments←command</code>
<code> [21]      i.RedirectStandardOutput←1</code>
<code> [22]      i.RedirectStandardInput←1</code>
<code> [23]      i.RedirectStandardError←1</code>
<code> [24]      i.UseShellExecute←0</code>
<code> [25]      i.CreateNoWindow←1</code>
<code> [26]      {}p.Start ⍬</code>
<code> [27]      re←⎕NEW StreamReader p.StandardError.BaseStream</code>
<code> [28]      ro←⎕NEW StreamReader p.StandardOutput.BaseStream</code>
<code> [29]      t←r{⍺.StdErr←⍵.ReadToEnd}&amp;re</code>
<code> [30]      r.StdOut←ro.ReadToEnd</code>
<code> [31]      op←{6::0 ⋄ z←⍺⍺ ⍵}</code>
<code> [32]      {}p.WaitForExit op ⍬</code>
<code> [33]      {}⎕TSYNC op t</code>
<code> [34]      r.ExitCode←p.ExitCode</code>
<code> [35]      rtc←{' '@((⎕UCS 9)∘=)⍵}</code>
<code> [36]      :If 0&lt;≢r.StdOut</code>
<code> [37]          :If ∨/(⎕UCS 10 13)⍷r.StdOut</code>
<code class="emphasize">→[38]              pfn←{(⎕UCS 10 13)A.Split ⍵}</code>
<code> [39]          :Else</code>
<code> [40]              pfn←{(⎕UCS 10)A.Split ⍵}</code>
<code> [41]          :EndIf</code>
<code> [42]          r.StdOut←pfn rtc r.StdOut</code>
<code> [43]      :EndIf</code>
<code> [44]      :If 0&lt;≢r.StdErr</code>
<code> [45]          :If (⎕UCS 13)∊r.StdErr</code>
<code class="emphasize">→[46]              pfn←{(⎕UCS 10 13)A.Split ⍵}</code>
<code> [47]          :Else</code>
<code> [48]              pfn←{(⎕UCS 10)A.Split ⍵}</code>
<code> [49]          :EndIf</code>
<code> [50]          r.StdErr←pfn rtc r.StdErr</code>
<code> [51]      :EndIf</code>
<code> [52]      :If 1&lt;|≡r.StdOut</code>
<code> [53]          r.StdOut←(-+/∧\0=⌽≢¨r.StdOut)↓r.StdOut  ⍝ Remove trailing empty lines</code>
<code> [54]      :EndIf</code>
<code> [55]  :Else</code>
<code class="emphasize">→[56]      '.NET is not available but required on Windows'Assert'Win'≢A.GetOperatingSystem ⍬</code>
<code class="emphasize">→[57]      ⎕IO←1</code>
<code class="emphasize">→[58]      r←⎕NS''</code>
<code class="emphasize">→[59]      r.ExitCode←0</code>
<code class="emphasize">→[60]      r.StdErr←r.StdOut←''</code>
<code class="emphasize">→[61]      folder←{0&lt;⎕NC ⍵:⍎⍵ ⋄ ''}'folder'</code>
<code class="emphasize">→[62]      tfn←##.F.GetTempFilename2'APLGit'   ⍝ Temp FileName</code>
<code class="emphasize">→[63]      cmd←EXE,' ',command,' 2&gt;"',tfn,'"'</code>
<code class="emphasize">→[64]      :Trap 11</code>
<code class="emphasize">→[65]          buff←⎕SH cmd</code>
<code> [66]      :Else</code>
<code class="emphasize">→[67]          dmx←⎕DMX</code>
<code class="emphasize">→[68]          r.ExitCode←1</code>
<code class="emphasize">→[69]          r.StdErr←dmx.Message</code>
<code class="emphasize">→[70]          :If ∨/'code 127 '⍷dmx.Message,' '</code>
<code class="emphasize">→[71]              r.ExitCode←127</code>
<code class="emphasize">→[72]          :ElseIf ∨/'code 128 '⍷dmx.Message,' '</code>
<code class="emphasize">→[73]              r.ExitCode←128</code>
<code> [74]          :EndIf</code>
<code class="emphasize">→[75]          :Return</code>
<code> [76]      :EndTrap</code>
<code class="emphasize">→[77]      r.StdOut←{'UTF-8'⎕UCS ⎕UCS ⍵}¨buff</code>
<code class="emphasize">→[78]      :If 0&lt;≢msg←{22::'' ⋄ ⊃⎕NGET ⍵ 1}tfn</code>
<code class="emphasize">→[79]          r.StdErr←⊃{⍺,' ',⍵}/msg</code>
<code> [80]      :EndIf</code>
<code class="emphasize">→[81]      ##.F.DeleteFile tfn</code>
<code> [82]  :EndIf</code>
</div>
<code class="header" id="listing_48">#.APLGit2.APLGit2.SetDefaultProject &mdash; 63%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  {r}←{force}SetDefaultProject y</code>
<code> [1]  ⍝ `y` may be either the name of a namespace or a folder.\\</code>
<code> [2]  ⍝ That defines an opened Cider project; if it does not an error is thrown.\\</code>
<code> [3]  ⍝  * In case `y` is '?' the user is presented a list of opened Cider projects to select from</code>
<code> [4]  ⍝  * In case `y` is empty `DEFAULT_PROJECT←''` is executed\\</code>
<code> [5]  ⍝ `force` is useful for test cases in order to avoid interaction with a user.\\</code>
<code> [6]  ⍝ Returns (space folder) for the selected project or '' if there isn't one set.</code>
<code> [7]   force←{0&lt;⎕NC ⍵:⍎⍵ ⋄ 0}'force'</code>
<code> [8]   list←⎕SE.Cider.ListOpenProjects 0</code>
<code> [9]   r←''</code>
<code> [10]  DEFAULT_PROJECT←{0&lt;⎕NC ⍵:DEFAULT_PROJECT ⋄ ''}'DEFAULT_PROJECT'    ⍝ Initalise the default project as undefined</code>
<code> [11]  :If 0=≢y←⍕y</code>
<code> [12]      :If 0&lt;≢DEFAULT_PROJECT</code>
<code> [13]          :If force</code>
<code class="emphasize">→[14]          :OrIf 1 CommTools.YesOrNo'Undefine default project (Is currently ',(⊃{0=≢⍺:⍵ ⋄ ⍺,' [',⍵,']'}/DEFAULT_PROJECT),') '</code>
<code> [15]              r←DEFAULT_PROJECT←''</code>
<code> [16]          :Else</code>
<code class="emphasize">→[17]              r←DEFAULT_PROJECT,' remaines to be the default project'</code>
<code> [18]          :EndIf</code>
<code> [19]      :EndIf</code>
<code> [20]  :ElseIf (,'?')≡,y~'[]'</code>
<code class="emphasize">→[21]      DEFAULT_PROJECT_was←DEFAULT_PROJECT</code>
<code class="emphasize">→[22]      DEFAULT_PROJECT←''</code>
<code class="emphasize">→[23]      :If 0=≢r←DEFAULT_PROJECT←EstablishProject''</code>
<code class="emphasize">→[24]          r←DEFAULT_PROJECT←DEFAULT_PROJECT_was                      ⍝ User did cancel, so we restore the original setting</code>
<code> [25]      :EndIf</code>
<code> [26]  :Else</code>
<code> [27]      :If ∨/'/\:'∊y</code>
<code class="emphasize">→[28]          folder←F.EnforceSlash y</code>
<code class="emphasize">→[29]          row←(F.EnforceSlash¨list[;2])⍳⊂folder</code>
<code> [30]      :Else</code>
<code> [31]          '⍵ is not a namespace'U.Assert 9=⎕NC y</code>
<code> [32]          row←list[;1]⍳⊂y</code>
<code> [33]      :EndIf</code>
<code> [34]      :If row≤≢list</code>
<code> [35]          (space folder)←list[row;]</code>
<code> [36]      :Else</code>
<code class="emphasize">→[37]          space←''</code>
<code> [38]      :EndIf</code>
<code> [39]      r←DEFAULT_PROJECT←space folder</code>
<code> [40]  :EndIf</code>
<code> [41] ⍝Done</code>
</div>
<code class="header" id="listing_49">#.APLGit2.APLGit2.U.MassageMsg &mdash; 67%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> MassageMsg←{</code>
<code> [1] ⍝ This function exchanges all single quotes and all double quotes against ticks (`).</code>
<code> [2] ⍝ Note that under Windows a message MUST NOT be enclosed between single quotes,</code>
<code> [3] ⍝ and that means we cannot escape quotes, so using a substitute is the only way.</code>
<code> [4] ⍝ Having said this, on a Mac (and ONLY the Mac) backticks must be escaped.</code>
<code> [5]      r←'`'@(⍸⍵∊'''"')⊣⍵</code>
<code> [6]      'win'≡⎕C A.GetOperatingSystem ⍬:r</code>
<code class="emphasize">→[7]      '`'⎕R'\\`'⊣r  ⍝ Escape backticks, otherwise on a Mac we are in trouble</code>
<code> [8]  }</code>
</div>
<code class="header" id="listing_50">#.APLGit2.APLGit2.EstablishProject &mdash; 69%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  (namespace folder)←{noSelect}EstablishProject y</code>
<code> [1]  ⍝ If `y` is empty:</code>
<code> [2]  ⍝  * In case of a single open Cider project its project path is taken.</code>
<code> [3]  ⍝  * If there are several Cider projects open then the user will be asked whether she wants to act on `DEFAULT_PROJECT`</code>
<code> [4]  ⍝    if that points to an open Cider project. If she refuses she will be prompted for the correct one.\\</code>
<code> [5]  ⍝ Otherwise `y` must be the name of an opened Cider project or a path to a project.\\</code>
<code> [6]  ⍝ Note that projects defined this way cannot become the default project. See `]APLGit2.SetDefaultProject` for that.\\</code>
<code> [7]  ⍝ Returns a two-column matrix with namespace name and folder, or both empty.\\</code>
<code> [8]  ⍝ In case a path is specified it does not have to be an opened Cider project. However, this will effect only a few</code>
<code> [9]  ⍝ commands (like `IsDirty`, `OpenGitShell` and `Init`) since most commands are bound to be executed on a Cider project.\\</code>
<code> [10] ⍝ `noSelect` defaults to 0, meaning that the user will be presented a list of opened Cider projects ind case no</code>
<code> [11] ⍝ project can be established by other means. To supress this specify a 1 as ⍺.</code>
<code> [12]  noSelect←{0&lt;⎕NC ⍵:⍎⍵ ⋄ 0}'noSelect'</code>
<code> [13]  y←⍕y</code>
<code> [14]  (namespace folder)←'' ''</code>
<code> [15]  :If (,'.')≡,y</code>
<code class="emphasize">→[16]      folder←⊃1 ⎕NPARTS''</code>
<code class="emphasize">→[17]      :Return</code>
<code> [18]  :EndIf</code>
<code> [19]  list←⎕SE.Cider.ListOpenProjects 0</code>
<code> [20]  DEFAULT_PROJECT←{0&lt;⎕NC ⍵:DEFAULT_PROJECT ⋄ ''}'DEFAULT_PROJECT'    ⍝ Initalise the default project as undefined</code>
<code> [21]  :If 2≠≡DEFAULT_PROJECT                     ⍝ Make sure ...</code>
<code class="emphasize">→[22]  :OrIf ∧/{⊃' '≠1↑0⍴⍵}¨⍕¨DEFAULT_PROJECT     ⍝ ... the variable DEFAULT_PROJECT ...</code>
<code class="emphasize">→[23]  :OrIf ~⎕NEXISTS 2⊃DEFAULT_PROJECT          ⍝ ... is okay, otherwise it is better ...</code>
<code> [24]      DEFAULT_PROJECT←''                     ⍝ ... to ignore it!</code>
<code> [25]  :EndIf</code>
<code> [26]  :If 0=≢y</code>
<code> [27]      :If 0=≢list</code>
<code class="emphasize">→[28]          :Return</code>
<code> [29]      :ElseIf 0&lt;≢DEFAULT_PROJECT</code>
<code class="emphasize">→[30]          (namespace folder)←DEFAULT_PROJECT</code>
<code> [31]      :ElseIf 1=≢list</code>
<code class="emphasize">→[32]          (namespace folder)←list[1;]</code>
<code class="emphasize">→[33]          :If (⊂DEFAULT_PROJECT)∊↓list                               ⍝ Only if it's an opened Cider project</code>
<code class="emphasize">→[34]              (namespace folder)←DEFAULT_PROJECT</code>
<code class="emphasize">→[35]              :Return</code>
<code> [36]          :Else</code>
<code class="emphasize">→[37]              DEFAULT_PROJECT←''</code>
<code> [38]          :EndIf</code>
<code> [39]      :ElseIf ~noSelect</code>
<code> [40]          (namespace folder)←U.SelectProject list</code>
<code> [41]      :EndIf</code>
<code> [42]  :Else</code>
<code> [43]      :If ∨/'/\:'∊y</code>
<code> [44]          folder←y</code>
<code> [45]          :If 1=+/bool←(F.EnforceSlash¨list[;2])≡¨⊂F.EnforceSlash folder</code>
<code> [46]              namespace←⊃list[bool⍳1;]</code>
<code> [47]          :EndIf</code>
<code> [48]      :Else</code>
<code> [49]          'Is not a namespace'U.Assert(⊃y)∊'#⎕'</code>
<code> [50]          'There are no open Cider projects'U.Assert 0&lt;≢list</code>
<code> [51]          bool←list[;1]≡¨⊂y</code>
<code> [52]          'Is not an opened Cider project'U.Assert 1=+/bool</code>
<code> [53]          (namespace folder)←list[bool⍳1;]</code>
<code> [54]      :EndIf</code>
<code> [55]      'Folder does not exist'U.Assert ⎕NEXISTS folder</code>
<code> [56]  :EndIf</code>
<code> [57] ⍝Done</code>
</div>
<code class="header" id="listing_51">#.APLGit2.APLGit2.LatestRelease &mdash; 69%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  r←{verbose}LatestRelease(username repoName)</code>
<code> [1]   ⍝ Returns the tag of the latest release.</code>
<code> [2]   ⍝ By default any draft releases are ignored.</code>
<code> [3]   ⍝ "username" is expected to be the GitHub username. It's the equivalent of "group" in Tatin.</code>
<code> [4]   'This function is "Windows only"'U.Assert'win'≡⎕C A.GetOperatingSystem ⍬</code>
<code> [5]   verbose←{0&lt;⎕NC ⍵:⍎⍵ ⋄ 0}'verbose'</code>
<code> [6]   'Both "username" and "repoName" must not be empty'U.Assert 0∧.&lt;≢¨username repoName</code>
<code> [7]   GH←⎕NEW GitHubAPIv3(,⊂username)</code>
<code> [8]   :Trap 0</code>
<code> [9]       (rc msg data)←GH.GetLatestReleaseInfo repoName</code>
<code> [10]  :Else</code>
<code class="emphasize">→[11]      qdmx←⎕DMX</code>
<code class="emphasize">→[12]      U.ErrNo ⎕SIGNAL⍨qdmx.EM</code>
<code> [13]  :EndTrap</code>
<code> [14]  :If 90=rc</code>
<code class="emphasize">→[15]      msg U.Assert rc≠90</code>
<code> [16]  :Else</code>
<code> [17]      :If verbose</code>
<code class="emphasize">→[18]          r←data.(tag_name published_at name)</code>
<code> [19]      :Else</code>
<code> [20]          r←data.tag_name</code>
<code> [21]      :EndIf</code>
<code> [22]  :EndIf</code>
<code> [23] ⍝Done</code>
</div>
<code class="header" id="listing_52">#.APLGit2.APLGit2.IsGitInstalled &mdash; 70%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  yesNo←IsGitInstalled</code>
<code> [1]  ⍝ Checks the PATH variable of the current operating system and tries to find the git executable.</code>
<code> [2]   yesNo←0</code>
<code> [3]   :If 'Win'≡A.GetOperatingSystem ⍬</code>
<code> [4]       path←⊃⎕SH'echo %PATH%'</code>
<code> [5]       path←';'(≠⊆⊢)path</code>
<code> [6]       exeName←'git.exe'</code>
<code> [7]   :Else</code>
<code class="emphasize">→[8]       path←⊃⎕SH'echo $PATH'</code>
<code class="emphasize">→[9]       path←':'(≠⊆⊢)path</code>
<code class="emphasize">→[10]      exeName←'git'</code>
<code> [11]  :EndIf</code>
<code> [12]  :If 0&lt;≢path</code>
<code> [13]      yesNo←∨/F.IsFile F.NormalizePath¨(⊂'/',exeName),⍨¨path</code>
<code> [14]  :EndIf</code>
</div>
<code class="header" id="listing_53">#.APLGit2.APLGit2.GetDefaultProject &mdash; 75%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> r←GetDefaultProject dummy</code>
<code> [1] ⍝ Reports the current setting of Git's default project or '' if there isn't one.</code>
<code> [2]  DEFAULT_PROJECT←{0&lt;⎕NC ⍵:DEFAULT_PROJECT ⋄ ''}'DEFAULT_PROJECT'    ⍝ Initalise the default project as undefined</code>
<code> [3]  r←''</code>
<code> [4]  :If 0&lt;≢DEFAULT_PROJECT</code>
<code class="emphasize">→[5]      r←DEFAULT_PROJECT</code>
<code> [6]  :EndIf</code>
<code> [7] ⍝Done</code>
</div>
<code class="header" id="listing_54">#.APLGit2.APLGit2.ListIssues &mdash; 75%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  r←{verbose}ListIssues(username repoName)</code>
<code> [1]   ⍝ Returns a list of all open issues but no Pull Requests.\\</code>
<code> [2]   ⍝ "username" is expected to be the GitHub username. It's the equivalent of "group" in Tatin.\\</code>
<code> [3]   ⍝ "repoName" must be the name of the repository you want to get the issues for.\\</code>
<code> [4]   ⍝ Note that both "username" and "repoName" are not case senstitive.\\</code>
<code> [5]   ⍝ * By default just "title" and "number" are returned.</code>
<code> [6]   ⍝ * With verbose=1, "udated_at", "labels" and "assignees" are also returned.</code>
<code> [7]   ⍝ * With verbose=2, "body" is also returned.</code>
<code> [8]   verbose←{0&lt;⎕NC ⍵:⍎⍵ ⋄ 0}'verbose'</code>
<code> [9]   'Both "username" and "repoName" must not be empty'U.Assert 0∧.&lt;≢¨username repoName</code>
<code> [10]  GH←⎕NEW GitHubAPIv3(,⊂username)</code>
<code> [11]  :Trap 0</code>
<code> [12]      ns←GH.GetAllIssues repoName</code>
<code> [13]  :Else</code>
<code class="emphasize">→[14]      qdmx←⎕DMX</code>
<code class="emphasize">→[15]      U.ErrNo ⎕SIGNAL⍨qdmx.EM</code>
<code> [16]  :EndTrap</code>
<code> [17]  :If 0=≢ns</code>
<code> [18]      r←''</code>
<code> [19]  :Else</code>
<code> [20]      r←ns.∆QuickView GH</code>
<code> [21]      r←{(⍵[;1]≢¨⊂'state')⌿⍵}¨r                                  ⍝ "State" is not meaningful here</code>
<code> [22]      r←BeautifyDateTime¨r</code>
<code> [23]      :Select ⊃verbose</code>
<code> [24]      :Case 0</code>
<code> [25]          r←{(~⍵[;1]∊'assignees' 'labels' 'updated_at')⌿⍵}¨r     ⍝ This is the default</code>
<code> [26]      :Case 1</code>
<code> [27]      ⍝ No action required</code>
<code class="emphasize">→[28]      :Case 2</code>
<code class="emphasize">→[29]          r{⍺⍪'body'⍵}←¨ns.body</code>
<code> [30]      :Else</code>
<code class="emphasize">→[31]          ∘∘∘                                                    ⍝ Huh?!</code>
<code> [32]      :EndSelect</code>
<code> [33]      r←↑r</code>
<code> [34]  :EndIf</code>
<code> [35] ⍝Done</code>
</div>
<code class="header" id="listing_55">#.APLGit2.APLGit2.Log &mdash; 77%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  r←{parms_}Log y</code>
<code> [1]  ⍝ Returns the log of commits.\\</code>
<code> [2]  ⍝ The result depends on `verbose`.</code>
<code> [3]  ⍝ * If it's 0 (the default), then `r` is a nested matrix with four columns:\\</code>
<code> [4]  ⍝    1. Hash of the commit</code>
<code> [5]  ⍝    2. Committer</code>
<code> [6]  ⍝    3. Commit date</code>
<code> [7]  ⍝    4. Commit message; multi-line messages are compressed</code>
<code> [8]  ⍝ * It it's 1, `r` is a simple character matrix</code>
<code> [9]  ⍝ With the optional `since` you can limit the result by date.\\</code>
<code> [10] ⍝ For the date two formats are supported:</code>
<code> [11] ⍝  * 'YYY-MM-DD' as text</code>
<code> [12] ⍝  * yyyymmdd as an integer\\</code>
<code> [13] ⍝ `y` must be one of:</code>
<code> [14] ⍝   * Fully qualified name of a namespace  that is an opened Cider project</code>
<code> [15] ⍝   * Fully qualified path to a Git-managed project</code>
<code> [16]  ⎕TRAP←(811 'E' '⎕DMX.EM ⎕signal 811')(0 'N')</code>
<code> [17]  r←''</code>
<code> [18]  (space folder)←EstablishProject y</code>
<code> [19]  'Cancelled by user: no project specified/selected'Assert 0&lt;≢folder</code>
<code> [20]  parms←⎕NS''</code>
<code> [21]  parms.since←''</code>
<code> [22]  parms.verbose←0</code>
<code> [23]  parms.branch←''</code>
<code> [24]  parms.max←¯1</code>
<code> [25]  parms.name←''</code>
<code> [26]  parms.commit←''</code>
<code> [27]  :If 9=⎕NC'parms_'</code>
<code> [28]      'parms'⎕NS parms_</code>
<code> [29]  :EndIf</code>
<code> [30]  :If 0&lt;parms.⎕NC'since'</code>
<code> [31]  :AndIf 0=1↑0⍴parms.since</code>
<code class="emphasize">→[32]      parms.since←{(4↑⍵),'-',(2↑4↓⍵),'-',(2↑6↓⍵)}⍕⌊parms.since</code>
<code> [33]  :EndIf</code>
<code> [34]  :If ~∧/(parms.⎕NL-2)∊list←'since' 'verbose' 'branch' 'max' 'name' 'commit'</code>
<code class="emphasize">→[35]      811 ⎕SIGNAL⍨'Invalid parameters: ',⊃{⍺,',',⍵}/(parms.⎕NL-2)~list</code>
<code> [36]  :EndIf</code>
<code> [37]  cmd←'log '</code>
<code> [38]  :If 0&lt;≢parms.branch</code>
<code> [39]      cmd,←parms.branch,' '</code>
<code> [40]      unwantedBranches←((⊂' *')~⍨¨ListBranches folder)~⊂parms.branch</code>
<code> [41]      cmd,←⊃,/{'--not ',⍵,' '}¨unwantedBranches</code>
<code> [42]  :EndIf</code>
<code> [43]  :If ¯1≢parms.max</code>
<code> [44]      cmd,←' -n ',(⍕parms.max),' '</code>
<code> [45]  :EndIf</code>
<code> [46]  cmd,←(0&lt;≢parms.since)/'--since=',(⍕parms.since),' '</code>
<code> [47]  :If 0=parms.verbose</code>
<code> [48]      cmd,←'--pretty=format:"',U.GetLogFormat,'" '</code>
<code> [49]  :EndIf</code>
<code> [50]  cmd,←'--date=',U.GetDateFormat</code>
<code> [51]  :If 0&lt;≢parms.name</code>
<code class="emphasize">→[52]      cmd,←' ',⎕SE.Link.GetFileName parms.name</code>
<code> [53]  :EndIf</code>
<code> [54]  (rc msg buff)←folder U.RunGitCommand cmd</code>
<code> [55]  msg U.Assert 0=rc</code>
<code> [56]  :If 0&lt;≢parms.commit</code>
<code class="emphasize">→[57]      :If parms.verbose</code>
<code class="emphasize">→[58]          b←buff{∧\(↑(≢⍵)↑¨⍺)∨.≠⍵}'commit ',parms.commit</code>
<code> [59]      :Else</code>
<code class="emphasize">→[60]          b←∧\(↑(≢parms.commit)↑¨buff)∨.≠parms.commit</code>
<code> [61]      :EndIf</code>
<code class="emphasize">→[62]      :If 0∊b</code>
<code class="emphasize">→[63]          buff←b/buff</code>
<code> [64]      :EndIf</code>
<code> [65]  :EndIf</code>
<code> [66]  :If parms.verbose</code>
<code class="emphasize">→[67]      r←⍕⍪buff</code>
<code> [68]  :Else</code>
<code> [69]      :If 0=≢buff</code>
<code class="emphasize">→[70]          r←0 4⍴''</code>
<code> [71]      :Else</code>
<code> [72]          r←U.FormatLog buff</code>
<code> [73]      :EndIf</code>
<code> [74]  :EndIf</code>
<code> [75] ⍝Done</code>
</div>
<code class="header" id="listing_56">#.APLGit2.APLGit2.Commit &mdash; 78%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  r←{msg}Commit y</code>
<code> [1]  ⍝ Commit changes.\\</code>
<code> [2]  ⍝ `y` must be one of:</code>
<code> [3]  ⍝   * Fully qualified name of a namespace that is an opened Cider project</code>
<code> [4]  ⍝   * Fully qualified path to a Git-managed project</code>
<code> [5]  ⍝ Additionally `y` must come with a second: a Boolean that when it is 1 is treated as "amend".</code>
<code> [6]  ⍝ This would result in a `commit --amend --no-edit`, effectively adding the latest changes to the last commit\\</code>
<code> [7]  ⍝ The optional `msg` can be a commit message. This  may be empty but will become three dots (`...`) then.\\</code>
<code> [8]  ⍝ Returns a two-element vector:</code>
<code> [9]  ⍝  1. The name of the branch</code>
<code> [10] ⍝  2. The hash of the commit as a simple text string</code>
<code> [11]  ⎕TRAP←(811 'E' '⎕DMX.EM ⎕signal 811')(0 'N')</code>
<code> [12]  msg←{0&lt;⎕NC ⍵:⍎⍵ ⋄ ''}'msg'</code>
<code> [13]  'Right argument is invalid (empty)'U.Assert 0&lt;≢y</code>
<code> [14]  'Left argument is invalid (wrong type)'U.Assert' '=1↑0⍴msg</code>
<code> [15]  (buff amendFlag)←2↑(⊆y),0</code>
<code> [16]  (space path)←EstablishProject buff</code>
<code> [17]  cb←CurrentBranch path</code>
<code> [18]  :If amendFlag</code>
<code class="emphasize">→[19]      cmd←'commit --amend --no-edit'</code>
<code class="emphasize">→[20]      :If 0&lt;≢msg</code>
<code class="emphasize">→[21]          msg_←U.MassageMsg msg</code>
<code class="emphasize">→[22]          cmd,←' -m "',msg_,'"'</code>
<code> [23]      :EndIf</code>
<code> [24]  :Else</code>
<code> [25]      msg←{0=≢⍵:'...' ⋄ ⍵},msg</code>
<code> [26]      :If (⊂cb)∊'master' 'main'</code>
<code> [27]      :AndIf 0=≢msg~'.'</code>
<code> [28]          'Cancelled by user'U.Assert CommTools.YesOrNo'NoMsgOnCommit@No meaningful message provided on "',cb,'"; continue anyway?'</code>
<code> [29]      :EndIf</code>
<code> [30]      msg_←U.MassageMsg msg</code>
<code> [31]      cmd←'commit -m "',msg_,'"'</code>
<code> [32]  :EndIf</code>
<code> [33]  (rc msg buff)←path U.RunGitCommand cmd</code>
<code> [34]  :If ∨/'nothing to commit, working tree clean'⍷∊buff</code>
<code class="emphasize">→[35]      r←buff</code>
<code> [36]  :Else</code>
<code> [37]      msg U.Assert 0=rc</code>
<code> [38]      r←buff</code>
<code> [39]  :EndIf</code>
<code> [40] ⍝Done</code>
</div>
<code class="header" id="listing_57">#.APLGit2.APLGit2.CompareCommits &mdash; 79%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  (filename1 filename2 hash1 hash2)←{x}CompareCommits y</code>
<code> [1]  ⍝ Allows inspection of all differences between two commits in a single comparison.\\</code>
<code> [2]  ⍝ In case `⍵` is empty the last commit is compared with the checkout commit of the current branch.</code>
<code> [3]  ⍝ In case `⍵` is a single commit it is compared with the last commit.</code>
<code> [4]  ⍝ In case `⍵` is a dot ("."), the working directory is compared with the last commit.</code>
<code> [5]  ⍝ Instead one can specify two commits (hashes) explicitly via the right argument.</code>
<code> [6]  ⍝ For what `x` can actually be see `EstablishProject`.\\</code>
<code> [7]  ⍝ Returns either two empty vectors in case no differences were detected or two filenames otherwise.\\</code>
<code> [8]  ⍝ If the user command `CompareFiles` and one of its comparison utilities is available the two files are compared straight away.\\</code>
<code> [9]  ⍝ Note that this tool focusses on APL source files, all other files are ingored.\\</code>
<code> [10] ⍝ If a Cider config file is found in "folder" then "CIDER.source" is honored.\\</code>
<code> [11] ⍝ Because this function established the hashes to be compared if they are not specified (empty), they are also returned.</code>
<code> [12]  x←{0&lt;⎕NC ⍵:⍎⍵ ⋄ ''}'x'</code>
<code> [13]  (space folder)←EstablishProject x</code>
<code> [14]  filename1←filename2←hash1←hash2←''</code>
<code> [15]  :If 0&lt;≢space,folder</code>
<code> [16]      branch←CurrentBranch folder</code>
<code> [17]      y←{0=≢⍵:⍵ ⋄ ⊆⍵}y</code>
<code> [18]      :If 0=≢y</code>
<code> [19]      :OrIf 0=+/≢¨y</code>
<code class="emphasize">→[20]          hash1←GetLastCommit folder</code>
<code class="emphasize">→[21]          hash2←GetMostRecentAncestor folder</code>
<code> [22]      :ElseIf 1=≢y</code>
<code> [23]      :OrIf 1=+/0=≢¨y</code>
<code> [24]          :If (,'.')≡,1⊃,y</code>
<code> [25]              hash1←'.'</code>
<code> [26]              hash2←GetLastCommit folder</code>
<code> [27]          :Else</code>
<code class="emphasize">→[28]              hash1←1⊃,y</code>
<code class="emphasize">→[29]              hash2←GetLastCommit folder</code>
<code> [30]          :EndIf</code>
<code> [31]      :Else</code>
<code> [32]          (hash1 hash2)←y~''⍬ 0</code>
<code> [33]      :EndIf</code>
<code> [34]      'The two hashes match - that makes no sense'U.Assert hash1≢hash2</code>
<code> [35]      (hash1 hash2)←{⍵↑⍨¨8⌊≢¨⍵}hash1 hash2</code>
<code> [36]      'The length of the hashes must be 4 or more characters'U.Assert∧/{(,'.')≡,⍵:1 ⋄ 4≤≢⍵}¨hash1 hash2</code>
<code> [37]      ⎕←'Comparing ',({(,'.')≡,⍵:'the current working directory' ⋄ ⍵}hash1),' with ',hash2</code>
<code> [38]      :If (,'.')≡,hash1</code>
<code> [39]          list←↑{⍵{((⍵-1)↑⍺)(⍵↓⍺)}⍵⍳' '}∘A.DLB¨1↓1 Status folder</code>
<code> [40]      :Else</code>
<code> [41]          list←folder DiffBetween hash1 hash2</code>
<code> [42]      :EndIf</code>
<code> [43]      :If 0&lt;≢∊list</code>
<code> [44]          ⎕←'Total number of files found: ',⍕≢list</code>
<code> [45]          :If F.IsFile folder,'/cider.config'</code>
<code> [46]              cfg←⊃F.NGET folder,'/cider.config'</code>
<code> [47]              ns←⎕JSON⍠('Dialect' 'JSON5')⊣cfg</code>
<code> [48]          :AndIf F.IsDir folder,'/',ns.CIDER.source</code>
<code> [49]              list←((F.EnforceSlash{⍵,'/'/⍨~'/\'∊⍨¯1↑⍵}ns.CIDER.source){⍺∘≡¨(≢⍺)↑¨⍵}⊢/list)⌿list</code>
<code> [50]          :EndIf</code>
<code> [51]          :If 0&lt;≢list←('.aplc' '.aplf' '.apln' '.aplo' '.apli' '.dyalog'∊⍨{3⊃⎕NPARTS ⍵}¨⊢/list)⌿list</code>
<code> [52]              ⎕←(⍕≢list),' APL source files found to compare'</code>
<code> [53]              (filename1 filename2)←'txt'∘F.GetTempFilename2¨2⍴⊂''</code>
<code> [54]              noofBytes←CompareCommits_ list(branch,': ',hash1)(branch,': ',hash2)folder branch hash1 hash2 filename1 filename2</code>
<code> [55]              :If 0=noofBytes</code>
<code class="emphasize">→[56]                  ⎕NDELETE filename1 filename2</code>
<code class="emphasize">→[57]                  filename1←filename2←''</code>
<code> [58]              :EndIf</code>
<code> [59]          :Else</code>
<code class="emphasize">→[60]              ⎕←'After removing non-APL-source files no files left to compare'</code>
<code> [61]          :EndIf</code>
<code> [62]      :Else</code>
<code class="emphasize">→[63]          ⎕←'No files found to compare'</code>
<code> [64]      :EndIf</code>
<code> [65]  :Else</code>
<code class="emphasize">→[66]      ⎕←'Nothing to compare?!'</code>
<code> [67]  :EndIf</code>
<code> [68] ⍝Done</code>
</div>
<code class="header" id="listing_58">#.APLGit2.APLGit2.GetTagOfLatestRelease &mdash; 79%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  r←{verbose}GetTagOfLatestRelease(username repoName)</code>
<code> [1]   ⍝ Returns the tag of the latest release.</code>
<code> [2]   ⍝ By default any draft releases are ignored.</code>
<code> [3]   ⍝ "username" is expected to be the GitHub username. It's the equivalent of "group" in Tatin.</code>
<code> [4]   verbose←{0&lt;⎕NC ⍵:⍎⍵ ⋄ 0}'verbose'</code>
<code> [5]   'Both "username" and "repoName" must not be empty'U.Assert 0∧.&lt;≢¨username repoName</code>
<code> [6]   GH←⎕NEW GitHubAPIv3(,⊂username)</code>
<code> [7]   :Trap 0</code>
<code> [8]       (rc msg data)←GH.GetLatestReleaseInfo repoName</code>
<code> [9]   :Else</code>
<code> [10]      qdmx←⎕DMX</code>
<code> [11]      U.ErrNo ⎕SIGNAL⍨qdmx.EM</code>
<code> [12]  :EndTrap</code>
<code> [13]  :If 90=rc</code>
<code class="emphasize">→[14]      :If ∨/'(404)'⍷∊msg</code>
<code class="emphasize">→[15]          U.ErrNo ⎕SIGNAL⍨'Repo &lt;',repoName,'&gt; not found (404)'</code>
<code> [16]      :Else</code>
<code class="emphasize">→[17]          msg U.Assert rc≠90</code>
<code> [18]      :EndIf</code>
<code> [19]  :Else</code>
<code> [20]      :If verbose</code>
<code> [21]          r←data.(tag_name published_at name)</code>
<code> [22]      :Else</code>
<code> [23]          r←data.tag_name</code>
<code> [24]      :EndIf</code>
<code> [25]  :EndIf</code>
<code> [26] ⍝Done</code>
</div>
<code class="header" id="listing_59">#.APLGit2.APLGit2.U.RunGitCommand &mdash; 79%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  (rc msg result)←path RunGitCommand command</code>
<code> [1]   path←{'/'@(⍸'\'=⍵)⊣⍵}path</code>
<code> [2]   cmd←'-C "',path,'" ',command</code>
<code> [3]   buff←RunProcess'git'cmd</code>
<code> [4]   (rc msg result)←buff.(ExitCode StdErr StdOut)</code>
<code> [5]   :Select rc</code>
<code> [6]   :Case 127</code>
<code class="emphasize">→[7]       'It appears that Git is not installed'⎕SIGNAL 127</code>
<code> [8]   :Case 128</code>
<code> [9]       :If ∨/'Who are you'⍷msg</code>
<code class="emphasize">→[10]          'Who are you? (set user.email and user.name)'⎕SIGNAL 128</code>
<code> [11]      :EndIf</code>
<code> [12]  :Else</code>
<code> [13]      :If ∨/'''git'' is not recognized'⍷msg</code>
<code class="emphasize">→[14]          'It appears that Git is not installed'⎕SIGNAL 127</code>
<code> [15]      :Else</code>
<code> [16]          :If 0=≢msg</code>
<code> [17]              msg←command,' =&gt; ',path</code>
<code> [18]          :EndIf</code>
<code> [19]      :EndIf</code>
<code> [20]  :EndSelect</code>
<code> [21] ⍝Done</code>
</div>
<code class="header" id="listing_60">#.APLGit2.APLGit2.GetPathFromProject &mdash; 80%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  r←GetPathFromProject space</code>
<code> [1]  ⍝ Takes the name (top container) of an opened Cider project and returns its path name.</code>
<code> [2]   list←⎕SE.Cider.ListOpenProjects 0</code>
<code> [3]   row←(list[;1])⍳⊂⍕space</code>
<code> [4]   :If row≤≢list</code>
<code> [5]       r←2⊃list[row;]</code>
<code> [6]   :Else</code>
<code class="emphasize">→[7]       r←''</code>
<code> [8]   :EndIf</code>
<code> [9]  ⍝Done</code>
</div>
<code class="header" id="listing_61">#.APLGit2.APLGit2.GetProjectFromPath &mdash; 80%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  r←GetProjectFromPath path</code>
<code> [1]  ⍝ Takes the path of an opened Cider project and returns its name.\\</code>
<code> [2]  ⍝ If path does not point to an opened Cider project then r is empty.</code>
<code> [3]   list←⎕SE.Cider.ListOpenProjects 0</code>
<code> [4]   row←(F.NormalizePath U.AddSlash¨list[;2])⍳⊂F.NormalizePath U.AddSlash path</code>
<code> [5]   :If row≤≢list</code>
<code> [6]       r←1⊃list[row;]</code>
<code> [7]   :Else</code>
<code class="emphasize">→[8]       r←''</code>
<code> [9]   :EndIf</code>
<code> [10] ⍝Done</code>
</div>
<code class="header" id="listing_62">#.APLGit2.APLGit2.Squash &mdash; 80%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  r←{x}Squash y</code>
<code> [1]  ⍝ Squashes some commits of the current branch into a single one.\\</code>
<code> [2]  ⍝ You can provide as a right argument:\\</code>
<code> [3]  ⍝  * A char vector; treated as commit message</code>
<code> [4]  ⍝  * An integer; treated as number of commits to be squashed</code>
<code> [5]  ⍝  * Any combination of message and number of commits in any sequence</code>
<code> [6]  ⍝  * An empty vector\\</code>
<code> [7]  ⍝ If the number of commits to be squashed was not defiend or is 0, a list of all candidates</code>
<code> [8]  ⍝ (commits) will be presented to you for selection.\\</code>
<code> [9]  ⍝ You may provide a meaningful message as the first right argument but if you don't you will be prompted.</code>
<code> [10] ⍝ If you still do not provide a meaningful message the function will throw an error.\\</code>
<code> [11] ⍝ In case there  uncommited changes, an error is thrown.\\</code>
<code> [12] ⍝ In case the current branch is either "main" or "master" the user is asked for confirmation.\\</code>
<code> [13] ⍝ The number of commits to be squashed might be provided as (additional) right argument.\\</code>
<code> [14] ⍝ For what `⍺` can actually be see `EstablishProject`.\\</code>
<code> [15] ⍝ Returns the number of commits that were eventually squashed.\\</code>
<code> [16]  r←0</code>
<code> [17]  x←{0&lt;⎕NC ⍵:⍎⍵ ⋄ ''}'x'</code>
<code> [18]  msg←'' ⋄ noOf←0</code>
<code> [19]  :If 0≠≢y</code>
<code> [20]      buff←2↑(⊆y),0</code>
<code> [21]      :If ' '=1↑0⍴1⊃buff</code>
<code> [22]          msg←1⊃buff</code>
<code> [23]          noOf←2⊃buff</code>
<code> [24]      :Else</code>
<code> [25]          noOf←⊃y</code>
<code> [26]          msg←{' '=1↑0⍴⍵:⍵ ⋄ ''}2⊃buff</code>
<code> [27]      :EndIf</code>
<code> [28]  :EndIf</code>
<code> [29]  (space folder)←EstablishProject x</code>
<code> [30]  'Cannot squash: there are uncommitted changes'U.Assert~IsDirty folder</code>
<code> [31]  currentBranch←CurrentBranch folder</code>
<code> [32]  :If (⊂currentBranch)∊'main' 'master'</code>
<code> [33]      'Cancelled by user'U.Assert CommTools.YesOrNo'SquashOnMain@Sure you want to squash the ',currentBranch,' branch?'</code>
<code> [34]  :EndIf</code>
<code> [35]  :If 0=noOf</code>
<code> [36]      r←≢commits←folder RefLog 0</code>
<code> [37]  :Else</code>
<code> [38]      commits←folder RefLog 0</code>
<code> [39]      r←≢commits←(noOf⌊≢commits)↑commits</code>
<code> [40]  :EndIf</code>
<code> [41]  :If 0&lt;r</code>
<code> [42]      :If noOf&gt;0</code>
<code> [43]          noOf_←noOf</code>
<code> [44]      :Else</code>
<code> [45]          caption←'How many commits would you like to squash? Maximum is ',(⍕≢commits),'; (empty=quit) '</code>
<code> [46]          noOf_←'NoOfSquashs@'U.GetNumberOfCommits commits currentBranch folder caption</code>
<code> [47]      :EndIf</code>
<code> [48]  :EndIf</code>
<code> [49]  :If 0&lt;noOf_</code>
<code> [50]      :If 0=≢msg</code>
<code> [51]          :If ⍬≢ind←CommTools.FindAutomationIndex'AskForNumber' 'NoOfSquashs@'</code>
<code class="emphasize">→[52]              noOf_←3⊃CommTools.∆Automation[⊃ind;]</code>
<code class="emphasize">→[53]          :AndIf ⍬≢ind←CommTools.FindAutomationIndex'AskForText' 'NoOfSquashsComment@'</code>
<code class="emphasize">→[54]              msg←3⊃CommTools.∆Automation[⊃ind;]</code>
<code> [55]          :Else</code>
<code> [56]              ⍞←'Provide a meaningful commit message in the editor:'</code>
<code> [57]              ⎕SE.⎕SHADOW'TEMP'</code>
<code> [58]              'TEMP'⎕SE.⎕NS''</code>
<code> [59]              :If 0=≢⎕SE.TEMP.CommitMsg←{0=≢⍵:⍵ ⋄ ⊃{⍺,(⎕UCS 13),⍵}/⍵}{⍵/⍨0&lt;≢¨⍵~¨⊂' .'}commits[⍳noOf_;4]</code>
<code class="emphasize">→[60]                  historyPath←(({⍵,'.',(⍵⍳'.')↓⍵}space)),'.History'</code>
<code class="emphasize">→[61]                  :If 0&lt;⎕NC historyPath</code>
<code class="emphasize">→[62]                      ⎕SE.TEMP.CommitMsg←{1↓⍵↑⍨1++/∧\'*'≠1↓⊃¨⍵}⍎historyPath</code>
<code class="emphasize">→[63]                  :ElseIf 0&lt;|⎕NC⊂historyPath</code>
<code class="emphasize">→[64]                      :Trap 0</code>
<code> [65]                      ⍝ Assumes something like "* Foo 1.2.3 from xx.xx.xxx" with an indented sub list:</code>
<code class="emphasize">→[66]                          ⎕SE.TEMP.CommitMsg←{(1↓⍵)↑⍨+/∧\' '=1↓,1↑[2]⍵}2↓[2]A.DLB 2↓180⌶historyPath</code>
<code class="emphasize">→[67]                          ⎕SE.TEMP.CommitMsg←,{⍵↓[2]⍨⌊/+/∧\' '=⍵}⎕SE.TEMP.CommitMsg</code>
<code> [68]                      :EndTrap</code>
<code> [69]                  :EndIf</code>
<code> [70]              :EndIf</code>
<code> [71]              ⎕SE.TEMP.⎕ED'CommitMsg'</code>
<code> [72]              msg←⎕SE.TEMP.CommitMsg</code>
<code> [73]              :If 2=≡msg</code>
<code class="emphasize">→[74]                  msg←1↓⊃,/';',¨msg</code>
<code> [75]              :Else</code>
<code> [76]                  msg←(~(⎕UCS 13 13)⍷msg)/msg</code>
<code> [77]                  msg←(-(⎕UCS 13)=¯1↑msg)↓msg</code>
<code> [78]              :EndIf</code>
<code> [79]          :EndIf</code>
<code> [80]      :EndIf</code>
<code> [81]      'Sqash requires a meaningful message'U.Assert 0&lt;≢msg~' .'</code>
<code> [82]      (rc more buff)←folder U.RunGitCommand('reset --soft HEAD~',⍕noOf_)</code>
<code> [83]      ('Reset failed; RC=',(⍕rc),' ',more)U.Assert 0=rc</code>
<code> [84]      buff U.Assert 0=≢buff</code>
<code> [85]      msg←U.MassageMsg msg</code>
<code> [86]      msg←'-m "',msg,'"'</code>
<code> [87]      (rc more buff)←folder U.RunGitCommand('commit ',msg)</code>
<code> [88]      ('Committing after resetting failed; RC=',(⍕rc),' ',more)U.Assert 0=rc</code>
<code> [89]      r←noOf_</code>
<code> [90]  :EndIf</code>
<code> [91] ⍝Done</code>
</div>
<code class="header" id="listing_63">#.APLGit2.APLGit2.Version &mdash; 80%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  r←Version</code>
<code> [1]  ⍝ Returns the version number from TatinVars</code>
<code> [2]  ⍝ See also `History`</code>
<code> [3]   r←''</code>
<code> [4]   :If 0&lt;⎕NC'TatinVars.CONFIG'</code>
<code class="emphasize">→[5]       r←(⎕JSON⍠('Dialect' 'JSON5')⊢TatinVars.CONFIG).version</code>
<code> [6]   :ElseIf 0&lt;##.⎕NC'TatinVars.CONFIG'</code>
<code> [7]       r←(⎕JSON⍠('Dialect' 'JSON5')⊢##.TatinVars.CONFIG).version</code>
<code> [8]   :EndIf</code>
<code> [9]   ⍝Done</code>
</div>
<code class="header" id="listing_64">#.APLGit2.APLGit2.StashPush &mdash; 86%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  r←StashPush y</code>
<code> [1]  ⍝ Stashes away all local modifications or only the given files.\\</code>
<code> [2]  ⍝ The right argument must be one of these:\\</code>
<code> [3]  ⍝ * A folder holding a Git-managed project</code>
<code> [4]  ⍝ * A parameter space, usually create by calling `CreateStashPushParms`, with a variable `folder` set.\\</code>
<code> [5]  ⍝ By default untracked files are not stashed. You can change that by setting `addUntracked` to 1.\\</code>
<code> [6]  ⍝ Returns an empty text vector in case of success and a message otherwise.</code>
<code> [7]   r←''</code>
<code> [8]   :If 326=⎕DR y</code>
<code> [9]       parms←y</code>
<code> [10]  :Else</code>
<code> [11]      'Invalid right argument: neither a parameter space nor a path to a folder'Assert' '=1↑0⍴∊y</code>
<code> [12]      parms←CreateStashPushParms</code>
<code> [13]      parms.folder←y</code>
<code> [14]  :EndIf</code>
<code> [15]  'Right argument does not specify a folder'Assert FilesAndDirs.IsDir parms.folder</code>
<code> [16]  cmd←'stash push '</code>
<code> [17]  :If 0&lt;≢parms.files</code>
<code class="emphasize">→[18]      parms.files←⊆parms.files</code>
<code class="emphasize">→[19]      cmd,←⊃{⍺,' ',⍵}/{'"',(⍵~'"'),'"'}¨FilesAndDirs.EnforceSlash¨parms.files</code>
<code> [20]  :EndIf</code>
<code> [21]  cmd,←' ',((0&lt;≢parms.msg)/'-m="',(parms.msg~'"'),'" '),(parms.addUntracked/'-u ')</code>
<code> [22]  (rc more r)←parms.folder U.RunGitCommand cmd</code>
<code> [23]  more U.Assert 0=rc</code>
<code> [24] ⍝Done</code>
</div>
<code class="header" id="listing_65">#.APLGit2.APLGit2.AddGitAttributes &mdash; 87%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  {r}←{quiet}AddGitAttributes path</code>
<code> [1]   r←⍬</code>
<code> [2]   quiet←{0&lt;⎕NC ⍵:⍎⍵ ⋄ 0}'quiet'</code>
<code> [3]   :If quiet</code>
<code class="emphasize">→[4]   :OrIf CommTools.YesOrNo'Add .gitattributes for APLers to ',path,' ?'</code>
<code> [5]       buff←''</code>
<code> [6]       buff,←⊂'# Auto detect text files (for EOL-auto conversion)'</code>
<code> [7]       buff,←⊂'* text=auto'</code>
<code> [8]       buff,←⊂''</code>
<code> [9]       buff,←⊂'*.apl? linguist-language=apl'</code>
<code> [10]      buff,←⊂'*.dyapp linguist-language=apl'</code>
<code> [11]      buff,←⊂'*.dyalog linguist-language=apl'</code>
<code> [12]      buff,←⊂'*.dws linguist-language=apl'</code>
<code> [13]      (⊂buff)⎕NPUT path,'/.gitattributes'</code>
<code> [14]      :If ~quiet</code>
<code class="emphasize">→[15]          ⎕←'.gitattributes created in ',path,' but check content!'</code>
<code> [16]      :EndIf</code>
<code> [17]  :EndIf</code>
</div>
<code class="header" id="listing_66">#.APLGit2.APLGit2.DiffBetween &mdash; 88%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  r←{x}DiffBetween y</code>
<code> [1]  ⍝ Lists all file differences between `y`.\\</code>
<code> [2]  ⍝ * In case `y` is empty it defaults to "master" and "dev".</code>
<code> [3]  ⍝ * If it is not empty it must be a two-element vector.\\</code>
<code> [4]  ⍝   The two items can each specify a branch but also a commit-hash.\\</code>
<code> [5]  ⍝ For what `x` can actually be see `EstablishProject`.\\</code>
<code> [6]   x←{0&lt;⎕NC ⍵:⍎⍵ ⋄ ''}'x'</code>
<code> [7]   (space folder)←EstablishProject x</code>
<code> [8]   :If 0=≢y</code>
<code class="emphasize">→[9]       (d1 d2)←'main' 'dev'</code>
<code> [10]  :Else</code>
<code> [11]      (d1 d2)←y</code>
<code> [12]  :EndIf</code>
<code> [13]  (rc more buff)←folder U.RunGitCommand('diff --name-status ',d1,'..',d2)</code>
<code> [14]  more U.Assert 0=rc</code>
<code> [15]  r←↑{i←⍵⍳' ' ⋄ ((i-1)↑⍵)(A.DLB i↓⍵)}¨buff</code>
<code> [16] ⍝Done</code>
</div>
<code class="header" id="listing_67">#.APLGit2.APLGit2.NoOfUntrackedFiles &mdash; 88%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  r←NoOfUntrackedFiles y</code>
<code> [1]  ⍝ Returns the number of unstaged and untracked changes (new+modified+deleted)</code>
<code> [2]   project←EstablishProject y</code>
<code> [3]   'Not a Cider project'⎕SIGNAL 6/⍨0=≢project</code>
<code> [4]   path←2⊃project</code>
<code> [5]   (rc more buff)←path U.RunGitCommand'status --porcelain'</code>
<code> [6]   more U.Assert 0=rc</code>
<code> [7]   :If 0=≢buff</code>
<code class="emphasize">→[8]       r←0</code>
<code> [9]   :Else</code>
<code> [10]      r←' '+.≠{⍵[;2]}↑buff</code>
<code> [11]  :EndIf</code>
<code> [12] ⍝Done</code>
</div>
<code class="header" id="listing_68">#.APLGit2.APLGit2.StashShow &mdash; 90%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  r←{p}StashShow y</code>
<code> [1]  ⍝ Shows the Diff between the stash and its original parent.\\</code>
<code> [2]  ⍝ `projectID` must be one of:\\</code>
<code> [3]  ⍝   * Fully qualified name of a namespace that is managed by Git</code>
<code> [4]  ⍝   * Path to a Git-managed project\\</code>
<code> [5]  ⍝ `n` is the number of the stash. Default is the last one (0).\\</code>
<code> [6]  ⍝ The optional left agument can be used to change the format (-p tag)</code>
<code> [7]   ⎕TRAP←(811 'E' '⎕DMX.EM ⎕signal 811')(0 'N')</code>
<code> [8]   p←{0&lt;⎕NC ⍵:⍎⍵ ⋄ 0}'p'</code>
<code> [9]   'Left argument was specified but is not a Boolean'U.Assert(⊂p)∊0 1</code>
<code> [10]  (projectID n)←2↑(⊆y),0</code>
<code> [11]  (space path)←EstablishProject projectID</code>
<code> [12]  (rc more r)←path U.RunGitCommand'stash show ',(⍕n),p/' -p'</code>
<code> [13]  :If ∨/'No stash entries found'⍷∊more</code>
<code class="emphasize">→[14]      r←''</code>
<code> [15]  :Else</code>
<code> [16]      more U.Assert 0=rc</code>
<code> [17]      ((≢'fatal:')↓more)U.Assert'fatal:'{⍺≢(≢⍺)↑⍵}more</code>
<code> [18]  :EndIf</code>
</div>
<code class="header" id="listing_69">#.APLGit2.APLGit2.U.GetNumberOfCommits &mdash; 90%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  no←{alias}GetNumberOfCommits(commits branch folder caption)</code>
<code> [1]  ⍝ Asks the user for the number of commits to be processed.</code>
<code> [2]  ⍝ The optional left argument can be used to define an alias for the CommTools.</code>
<code> [3]  ⍝ This can be used to automate the test case.</code>
<code> [4]   alias←{0&lt;⎕NC ⍵:⍎⍵ ⋄ ''}'alias'</code>
<code> [5]   width←⎕PW</code>
<code> [6]   sep←⎕UCS 13</code>
<code> [7]   q←width↑('--- Commits in branch "',branch,'" of project "',folder,'"'),' ',⎕PW⍴'-'</code>
<code> [8]   buff←(↑commits[;1]),' ',(↑commits[;2]),' ',(↑commits[;3]),' ',↑commits[;4]</code>
<code> [9]   buff←A.DTB⍕¨(((0,⍨≢⍕≢buff)∘⍕¨⍳≢buff),¨⊂'. '),¨↓buff</code>
<code> [10]  q←q,sep,(⊃,/buff,¨sep),sep,caption</code>
<code> [11]  no←((≢commits)∘{⍵∊⍳⍺}##.CommTools.AskForNumber)alias,q ⍝ caption</code>
<code> [12]  :If 0=≢no</code>
<code class="emphasize">→[13]      no←0</code>
<code> [14]  :EndIf</code>
</div>
<code class="header" id="listing_70">#.APLGit2.APLGit2.Diff &mdash; 91%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  r←{verbose}Diff y</code>
<code> [1]  ⍝ Returns a list with all APL objects/files that are different compared with HEAD.</code>
<code> [2]  ⍝ r is a matrix with two columns and zero or more rows.</code>
<code> [3]  ⍝ If `verbose` is 1 (default is 0) then a full report is returned instead.</code>
<code> [4]  ⍝ `y` must be one of:</code>
<code> [5]  ⍝   * Fully qualfied name of a namespace  that is an opened Cider project</code>
<code> [6]  ⍝   * Fully qualified path to a Git-managed project</code>
<code> [7]  ⍝ `verbose` defaults to 0 which gives you a short report.</code>
<code> [8]   ⎕TRAP←(811 'E' '⎕DMX.EM ⎕signal 811')(0 'N')</code>
<code> [9]   verbose←{0&lt;⎕NC ⍵:⍎⍵ ⋄ 0}'verbose'</code>
<code> [10]  (space folder)←EstablishProject y</code>
<code> [11]  :If verbose</code>
<code> [12]      (rc more r)←folder U.RunGitCommand'diff HEAD'</code>
<code> [13]      more U.Assert 0=rc</code>
<code> [14]  :Else</code>
<code> [15]      (rc more buff)←folder U.RunGitCommand'diff HEAD --name-only'</code>
<code> [16]      more U.Assert 0=rc</code>
<code> [17]      r←''</code>
<code> [18]      :If 0&lt;≢buff</code>
<code class="emphasize">→[19]          r←(⎕SE.Link.GetItemName(⊂folder,'/'),¨buff),[1.5]buff</code>
<code> [20]      :EndIf</code>
<code> [21]  :EndIf</code>
<code> [22] ⍝Done</code>
</div>
<code class="header" id="listing_71">#.APLGit2.APLGit2.ChangeLog &mdash; 92%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  r←{x}ChangeLog name</code>
<code> [1]  ⍝ Takes the name of an APL object or a filenamem and returns a matrix with information about all commits that object was changed by.\\</code>
<code> [2]  ⍝ The result is a matrix with zero or more rows and 4 columns:</code>
<code> [3]  ⍝ 1. Hash</code>
<code> [4]  ⍝ 2. Commiter's name</code>
<code> [5]  ⍝ 3. Date of the commit date in strict ISO 8601 format</code>
<code> [6]  ⍝ 4. Message of the commit\\</code>
<code> [7]  ⍝ For what `x` can actually be see `EstablishProject`.\\</code>
<code> [8]   r←0 4⍴''</code>
<code> [9]   :If ∨/'/\:'∊name</code>
<code> [10]      filename←F.EnforceSlash name</code>
<code> [11]      :If ':'∊filename</code>
<code class="emphasize">→[12]      :OrIf '/'=⊃filename</code>
<code> [13]          allProjects←(⎕SE.Cider.ListOpenProjects 0)[;2],¨'/'</code>
<code> [14]          path←⊃⎕NPARTS filename</code>
<code> [15]          'No fitting project found'U.Assert∨/bool←allProjects∊(≢¨allProjects)↑¨⊂filename</code>
<code> [16]          path←(bool⍳1)⊃allProjects</code>
<code> [17]      :EndIf</code>
<code> [18]  :Else</code>
<code> [19]      x←{0&lt;⎕NC ⍵:⍎⍵ ⋄ ''}'x'</code>
<code> [20]      project←EstablishProject x</code>
<code> [21]      'Not a Cider project'⎕SIGNAL 11/⍨0=≢project</code>
<code> [22]      (space path)←2↑project</code>
<code> [23]      :If ~(⊃name)∊'#⎕'</code>
<code> [24]          name←space,'.',name</code>
<code> [25]      :EndIf</code>
<code> [26]      filename←(1+≢path)↓⎕SE.Link.GetFileName name</code>
<code> [27]      ('APL  object not found: ',name)⎕SIGNAL 6/⍨0=≢filename</code>
<code> [28]  :EndIf</code>
<code> [29]  cmd←'log --follow --pretty=format:"',U.GetLogFormat,'" -- ',filename</code>
<code> [30]  (rc msg buff)←path U.RunGitCommand cmd</code>
<code> [31]  :If 1=≢'fatal: your current branch ''[^'']+'' does not have any commits yet'⎕S 0⊣∊msg</code>
<code class="emphasize">→[32]      r←''</code>
<code> [33]  :Else</code>
<code> [34]      (∊msg)U.Assert 0=rc</code>
<code> [35]      :If 0&lt;≢buff</code>
<code> [36]          r←↑U.FormatLog buff</code>
<code> [37]      :EndIf</code>
<code> [38]  :EndIf</code>
<code> [39] ⍝Done</code>
</div>
<code class="header" id="listing_72">#.APLGit2.APLGit2.Add &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  {r}←{filter}Add y</code>
<code> [1]  ⍝ Stage all files according to `filter` which defaults to ".".\\</code>
<code> [2]  ⍝ Alternatively you may specify a specific file, or a RegEx as filter that catches a number of files etc.\\</code>
<code> [3]  ⍝ `y` must be one of:</code>
<code> [4]  ⍝   * Fully qualfied name of a namespace that is an opened Cider project</code>
<code> [5]  ⍝   * Fully qualified path to a Git-managed project</code>
<code> [6]  ⍝ Returns a 0</code>
<code> [7]   filter←{0&lt;⎕NC ⍵:⍎⍵ ⋄ '.'}' filter'</code>
<code> [8]   r←0</code>
<code> [9]   (space path)←EstablishProject y</code>
<code> [10]  'No filter specified?!'⎕SIGNAL 11/⍨0=≢filter</code>
<code> [11]  (rc msg buff)←path U.RunGitCommand'add ',filter</code>
<code> [12]  msg U.Assert 0=rc</code>
<code> [13] ⍝Done</code>
</div>
<code class="header" id="listing_73">#.APLGit2.APLGit2.AddGitIgnore &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  r←{quiet}AddGitIgnore y</code>
<code> [1]  ⍝ Add a .gitignore file to a project, or merge default values into an existing one.\\</code>
<code> [2]  ⍝ The user is questioned several times, and she may edit the result before it is written to file.\\</code>
<code> [3]  ⍝ All interrogations as well as the ability to edit the file can be supressed by passing a 0 as `⍺` ("quiet").\\</code>
<code> [4]   quiet←{0&lt;⎕NC ⍵:⍎⍵ ⋄ 0}'quiet'</code>
<code> [5]   r←'AddGitIgnore: no action taken'</code>
<code> [6]   (space path)←EstablishProject y</code>
<code> [7]   →(0=≢space,path)/0</code>
<code> [8]   :If quiet</code>
<code> [9]   :OrIf 1 CommTools.YesOrNo'AddGitignore@Add .gitignore for APLers to ',path,' ?'</code>
<code> [10]      buff←'aplcore' 'CONTINUE' 'CONTINUE.dws' 'conga.crash'</code>
<code> [11]      cfg←⍬</code>
<code> [12]      :If 0&lt;≢space</code>
<code> [13]          ref←⍎space</code>
<code> [14]          cfg←⎕JSON⍠('Dialect' 'JSON5')⊣⊃F.NGET ref.CiderConfig.HOME,'/cider.config'</code>
<code> [15]      :AndIf 0&lt;≢(⊂'')~⍨cfg.CIDER.(dependencies dependencies_dev).tatin</code>
<code> [16]          installFolders←{1⊃'='(≠⊆⊢)⍵}¨(⊂'')~⍨cfg.CIDER.(dependencies dependencies_dev).tatin</code>
<code> [17]          installFolders←F.AddTrailingSep¨installFolders</code>
<code> [18]          plural←1&lt;≢installFolders</code>
<code> [19]          q←'SpecialStatement@Install folder',(plural/'s'),': ',⊃{⍺,' and ',⍵}/installFolders</code>
<code> [20]          q,←(⎕UCS 13),'  Add special statements to ',((1+plural)⊃'it' 'them'),' for dependency file and build list?'</code>
<code> [21]          :If quiet</code>
<code> [22]          :OrIf 1 CommTools.YesOrNo q</code>
<code> [23]              buff,←⊃,/{r←''</code>
<code> [24]                  r,←⊂'/',⍵,'*'</code>
<code> [25]                  r,←⊂'!/',⍵,'apl-dependencies.txt'</code>
<code> [26]                  r,←⊂'!/',⍵,'apl-buildlist.json'</code>
<code> [27]                  r</code>
<code> [28]              }¨installFolders</code>
<code> [29]          :EndIf</code>
<code> [30]      :EndIf</code>
<code> [31]      :If cfg≢⍬</code>
<code> [32]      :AndIf 0&lt;≢cfg.CIDER.distributionFolder</code>
<code> [33]          q←⊂'AddDestinationFolder@Would you like to add the destination folder:'</code>
<code> [34]          q,←⊂cfg.CIDER.distributionFolder</code>
<code> [35]          q,←⊂'to .gitignore?'</code>
<code> [36]      :AndIf 1 CommTools.YesOrNo q</code>
<code> [37]          buff,←⊂{((~(⊃⍵)∊'/\')/'/'),FilesAndDirs.AddTrailingSep ⍵}cfg.CIDER.distributionFolder</code>
<code> [38]      :EndIf</code>
<code> [39]      ind←1</code>
<code> [40]      :If ⎕NEXISTS path,'/.gitignore'</code>
<code> [41]          :If quiet</code>
<code> [42]              ind←2          ⍝ Merge</code>
<code> [43]          :Else</code>
<code> [44]              ind←('SelectActionOnGitIgnore@Select desired action on ',path,'/.gitignore')0 1 CommTools.Select'Replace' 'Merge' 'Quit'</code>
<code> [45]          :EndIf</code>
<code> [46]          →(ind=3)/0</code>
<code> [47]          :If ind=2</code>
<code> [48]              buff←∪(⊃F.NGET(path,'/.gitignore')1),buff</code>
<code> [49]          :EndIf</code>
<code> [50]      :EndIf</code>
<code> [51]      buff←FilesAndDirs.EnforceSlash¨buff</code>
<code> [52]      :If ~quiet</code>
<code> [53]          ref←⎕NS''</code>
<code> [54]          ref.gitIgnore←buff</code>
<code> [55]          ref.⎕ED'gitIgnore'</code>
<code> [56]          buff←ref.gitIgnore</code>
<code> [57]          →(0=≢' '~⍨∊buff)/0</code>
<code> [58]      :EndIf</code>
<code> [59]      (⊂buff)F.NPUT(path,'/.gitignore')1</code>
<code> [60]      r←'.gitignore ',(ind⊃'created' 'merged'),' in ',path</code>
<code> [61]  :EndIf</code>
</div>
<code class="header" id="listing_74">#.APLGit2.APLGit2.Assert &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> Assert←{⍺←'' ⋄ (,1)≡,⍵:r←1 ⋄ ⎕ML←1 ⋄ ⍺ ⎕SIGNAL 1↓(⊃∊⍵),11}</code>
</div>
<code class="header" id="listing_75">#.APLGit2.APLGit2.BeautifyDateTime &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> mat←BeautifyDateTime mat</code>
<code> [1]  :If 0&lt;+/b←mat[;1]≡¨⊂'updated_at'</code>
<code> [2]      ind←⊃⍸b</code>
<code> [3]      mat[ind;2]←⊂{⍵[⍳10],' ',⍵[11+⍳8]}2⊃mat[ind;]</code>
<code> [4]  :EndIf</code>
</div>
<code class="header" id="listing_76">#.APLGit2.APLGit2.Branch &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> r←{option}Branch y</code>
<code> [1] ⍝ This is just a synonym for the `ListBranches` function.</code>
<code> [2] ⍝ Invented to stay in line with the Git commands</code>
<code> [3]  ⎕TRAP←(811 'E' '⎕DMX.EM ⎕signal 811')(0 'N')</code>
<code> [4]  option←{0&lt;⎕NC ⍵:⍎⍵ ⋄ ''}'option'</code>
<code> [5]  r←option ListBranches y</code>
<code> [6] ⍝Done</code>
</div>
<code class="header" id="listing_77">#.APLGit2.APLGit2.CreateStashPushParms &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> r←CreateStashPushParms</code>
<code> [1] ⍝ Creates a parameter space with variables suitable for being passed to StashPush</code>
<code> [2]  r←⎕NS''</code>
<code> [3]  r.folder←''</code>
<code> [4]  r.addUntracked←0</code>
<code> [5]  r.msg←''</code>
<code> [6]  r.files←''</code>
</div>
<code class="header" id="listing_78">#.APLGit2.APLGit2.CurrentBranch &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> r←CurrentBranch y</code>
<code> [1] ⍝ Returns the name of the current branch for `y`.\\</code>
<code> [2] ⍝ For what `y` can actually be see `EstablishProject`.\\</code>
<code> [3]  ⎕TRAP←(811 'E' '⎕DMX.EM ⎕signal 811')(0 'N')</code>
<code> [4]  (space folder)←EstablishProject y</code>
<code> [5]  buff←Status folder</code>
<code> [6]  r←' '~⍨'On branch'{⍵↓⍨(≢⍺)+⍸⍺⍷⍵}('┌─┐│└┘',⎕UCS 13)~⍨(⍸∨/¨'On branch'∘⍷¨buff)⊃buff</code>
<code> [7] ⍝Done</code>
</div>
<code class="header" id="listing_79">#.APLGit2.APLGit2.GetLastCommit &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> hash←GetLastCommit folder</code>
<code> [1] ⍝ Returns the last commit.</code>
<code> [2] ⍝ Useful to compare it with the working tree</code>
<code> [3]  parms←⎕NS''</code>
<code> [4]  parms.max←1</code>
<code> [5]  commit←parms Log folder</code>
<code> [6]  hash←⊃commit</code>
<code> [7] ⍝Done</code>
</div>
<code class="header" id="listing_80">#.APLGit2.APLGit2.GetMainOrMaster &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> r←GetMainOrMaster folder</code>
<code> [1] ⍝ Returns either "master" (now deprecated but still valid) or "main"</code>
<code> [2]  r←'main' 'master'⊃⍨⍸'main' 'master'∊2↓¨ListBranches folder</code>
</div>
<code class="header" id="listing_81">#.APLGit2.APLGit2.GetMostRecentAncestor &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  r←GetMostRecentAncestor y</code>
<code> [1]  ⍝</code>
<code> [2]   r←''</code>
<code> [3]   (space folder)←EstablishProject y</code>
<code> [4]   →(0=≢folder)/0</code>
<code> [5]   branch1←CurrentBranch folder</code>
<code> [6]   'Without ⍺ the current branch must not be either "main" or "master"'U.Assert~(⊂branch1)∊'main' 'master'</code>
<code> [7]   branches←2↓¨ListBranches folder</code>
<code> [8]   branches~←⊂branch1</code>
<code> [9]   branch2←(⌊/branches⍳'main' 'master')⊃branches</code>
<code> [10]  (rc msg data)←folder U.RunGitCommand'merge-base ',branch1,' ',branch2</code>
<code> [11]  msg U.Assert 0=rc</code>
<code> [12]  r←⊃data</code>
<code> [13]  ⍝Done</code>
</div>
<code class="header" id="listing_82">#.APLGit2.APLGit2.GitProjects &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> r←GitProjects dummy</code>
<code> [1] ⍝ Returns all open Cider projects that are Git managed.\\</code>
<code> [2]  :If 0≠≢r←⎕SE.Cider.ListOpenProjects 0</code>
<code> [3]      r←(IsGitProject¨r[;2])⌿r</code>
<code> [4]  :EndIf</code>
<code> [5] ⍝Done</code>
</div>
<code class="header" id="listing_83">#.APLGit2.APLGit2.IsDirty &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> r←IsDirty y</code>
<code> [1] ⍝ Are there uncommited changes?</code>
<code> [2]  project←EstablishProject y</code>
<code> [3]  'Not a Cider project'⎕SIGNAL 6/⍨0=≢project</code>
<code> [4]  path←2⊃project</code>
<code> [5]  (rc more buff)←path U.RunGitCommand'status --porcelain'</code>
<code> [6]  more U.Assert 0=rc</code>
<code> [7]  r←0&lt;'?'+.≠⊃¨buff</code>
<code> [8] ⍝Done</code>
</div>
<code class="header" id="listing_84">#.APLGit2.APLGit2.IsGitProject &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> r←IsGitProject path</code>
<code> [1] ⍝ Returns a Boolean indicating whether `path` is Git-managed or not.\\</code>
<code> [2] ⍝ Checks whether `path` has a sub-folder `.git` - that indicates a Git-managed project.\\</code>
<code> [3] ⍝ Is not limited to opened Cider projects.</code>
<code> [4]  path←{0=≢⍵:F.PWD ⋄ ⍵}path</code>
<code> [5]  'No directory provided'⎕SIGNAL 6/⍨0=F.IsDir path</code>
<code> [6]  r←F.IsDir path,'/.git'</code>
<code> [7] ⍝Done</code>
</div>
<code class="header" id="listing_85">#.APLGit2.APLGit2.ListBranches &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  r←{option}ListBranches y</code>
<code> [1]  ⍝ Returns a vector of vector with branch names (the current branch starts with "\* ") or ''.\\</code>
<code> [2]  ⍝ `option` might be either "a" (for "all") or "r" (for "remote"); defaults to local branches only.\\</code>
<code> [3]  ⍝ `y` must be one of:</code>
<code> [4]  ⍝   * Fully qualfied name of a namespace  that is an opened Cider project</code>
<code> [5]  ⍝   * Fully qualified path to a Git-managed project</code>
<code> [6]   ⎕TRAP←(811 'E' '⎕DMX.EM ⎕signal 811')(0 'N')</code>
<code> [7]   option←{0&lt;⎕NC ⍵:⍎⍵ ⋄ ''}'option'</code>
<code> [8]   (space path)←EstablishProject y</code>
<code> [9]   'Invalid left argument: must be empty or "a" (all) or "r" (remote)'U.Assert(⊂option)∊''⍬'a' 'r' '-a' '-r'</code>
<code> [10]  (rc more buff)←path U.RunGitCommand('branch --list',{0=≢⍵:⍵ ⋄ ' -',⍵~'-'}option)</code>
<code> [11]  more U.Assert 0=rc</code>
<code> [12]  r←{⍵/⍨0&lt;≢¨⍵}⍣(0≠≢buff)⊣buff</code>
<code> [13] ⍝Done</code>
</div>
<code class="header" id="listing_86">#.APLGit2.APLGit2.LogForBranch &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> r←{x}LogForBranch branch</code>
<code> [1] ⍝ Cover for `Log` that returns the log just for a specific branch.</code>
<code> [2] ⍝ For what `x` can actually be see `EstablishProject`.</code>
<code> [3]  x←{0&lt;⎕NC ⍵:⍎⍵ ⋄ ''}'x'</code>
<code> [4]  (space folder)←EstablishProject x</code>
<code> [5]  parms←⎕NS''</code>
<code> [6]  parms.branch←branch</code>
<code> [7]  r←parms Log folder</code>
<code> [8] ⍝Done</code>
</div>
<code class="header" id="listing_87">#.APLGit2.APLGit2.Methods &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  r←Methods</code>
<code> [1]  ⍝ Like `Public` but adds the first line after the header and syntax information.\\</code>
<code> [2]  ⍝ Uses `Public` as source.</code>
<code> [3]   list←Public~⊂'Methods'</code>
<code> [4]   buff←{2↑⎕NR ⍵}¨list</code>
<code> [5]   r←{⍵↑⍨¯1+⍵⍳';'}¨1⊃¨buff</code>
<code> [6]   r←list{⍺ ⎕R' ∇'⊣⍵}¨r</code>
<code> [7]   r←'← ∇'⎕R'←∇'⊣r</code>
<code> [8]   r←list,[1.5]r</code>
<code> [9]   r,←{(¯2×'\\'∘≡¨¯2↑¨⍵)↓¨2↓¨⍵}2⊃¨buff</code>
<code> [10] ⍝Done</code>
</div>
<code class="header" id="listing_88">#.APLGit2.APLGit2.Public &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  r←Public</code>
<code> [1]   r←''</code>
<code> [2]   r,←⊂'Add'</code>
<code> [3]   r,←⊂'AddGitIgnore'</code>
<code> [4]   r,←⊂'ChangeLog'</code>
<code> [5]   r,←⊂'Commit'</code>
<code> [6]   r,←⊂'CompareCommits'</code>
<code> [7]   r,←⊂'CurrentBranch'</code>
<code> [8]   r,←⊂'Diff'</code>
<code> [9]   r,←⊂'EstablishProject'</code>
<code> [10]  r,←⊂'GetDefaultProject'</code>
<code> [11]  r,←⊂'GetPathFromProject'</code>
<code> [12]  r,←⊂'GetProjectFromPath'</code>
<code> [13]  r,←⊂'GetTagOfLatestRelease'</code>
<code> [14]  r,←⊂'Init'</code>
<code> [15]  r,←⊂'IsDirty'</code>
<code> [16]  r,←⊂'IsGitProject'</code>
<code> [17]  r,←⊂'IsGitInstalled'</code>
<code> [18]  r,←⊂'ListBranches'</code>
<code> [19]  r,←⊂'Log'</code>
<code> [20]  r,←⊂'Methods'</code>
<code> [21]  r,←⊂'NoOfUntrackedFiles'</code>
<code> [22]  r,←⊂'OpenGitShell'</code>
<code> [23]  r,←⊂'RefLog'</code>
<code> [24]  r,←⊂'SetDefaultProject'</code>
<code> [25]  r,←⊂'StashShow'</code>
<code> [26]  r,←⊂'StashPush'</code>
<code> [27]  r,←⊂'StashPop'</code>
<code> [28]  r,←⊂'StashApply'</code>
<code> [29]  r,←⊂'StashClear'</code>
<code> [30]  r,←⊂'StashDrop'</code>
<code> [31]  r,←⊂'Squash'</code>
<code> [32]  r,←⊂'Status'</code>
<code> [33]  r,←⊂'Version'</code>
</div>
<code class="header" id="listing_89">#.APLGit2.APLGit2.RefLog &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  r←{x}RefLog restrictFlag</code>
<code> [1]  ⍝ Execute Git's "reflog" command.\\</code>
<code> [2]  ⍝ Returns a matrix with zero or more rows and these columns:\\</code>
<code> [3]  ⍝ * `[1]` Hash</code>
<code> [4]  ⍝ * `[2]` Symbolic pointer (HEAD)</code>
<code> [5]  ⍝ * `[3]` Command</code>
<code> [6]  ⍝ * `[4]` Message, either from the user of from Git\\</code>
<code> [7]  ⍝ `restrictFlag` defaults to 0 when empty; this lists all entries.</code>
<code> [8]  ⍝ If this is 1 then only the entries up to the last checkout are listed.\\</code>
<code> [9]  ⍝ For what `x` can actually be see `EstablishProject`.\\</code>
<code> [10]  r←⍬</code>
<code> [11]  x←{0&lt;⎕NC ⍵:⍎⍵ ⋄ ''}'x'</code>
<code> [12]  restrictFlag←{0=≢⍵:0 ⋄ ⍵}restrictFlag</code>
<code> [13]  'Right argument must be a Boolean'U.Assert(⊂restrictFlag)∊0 1</code>
<code> [14]  (space folder)←EstablishProject x</code>
<code> [15]  (rc more buff)←folder U.RunGitCommand'reflog '</code>
<code> [16]  ('RefLog crashed with RC=',(⍕rc),'; ',∊more)U.Assert 0=rc</code>
<code> [17]  r←↑3{⍺{(⍺↑⍵),{⍺,' ',⍵}/⍺↓⍵}' '(≠⊆⊢)⍵}¨buff</code>
<code> [18]  :If restrictFlag</code>
<code> [19]      r←(¯1+r[;3]⍳⊂'checkout:')↑r</code>
<code> [20]  :EndIf</code>
<code> [21] ⍝Done</code>
</div>
<code class="header" id="listing_90">#.APLGit2.APLGit2.StashApply &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> r←{stashNo}StashApply folder</code>
<code> [1] ⍝ Applies the given stash but does not remove it from the stash stack</code>
<code> [2]  stashNo←{0&lt;⎕NC ⍵:⍎⍵ ⋄ 0}'stashNo'</code>
<code> [3]  'Invalid stash number'⎕SIGNAL 11/⍨0≠1↑0⍴stashNo</code>
<code> [4]  cmd←'stash apply stash@{',(⍕stashNo),'}'</code>
<code> [5]  (rc more buff)←folder U.RunGitCommand cmd</code>
<code> [6]  more U.Assert 0=rc</code>
<code> [7]  r←(⊂more),buff</code>
<code> [8] ⍝Done</code>
</div>
<code class="header" id="listing_91">#.APLGit2.APLGit2.StashClear &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> {more}←StashClear folder</code>
<code> [1] ⍝ Deletes ALL saved stashes!</code>
<code> [2]  cmd←'stash clear'</code>
<code> [3]  (rc more buff)←folder U.RunGitCommand cmd</code>
<code> [4]  more U.Assert 0=rc</code>
<code> [5] ⍝Done</code>
</div>
<code class="header" id="listing_92">#.APLGit2.APLGit2.StashDrop &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> r←{stashNo}StashDrop folder</code>
<code> [1] ⍝ Drop the latest or the given stash from the stash cache</code>
<code> [2]  stashNo←{0&lt;⎕NC ⍵:⍎⍵ ⋄ 0}'stashNo'</code>
<code> [3]  'Invalid stash number'⎕SIGNAL 11/⍨0≠1↑0⍴stashNo</code>
<code> [4]  cmd←'stash drop stash@{',(⍕stashNo),'}'</code>
<code> [5]  (rc more buff)←folder U.RunGitCommand cmd</code>
<code> [6]  more U.Assert 0=rc</code>
<code> [7]  r←(⊂more),buff</code>
<code> [8] ⍝Done</code>
</div>
<code class="header" id="listing_93">#.APLGit2.APLGit2.StashList &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  r←StashList y</code>
<code> [1]  ⍝ List the stash entries that you currently have. Each stash entry is listed with its name (e.g. stash@{0} is the latest entry,</code>
<code> [2]  ⍝ stash@{1} is the one before, etc.), the name of the branch that was current when the entry was made, and a short description</code>
<code> [3]  ⍝ of the commit the entry was based on.\\</code>
<code> [4]  ⍝ `y` must be one of:</code>
<code> [5]  ⍝   * Fully qualfied name of a namespace that is an opened Cider project</code>
<code> [6]  ⍝   * Fully qualified path to a Git-managed project</code>
<code> [7]   ⎕TRAP←(811 'E' '⎕DMX.EM ⎕signal 811')(0 'N')</code>
<code> [8]   (space path)←EstablishProject y</code>
<code> [9]   (rc more r)←path U.RunGitCommand'stash list'</code>
<code> [10]  more U.Assert 0=rc</code>
<code> [11]  ((≢'fatal:')↓more)U.Assert'fatal:'{⍺≢(≢⍺)↑⍵}more</code>
<code> [12] ⍝Done</code>
</div>
<code class="header" id="listing_94">#.APLGit2.APLGit2.StashPop &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> r←{stashNo}StashPop folder</code>
<code> [1] ⍝ Bring back stashed stuff and remove it from the stash stack</code>
<code> [2]  stashNo←{0&lt;⎕NC ⍵:⍎⍵ ⋄ 0}'stashNo'</code>
<code> [3]  'Invalid stash number'⎕SIGNAL 11/⍨0≠1↑0⍴stashNo</code>
<code> [4]  cmd←'stash pop stash@{',(⍕stashNo),'}'</code>
<code> [5]  (rc more buff)←folder U.RunGitCommand cmd</code>
<code> [6]  more U.Assert 0=rc</code>
<code> [7]  r←(⊂more),buff</code>
<code> [8] ⍝Done</code>
</div>
<code class="header" id="listing_95">#.APLGit2.APLGit2.Status &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  r←{short}Status y</code>
<code> [1]  ⍝ Reports all unstaged/uncommited/untracked files.\\</code>
<code> [2]  ⍝ `y` must be one of:</code>
<code> [3]  ⍝   * Fully qualfied name of a namespace that is an opened Cider project</code>
<code> [4]  ⍝   * Fully qualified path to a Git-managed project</code>
<code> [5]  ⍝ `short` defaults to 0 which gives you a detailed report while 1 gives a short report.</code>
<code> [6]   ⎕TRAP←(811 'E' '⎕DMX.EM ⎕signal 811')(0 'N')</code>
<code> [7]   short←{0&lt;⎕NC ⍵:⍎⍵ ⋄ 0}'short'</code>
<code> [8]   (space path)←EstablishProject y</code>
<code> [9]   (rc more r)←path U.RunGitCommand('status',short/' --short')</code>
<code> [10]  more U.Assert 0=rc</code>
<code> [11]  ((≢'fatal:')↓more)U.Assert'fatal:'{⍺≢(≢⍺)↑⍵}more</code>
<code> [12]  :If ~short</code>
<code> [13]      ind←⍸∨/¨'On branch'∘⍷¨r</code>
<code> [14]      branch←⊃¯1↑' '(≠⊆⊢)ind⊃r</code>
<code> [15]      :If (⊂branch)∊'main' 'master'</code>
<code> [16]          msg←∊(⎕UCS 13),U.Box{⍵{(⍵⍴'⌹')⍺(⍵⍴'⌹')}≢⍵}'⌹ On branch ',branch,' ⌹'</code>
<code> [17]      :Else</code>
<code> [18]          msg←'On branch ',branch</code>
<code> [19]      :EndIf</code>
<code> [20]      (ind⊃r)←msg</code>
<code> [21]      r←(⊂path{0&lt;≢⍵:'Namespace: ',⍵ ⋄ 'Folder: ',⍺}space),⊆r</code>
<code> [22]  :EndIf</code>
<code> [23] ⍝Done</code>
</div>
<code class="header" id="listing_96">#.APLGit2.APLGit2.API.Add &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> Add←{⍺←⊢ ⋄ 1:shy←⍺ ##.Add ⍵}</code>
</div>
<code class="header" id="listing_97">#.APLGit2.APLGit2.API.AddGitIgnore &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> AddGitIgnore←{⍺←⊢ ⋄ ⍺ ##.AddGitIgnore ⍵}</code>
</div>
<code class="header" id="listing_98">#.APLGit2.APLGit2.API.ChangeLog &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> ChangeLog←{⍺←⊢ ⋄ ⍺ ##.ChangeLog ⍵}</code>
</div>
<code class="header" id="listing_99">#.APLGit2.APLGit2.API.Commit &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> Commit←{⍺←⊢ ⋄ ⍺ ##.Commit ⍵}</code>
</div>
<code class="header" id="listing_100">#.APLGit2.APLGit2.API.CompareCommits &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> CompareCommits←{⍺←⊢ ⋄ ⍺ ##.CompareCommits ⍵}</code>
</div>
<code class="header" id="listing_101">#.APLGit2.APLGit2.API.CurrentBranch &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> CurrentBranch←{##.CurrentBranch ⍵}</code>
</div>
<code class="header" id="listing_102">#.APLGit2.APLGit2.API.Diff &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> Diff←{⍺←⊢ ⋄ ⍺ ##.Diff ⍵}</code>
</div>
<code class="header" id="listing_103">#.APLGit2.APLGit2.API.EstablishProject &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> EstablishProject←{⍺←⊢ ⋄ ⍺ ##.EstablishProject ⍵}</code>
</div>
<code class="header" id="listing_104">#.APLGit2.APLGit2.API.GetDefaultProject &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> GetDefaultProject←{##.GetDefaultProject ⍵}</code>
</div>
<code class="header" id="listing_105">#.APLGit2.APLGit2.API.GetPathFromProject &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> GetPathFromProject←{##.GetPathFromProject ⍵}</code>
</div>
<code class="header" id="listing_106">#.APLGit2.APLGit2.API.GetProjectFromPath &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> GetProjectFromPath←{##.GetProjectFromPath ⍵}</code>
</div>
<code class="header" id="listing_107">#.APLGit2.APLGit2.API.GetTagOfLatestRelease &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> GetTagOfLatestRelease←{⍺←⊢ ⋄ ⍺ ##.GetTagOfLatestRelease ⍵}</code>
</div>
<code class="header" id="listing_108">#.APLGit2.APLGit2.API.Init &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> Init←{⍺←⊢ ⋄ ⍺ ##.Init ⍵}</code>
</div>
<code class="header" id="listing_109">#.APLGit2.APLGit2.API.IsDirty &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> IsDirty←{##.IsDirty ⍵}</code>
</div>
<code class="header" id="listing_110">#.APLGit2.APLGit2.API.IsGitInstalled &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> yesNo←IsGitInstalled</code>
<code> [1]  yesNo←##.IsGitInstalled</code>
</div>
<code class="header" id="listing_111">#.APLGit2.APLGit2.API.IsGitProject &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> IsGitProject←{##.IsGitProject ⍵}</code>
</div>
<code class="header" id="listing_112">#.APLGit2.APLGit2.API.ListBranches &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> ListBranches←{⍺←⊢ ⋄ ⍺ ##.ListBranches ⍵}</code>
</div>
<code class="header" id="listing_113">#.APLGit2.APLGit2.API.Log &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> Log←{⍺←⊢ ⋄ ⍺ ##.Log ⍵}</code>
</div>
<code class="header" id="listing_114">#.APLGit2.APLGit2.API.Methods &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> r←Methods</code>
<code> [1]  r←##.Methods</code>
</div>
<code class="header" id="listing_115">#.APLGit2.APLGit2.API.NoOfUntrackedFiles &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> NoOfUntrackedFiles←{##.NoOfUntrackedFiles ⍵}</code>
</div>
<code class="header" id="listing_116">#.APLGit2.APLGit2.API.OpenGitShell &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> OpenGitShell←{##.OpenGitShell ⍵}</code>
</div>
<code class="header" id="listing_117">#.APLGit2.APLGit2.API.RefLog &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> RefLog←{⍺←⊢ ⋄ ⍺ ##.RefLog ⍵}</code>
</div>
<code class="header" id="listing_118">#.APLGit2.APLGit2.API.SetDefaultProject &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> SetDefaultProject←{⍺←⊢ ⋄ 1:shy←⍺ ##.SetDefaultProject ⍵}</code>
</div>
<code class="header" id="listing_119">#.APLGit2.APLGit2.API.Squash &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> Squash←{⍺←⊢ ⋄ ⍺ ##.Squash ⍵}</code>
</div>
<code class="header" id="listing_120">#.APLGit2.APLGit2.API.StashApply &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> StashApply←{⍺←⊢ ⋄ ⍺ ##.StashApply ⍵}</code>
</div>
<code class="header" id="listing_121">#.APLGit2.APLGit2.API.StashClear &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> StashClear←{##.StashClear ⍵}</code>
</div>
<code class="header" id="listing_122">#.APLGit2.APLGit2.API.StashDrop &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> StashDrop←{⍺←⊢ ⋄ ⍺ ##.StashDrop ⍵}</code>
</div>
<code class="header" id="listing_123">#.APLGit2.APLGit2.API.StashPop &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> StashPop←{⍺←⊢ ⋄ ⍺ ##.StashPop ⍵}</code>
</div>
<code class="header" id="listing_124">#.APLGit2.APLGit2.API.StashPush &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> StashPush←{##.StashPush ⍵}</code>
</div>
<code class="header" id="listing_125">#.APLGit2.APLGit2.API.StashShow &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> StashShow←{⍺←⊢ ⋄ ⍺ ##.StashShow ⍵}</code>
</div>
<code class="header" id="listing_126">#.APLGit2.APLGit2.API.Status &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> Status←{⍺←⊢ ⋄ ⍺ ##.Status ⍵}</code>
</div>
<code class="header" id="listing_127">#.APLGit2.APLGit2.API.Version &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> r←Version</code>
<code> [1]  r←##.Version</code>
</div>
<code class="header" id="listing_128">#.APLGit2.APLGit2.U.AddSlash &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> AddSlash←{⍵,(~(¯1↑⍵)∊'/\')/'/'}</code>
</div>
<code class="header" id="listing_129">#.APLGit2.APLGit2.U.Assert &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> Assert←{⍺←'' ⋄ (,1)≡,⍵:r←1 ⋄ ⎕ML←1 ⋄ (∊⍺)⎕SIGNAL 1↓(⊃∊⍵),ErrNo}</code>
</div>
<code class="header" id="listing_130">#.APLGit2.APLGit2.U.Box &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  Box←{⍺←⊢</code>
<code> [1]       r←⎕FMT↑⍵</code>
<code> [2]       b←r∊⍺⊣'⌹'</code>
<code> [3]       m←⍉4⊥⍉2⊥↑↑(3,/0,b,0)(3,⌿0⍪b⍪0)</code>
<code> [4]       c←'│  ─  ┌  │  │  └  ├  ─  ┐  ─  ┬  ┘  ┤  ┴  ┼ .'~' '</code>
<code> [5]       n←13 14 15 28 29 30 31 44 45 46 47 60 61 62 63</code>
<code> [6]       (⍴r)⍴(m∊n)⊖(2,⍴r)⍴r⍪(⊂n⍳m)⌷c</code>
<code> [7]  ⍝ box frame</code>
<code> [8]  ⍝ [⍺] char(s) to be replaced - dflt '⌹'</code>
<code> [9]  ⍝  ⍵  char array</code>
<code> [10] ⍝  ←  array with ⍺ replaced by boxing chars</code>
<code> [11] ⍝ ┌───┬───┬───┬───┬───┬───┬───┬───┐  ┌───┬───┬───┬───┬───┬───┬───┬───┐</code>
<code> [12] ⍝ │   │ ∘ │   │ ∘ │   │ ∘ │   │ ∘ │  │   │ │ │   │ │ │   │ │ │   │ │ │</code>
<code> [13] ⍝ │ ∘ │ ∘ │ ∘∘│ ∘∘│ ∘ │ ∘ │ ∘∘│ ∘∘│  │ ∘ │ │ │ ──│ └─│ │ │ │ │ ┌─│ ├─│</code>
<code> [14] ⍝ │   │   │   │   │ ∘ │ ∘ │ ∘ │ ∘ │  │   │   │   │   │ │ │ │ │ │ │ │ │</code>
<code> [15] ⍝ ├───┼───┼───┼───┼───┼───┼───┼───┤  ├───┼───┼───┼───┼───┼───┼───┼───┤</code>
<code> [16] ⍝ │   │ ∘ │   │ ∘ │   │ ∘ │   │ ∘ │  │   │ │ │   │ │ │   │ │ │   │ │ │</code>
<code> [17] ⍝ │∘∘ │∘∘ │∘∘∘│∘∘∘│∘∘ │∘∘ │∘∘∘│∘∘∘│  │── │─┘ │───│─┴─│─┐ │─┤ │─┬─│─┼─│</code>
<code> [18] ⍝ │   │   │   │   │ ∘ │ ∘ │ ∘ │ ∘ │  │   │   │   │   │ │ │ │ │ │ │ │ │</code>
<code> [19] ⍝ └───┴───┴───┴───┴───┴───┴───┴───┘  └───┴───┴───┴───┴───┴───┴───┴───┘</code>
<code> [20] ⍝ Phil Last 2016-02-12</code>
<code> [21]  }</code>
</div>
<code class="header" id="listing_131">#.APLGit2.APLGit2.U.ErrNo &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> r←ErrNo</code>
<code> [1]  r←811</code>
</div>
<code class="header" id="listing_132">#.APLGit2.APLGit2.U.FormatLog &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  r←FormatLog logData</code>
<code> [1]  ⍝ Formats the Git Log properly when GetLogFormat was used to retrieve the data.</code>
<code> [2]   ⍝ First we transform any multi-line messages into simple ";"-separated ones:</code>
<code> [3]   :If ∨/b←'⍙'∊¨logData</code>
<code> [4]       logData←⊃¨{⍺,';',⍵}/¨(+\b)⊆logData</code>
<code> [5]   :EndIf</code>
<code> [6]   ⍝ Now we split the data appropriately and ridden us of the separator:</code>
<code> [7]   ind←{⍸'⍙'=⍵}¨logData</code>
<code> [8]   b←{∊0,⍨¨(⍵-1+(0,¯1↓⍵))⍴¨⍳3}¨ind</code>
<code> [9]   b,¨←((≢¨logData)-≢¨b)⍴¨4</code>
<code> [10]  r←↑b⊆¨logData</code>
<code> [11] ⍝Done</code>
</div>
<code class="header" id="listing_133">#.APLGit2.APLGit2.U.GetDateFormat &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> r←GetDateFormat</code>
<code> [1] ⍝ We define an appropriate date format</code>
<code> [2]  r←'format:"%Y-%m-%d %H:%M:%S %z"'</code>
</div>
<code class="header" id="listing_134">#.APLGit2.APLGit2.U.GetGitAttributes &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  r←GetGitAttributes</code>
<code> [1]  ⍝ Returns a vector of character vectors that define a default file .gitattributes</code>
<code> [2]   r←''</code>
<code> [3]   r,←⊂'# Auto detect text files'</code>
<code> [4]   r,←⊂'* text=auto'</code>
<code> [5]   r,←⊂''</code>
<code> [6]   r,←⊂'*.aplf linguist-language=apl'</code>
<code> [7]   r,←⊂'*.aplo linguist-language=apl'</code>
<code> [8]   r,←⊂'*.aplc linguist-language=apl'</code>
<code> [9]   r,←⊂'*.apln linguist-language=apl'</code>
<code> [10]  r,←⊂'*.apli linguist-language=apl'</code>
<code> [11]  r,←⊂'*.apla linguist-language=apl'</code>
<code> [12]  r,←⊂'*.dws linguist-language=apl'</code>
<code> [13]  r,←⊂'*.dyapp linguist-language=apl'</code>
<code> [14]  r,←⊂'*.dyalog linguist-language=apl'</code>
<code> [15]  r,←⊂''</code>
<code> [16]  r,←⊂'# Exclude these:'</code>
<code> [17]  r,←⊂'Dist/ linguist-vendored=true'</code>
<code> [18]  r,←⊂'CSS/ linguist-vendored=true'</code>
<code> [19]  r,←⊂'Docs/ linguist-vendored=true'</code>
<code> [20]  r,←⊂'Testcases/ linguist-vendored=true'</code>
<code> [21]  r,←⊂'*.js linguist-vendored=true'</code>
<code> [22]  r,←⊂'*.html/ linguist-vendored=true'</code>
<code> [23]  r,←⊂'*.iss/ linguist-vendored=true'</code>
</div>
<code class="header" id="listing_135">#.APLGit2.APLGit2.U.GetLogFormat &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  format←GetLogFormat</code>
<code> [1]  ⍝ Returns a proper format string useful to get what we want from Git's Log.</code>
<code> [2]  </code>
<code> [3]  ⍝SEP←'%x09'                  ⍝ This does not work: arrives as space in APL!</code>
<code> [4]   SEP←'⍙'                     ⍝ Therefore we settle for a very special seperator.</code>
<code> [5]   format←''</code>
<code> [6]   format,←'%h'                ⍝ Commit hash (short; %H would be long)</code>
<code> [7]   format,←SEP</code>
<code> [8]   format,←'%cn'               ⍝ Committer's name</code>
<code> [9]   format,←SEP</code>
<code> [10]  format,←'%cd'               ⍝ Commit date</code>
<code> [11]  format,←SEP</code>
<code> [12]  format,←'%s'                ⍝ Subject</code>
<code> [13] ⍝Done</code>
</div>
<code class="header" id="listing_136">#.APLGit2.APLGit2.U.GetValidFileExtensions &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> r←GetValidFileExtensions</code>
<code> [1] ⍝ Returns a vector of text vectors with all the valid file extensions.</code>
<code> [2]  code←'aplf' 'aplo' 'apln' 'aplc' 'apli' 'dyalog'</code>
<code> [3]  arrays←⊆'array'</code>
<code> [4]  r←code,arrays</code>
<code> [5]  ⍝Done</code>
</div>
<code class="header" id="listing_137">#.APLGit2.APLGit2.U.IsNetCore &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> r←IsNetCore</code>
<code> [1]  r←1 1≡2↑2250⌶0 ⍝ 2250⌶0 is now the preferred mechanism to establish .NET availability</code>
</div>
<code class="header" id="listing_138">#.APLGit2.APLGit2.U.SelectProject &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  SelectProject←{</code>
<code> [1]  ⍝ Presents all currently opened Cider projects and lets the user choose one.\\</code>
<code> [2]  ⍝ Returns a matrix with the selected project in the same format ]Cider.Projects does, possibly `(⍬ ⍬ ⍬)`.</code>
<code> [3]  ⍝ The optional left argument (default=1) allows you to ask for **all** currently opened</code>
<code> [4]  ⍝ projects (rather than only those that are git-managed) by passing a 0.</code>
<code> [5]       ⍺←1</code>
<code> [6]       ~(⊂⍺)∊0 1:'Invalid left argument: not a Boolean'⎕SIGNAL 11</code>
<code> [7]       l←⍵</code>
<code> [8]       0=≢l:l</code>
<code> [9]       0=≢i←'SelectPrjForAPLGIT2@APLGit2: please select a project'##.CommTools.Select↓⎕FMT l:'' ''</code>
<code> [10]      l[i;]</code>
<code> [11]  }</code>
</div>
<code class="header" id="listing_139">#.APLGit2.APLGit2.UC.Assert &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> Assert←{⍺←'' ⋄ (,1)≡,⍵:r←1 ⋄ (∊⍺)⎕SIGNAL 1↓(⊃∊⍵),ErrNo}</code>
</div>
<div id="footer">
<hr>
<p>Created by "CodeCoverage" version 0.10.7+52 from 2024-06-05</p>
</div>

</body>
</html>
